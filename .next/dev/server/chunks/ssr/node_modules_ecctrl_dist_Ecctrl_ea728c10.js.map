{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/ecctrl/dist/Ecctrl.js","sources":["file:///Users/jdbohrman/Downloads/little-trails/node_modules/ecctrl/src/hooks/useFollowCam.tsx","file:///Users/jdbohrman/Downloads/little-trails/node_modules/ecctrl/src/stores/useGame.ts","file:///Users/jdbohrman/Downloads/little-trails/node_modules/ecctrl/src/stores/useJoystickControls.ts","file:///Users/jdbohrman/Downloads/little-trails/node_modules/ecctrl/src/EcctrlAnimation.tsx","file:///Users/jdbohrman/Downloads/little-trails/node_modules/ecctrl/src/EcctrlJoystick.tsx","file:///Users/jdbohrman/Downloads/little-trails/node_modules/ecctrl/src/Ecctrl.tsx"],"sourcesContent":["import { useThree } from \"@react-three/fiber\";\n// import { useRapier } from \"@react-three/rapier\";\nimport { useEffect, useMemo, useRef } from \"react\";\nimport * as THREE from \"three\";\nimport type { camListenerTargetType } from \"../Ecctrl\";\n\nexport const useFollowCam = function ({\n  disableFollowCam = false,\n  disableFollowCamPos = null,\n  disableFollowCamTarget = null,\n  camInitDis = -5,\n  camMaxDis = -7,\n  camMinDis = -0.7,\n  camUpLimit = 1.5, // in rad\n  camLowLimit = -1.3, // in rad\n  camInitDir = { x: 0, y: 0 }, // in rad\n  camMoveSpeed = 1,\n  camZoomSpeed = 1,\n  camCollisionOffset = 0.7, // percentage\n  camCollisionSpeedMult = 4,\n  camListenerTarget = \"domElement\",\n  ...props\n}: UseFollowCamProps = {}) {\n  const { scene, camera, gl } = useThree();\n  // const { rapier, world } = useRapier();\n\n  let isMouseDown = false;\n  let previousTouch1: Touch | null = null;\n  let previousTouch2: Touch | null = null;\n\n  const originZDis = useRef<number>(camInitDis ?? -5)\n  const pivot = useMemo(() => new THREE.Object3D(), []);\n  const followCam = useMemo(() => {\n    const origin = new THREE.Object3D();\n    origin.position.set(\n      0,\n      originZDis.current * Math.sin(-camInitDir.x),\n      originZDis.current * Math.cos(-camInitDir.x)\n    );\n    return origin;\n  }, []);\n\n  /** Camera collison detect setups */\n  let smallestDistance = null;\n  let cameraDistance = null;\n  let intersects = null;\n  // let intersectObjects: THREE.Object3D[] = [];\n  const intersectObjects = useRef<THREE.Object3D[]>([])\n  const cameraRayDir = useMemo(() => new THREE.Vector3(), []);\n  const cameraRayOrigin = useMemo(() => new THREE.Vector3(), []);\n  const cameraPosition = useMemo(() => new THREE.Vector3(), []);\n  const camLerpingPoint = useMemo(() => new THREE.Vector3(), []);\n  const camRayCast = new THREE.Raycaster(\n    cameraRayOrigin,\n    cameraRayDir,\n    0,\n    -camMaxDis\n  );\n  // Rapier ray setup (optional)\n  // const rayCast = new rapier.Ray(cameraRayOrigin, cameraRayDir);\n  // let rayLength = null;\n  // let rayHit = null;\n\n  // Mouse move event\n  const onDocumentMouseMove = (e: MouseEvent) => {\n    if (document.pointerLockElement || isMouseDown) {\n      pivot.rotation.y -= e.movementX * 0.002 * camMoveSpeed;\n      const vy = followCam.rotation.x + e.movementY * 0.002 * camMoveSpeed;\n\n      cameraDistance = followCam.position.length();\n\n      if (vy >= camLowLimit && vy <= camUpLimit) {\n        followCam.rotation.x = vy;\n        followCam.position.y = -cameraDistance * Math.sin(-vy);\n        followCam.position.z = -cameraDistance * Math.cos(-vy);\n      }\n    }\n    return false;\n  };\n\n  // Mouse scroll event\n  const onDocumentMouseWheel = (e: Event) => {\n    const vz = originZDis.current - (e as WheelEvent).deltaY * 0.002 * camZoomSpeed;\n    const vy = followCam.rotation.x;\n\n    if (vz >= camMaxDis && vz <= camMinDis) {\n      originZDis.current = vz;\n      followCam.position.z = originZDis.current * Math.cos(-vy);\n      followCam.position.y = originZDis.current * Math.sin(-vy);\n    }\n    return false;\n  };\n\n  /**\n   * Touch events\n   */\n  // Touch end event\n  const onTouchEnd = (e: TouchEvent) => {\n    previousTouch1 = null\n    previousTouch2 = null\n  }\n\n  // Touch move event\n  const onTouchMove = (e: TouchEvent) => {\n    // prevent swipe to navigate gesture\n    e.preventDefault();\n    e.stopImmediatePropagation();\n\n    const touch1 = e.targetTouches[0];\n    const touch2 = e.targetTouches[1];\n\n    // One finger touch to rotate camera\n    if (previousTouch1 && !previousTouch2) {\n      const touch1MovementX = touch1.pageX - previousTouch1.pageX;\n      const touch1MovementY = touch1.pageY - previousTouch1.pageY;\n\n      pivot.rotation.y -= touch1MovementX * 0.005 * camMoveSpeed;\n      const vy = followCam.rotation.x + touch1MovementY * 0.005 * camMoveSpeed;\n\n      cameraDistance = followCam.position.length();\n\n      if (vy >= camLowLimit && vy <= camUpLimit) {\n        followCam.rotation.x = vy;\n        followCam.position.y = -cameraDistance * Math.sin(-vy);\n        followCam.position.z = -cameraDistance * Math.cos(-vy);\n      }\n    }\n\n    // Two fingers touch to zoom in/out camera\n    if (previousTouch1 && previousTouch2) {\n      const prePinchDis = Math.hypot(\n        previousTouch1.pageX - previousTouch2.pageX,\n        previousTouch1.pageY - previousTouch2.pageY\n      );\n      const pinchDis = Math.hypot(\n        e.touches[0].pageX - e.touches[1].pageX,\n        e.touches[0].pageY - e.touches[1].pageY\n      );\n\n      const vz = originZDis.current - (prePinchDis - pinchDis) * 0.01 * camZoomSpeed;\n      const vy = followCam.rotation.x;\n\n      if (vz >= camMaxDis && vz <= camMinDis) {\n        originZDis.current = vz;\n        followCam.position.z = originZDis.current * Math.cos(-vy);\n        followCam.position.y = originZDis.current * Math.sin(-vy);\n      }\n    }\n\n    previousTouch1 = touch1;\n    previousTouch2 = touch2;\n  }\n\n  /**\n   * Gamepad second joystick event\n   */\n  const joystickCamMove = (movementX: number, movementY: number) => {\n    pivot.rotation.y -= movementX * 0.005 * camMoveSpeed * 5;\n    const vy = followCam.rotation.x + movementY * 0.005 * camMoveSpeed * 5;\n\n    cameraDistance = followCam.position.length();\n\n    if (vy >= camLowLimit && vy <= camUpLimit) {\n      followCam.rotation.x = vy;\n      followCam.position.y = -cameraDistance * Math.sin(-vy);\n      followCam.position.z = -cameraDistance * Math.cos(vy);\n    }\n  }\n\n  /**\n   * Custom traverse function\n   */\n  // Prepare intersect objects for camera collision\n  function customTraverseAdd(object: THREE.Object3D) {\n    // Chekc if the object's userData camExcludeCollision is true\n    if (object.userData && object.userData.camExcludeCollision === true) {\n      return;\n    }\n\n    // Check if the object is a Mesh, and is visible\n    if ((object as THREE.Mesh).isMesh && (object as THREE.Mesh).visible) {\n      intersectObjects.current.push(object);\n    }\n\n    // Recursively traverse child objects\n    object.children.forEach((child) => {\n      customTraverseAdd(child); // Continue the traversal for all child objects\n    });\n  }\n  // Remove intersect objects from camera collision array\n  function customTraverseRemove(object: THREE.Object3D) {\n    intersectObjects.current = intersectObjects.current.filter(\n      (item) => item.uuid !== object.uuid // Keep all items except the one to remove\n    );\n\n    // Recursively traverse child objects\n    object.children.forEach((child) => {\n      customTraverseRemove(child); // Continue the traversal for all child objects\n    });\n  }\n\n  /**\n   * Camera collision detection function\n   */\n  const cameraCollisionDetect = (delta: number) => {\n    // Update collision detect ray origin and pointing direction\n    // Which is from pivot point to camera position\n    cameraRayOrigin.copy(pivot.position);\n    camera.getWorldPosition(cameraPosition);\n    cameraRayDir.subVectors(cameraPosition, pivot.position);\n    // rayLength = cameraRayDir.length();\n\n    // casting ray hit, if object in between character and camera,\n    // change the smallestDistance to the ray hit toi\n    // otherwise the smallestDistance is same as camera original position (originZDis)\n    intersects = camRayCast.intersectObjects(intersectObjects.current);\n    if (intersects.length && intersects[0].distance <= -originZDis.current) {\n      smallestDistance = Math.min(-intersects[0].distance * camCollisionOffset, camMinDis)\n    } else {\n      smallestDistance = originZDis.current;\n    }\n\n    // Rapier ray hit setup (optional)\n    // rayHit = world.castRay(rayCast, rayLength + 1, true, null, null, character);\n    // if (rayHit && rayHit.toi && rayHit.toi > originZDis) {\n    //   smallestDistance = -rayHit.toi + 0.5;\n    // } else if (rayHit == null) {\n    //   smallestDistance = originZDis;\n    // }\n\n    // Update camera next lerping position, and lerp the camera\n    camLerpingPoint.set(\n      followCam.position.x,\n      smallestDistance * Math.sin(-followCam.rotation.x),\n      smallestDistance * Math.cos(-followCam.rotation.x)\n    );\n\n    followCam.position.lerp(camLerpingPoint, 1 - Math.exp(-camCollisionSpeedMult * delta)); // delta * 2 for rapier ray setup\n  };\n\n  useEffect(() => {\n    // Initialize camera facing direction\n    pivot.rotation.y = camInitDir.y;\n    followCam.rotation.x = camInitDir.x\n\n    // Prepare for camera ray intersect objects\n    scene.children.forEach((child) => customTraverseAdd(child));\n\n    // Prepare for followCam and pivot point\n    pivot.add(followCam);\n    scene.add(pivot);\n\n    if (camListenerTarget === \"domElement\") {\n      gl.domElement.addEventListener(\"mousedown\", () => { isMouseDown = true });\n      gl.domElement.addEventListener(\"mouseup\", () => { isMouseDown = false });\n      gl.domElement.addEventListener(\"mousemove\", onDocumentMouseMove);\n      gl.domElement.addEventListener(\"mousewheel\", onDocumentMouseWheel);\n      // Touch event\n      gl.domElement.addEventListener(\"touchend\", onTouchEnd);\n      gl.domElement.addEventListener(\"touchmove\", onTouchMove, { passive: false });\n    } else if (camListenerTarget === \"document\") {\n      document.addEventListener(\"mousedown\", () => { isMouseDown = true });\n      document.addEventListener(\"mouseup\", () => { isMouseDown = false });\n      document.addEventListener(\"mousemove\", onDocumentMouseMove);\n      document.addEventListener(\"mousewheel\", onDocumentMouseWheel);\n      // Touch event\n      document.addEventListener(\"touchend\", onTouchEnd);\n      document.addEventListener(\"touchmove\", onTouchMove, { passive: false });\n    }\n\n    return () => {\n      if (camListenerTarget === \"domElement\") {\n        gl.domElement.removeEventListener(\"mousedown\", () => { isMouseDown = true });\n        gl.domElement.removeEventListener(\"mouseup\", () => { isMouseDown = false });\n        gl.domElement.removeEventListener(\"mousemove\", onDocumentMouseMove);\n        gl.domElement.removeEventListener(\"mousewheel\", onDocumentMouseWheel);\n        // Touch event\n        gl.domElement.removeEventListener(\"touchend\", onTouchEnd);\n        gl.domElement.removeEventListener(\"touchmove\", onTouchMove);\n      } else if (camListenerTarget === \"document\") {\n        document.removeEventListener(\"mousedown\", () => { isMouseDown = true });\n        document.removeEventListener(\"mouseup\", () => { isMouseDown = false });\n        document.removeEventListener(\"mousemove\", onDocumentMouseMove);\n        document.removeEventListener(\"mousewheel\", onDocumentMouseWheel);\n        // Touch event\n        document.removeEventListener(\"touchend\", onTouchEnd);\n        document.removeEventListener(\"touchmove\", onTouchMove);\n      }\n    };\n  }, [])\n\n  // If followCam is disabled set to disableFollowCamPos, target to disableFollowCamTarget\n  useEffect(() => {\n    if (disableFollowCam) {\n      if (disableFollowCamPos) camera.position.set(disableFollowCamPos.x, disableFollowCamPos.y, disableFollowCamPos.z)\n      if (disableFollowCamTarget) camera.lookAt(new THREE.Vector3(disableFollowCamTarget.x, disableFollowCamTarget.y, disableFollowCamTarget.z))\n    }\n  }, [disableFollowCam]);\n\n  // Handle scene add/remove objects events\n  useEffect(() => {\n    const onObjectAdded = (e: any) => customTraverseAdd(e.child)\n    const onObjectRemoved = (e: any) => customTraverseRemove(e.child)\n    scene.addEventListener(\"childadded\", onObjectAdded);\n    scene.addEventListener(\"childremoved\", onObjectRemoved);\n    return () => {\n      scene.removeEventListener(\"childadded\", onObjectAdded);\n      scene.removeEventListener(\"childremoved\", onObjectRemoved);\n    };\n  }, [scene])\n\n  return { pivot, followCam, cameraCollisionDetect, joystickCamMove };\n};\n\nexport type UseFollowCamProps = {\n  disableFollowCam?: boolean;\n  disableFollowCamPos?: { x: number, y: number, z: number } | null;\n  disableFollowCamTarget?: { x: number, y: number, z: number } |null;\n  camInitDis?: number;\n  camMaxDis?: number;\n  camMinDis?: number;\n  camUpLimit?: number;\n  camLowLimit?: number;\n  camInitDir?: { x: number, y: number };\n  camMoveSpeed?: number;\n  camZoomSpeed?: number;\n  camCollisionOffset?: number;\n  camCollisionSpeedMult?: number;\n  camListenerTarget?: camListenerTargetType;\n};\n","import * as THREE from \"three\";\nimport { create } from \"zustand\";\nimport { subscribeWithSelector } from \"zustand/middleware\";\n\nexport const useGame = /* @__PURE__ */ create(\n  /* @__PURE__ */ subscribeWithSelector<State>((set, get) => {\n    return {\n      /**\n       * Point to move point\n       */\n      moveToPoint: null as THREE.Vector3 | null,\n\n      /**\n       * Character animations state manegement\n       */\n      // Initial animation\n      curAnimation: null as string | null,\n      animationSet: {} as AnimationSet,\n\n      initializeAnimationSet: (animationSet: AnimationSet) => {\n        set((state) => {\n          if (Object.keys(state.animationSet).length === 0) {\n            return { animationSet };\n          }\n          return {};\n        });\n      },\n\n      reset: () => {\n        set((state) => {\n          return { curAnimation: state.animationSet.idle };\n        });\n      },\n\n      idle: () => {\n        set((state) => {\n          if (state.curAnimation === state.animationSet.jumpIdle) {\n            return { curAnimation: state.animationSet.jumpLand };\n          } else if (\n            state.curAnimation !== state.animationSet.action1 &&\n            state.curAnimation !== state.animationSet.action2 &&\n            state.curAnimation !== state.animationSet.action3 &&\n            state.curAnimation !== state.animationSet.action4\n          ) {\n            return { curAnimation: state.animationSet.idle };\n          }\n          return {};\n        });\n      },\n\n      walk: () => {\n        set((state) => {\n          if (state.curAnimation !== state.animationSet.action4) {\n            return { curAnimation: state.animationSet.walk };\n          }\n          return {};\n        });\n      },\n\n      run: () => {\n        set((state) => {\n          if (state.curAnimation !== state.animationSet.action4) {\n            return { curAnimation: state.animationSet.run };\n          }\n          return {};\n        });\n      },\n\n      jump: () => {\n        set((state) => {\n          return { curAnimation: state.animationSet.jump };\n        });\n      },\n\n      jumpIdle: () => {\n        set((state) => {\n          if (state.curAnimation === state.animationSet.jump) {\n            return { curAnimation: state.animationSet.jumpIdle };\n          }\n          return {};\n        });\n      },\n\n      jumpLand: () => {\n        set((state) => {\n          if (state.curAnimation === state.animationSet.jumpIdle) {\n            return { curAnimation: state.animationSet.jumpLand };\n          }\n          return {};\n        });\n      },\n\n      fall: () => {\n        set((state) => {\n          return { curAnimation: state.animationSet.fall };\n        });\n      },\n\n      action1: () => {\n        set((state) => {\n          if (state.curAnimation === state.animationSet.idle) {\n            return { curAnimation: state.animationSet.action1 };\n          }\n          return {};\n        });\n      },\n\n      action2: () => {\n        set((state) => {\n          if (state.curAnimation === state.animationSet.idle) {\n            return { curAnimation: state.animationSet.action2 };\n          }\n          return {};\n        });\n      },\n\n      action3: () => {\n        set((state) => {\n          if (state.curAnimation === state.animationSet.idle) {\n            return { curAnimation: state.animationSet.action3 };\n          }\n          return {};\n        });\n      },\n\n      action4: () => {\n        set((state) => {\n          if (\n            state.curAnimation === state.animationSet.idle ||\n            state.curAnimation === state.animationSet.walk ||\n            state.curAnimation === state.animationSet.run\n          ) {\n            return { curAnimation: state.animationSet.action4 };\n          }\n          return {};\n        });\n      },\n\n      /**\n       * Additional animations\n       */\n      // triggerFunction: ()=>{\n      //    set((state) => {\n      //        return { curAnimation: state.animationSet.additionalAnimation };\n      //    });\n      // }\n\n      /**\n       * Set/get point to move point\n       */\n      setMoveToPoint: (point: THREE.Vector3 | null) => {\n        set(() => {\n          return { moveToPoint: point };\n        });\n      },\n\n      getMoveToPoint: () => {\n        return {\n          moveToPoint: get().moveToPoint,\n        };\n      },\n    };\n  })\n);\n\nexport type AnimationSet = {\n  idle?: string;\n  walk?: string;\n  run?: string;\n  jump?: string;\n  jumpIdle?: string;\n  jumpLand?: string;\n  fall?: string;\n  // Currently support four additional animations\n  action1?: string;\n  action2?: string;\n  action3?: string;\n  action4?: string;\n};\n\ntype State = {\n  moveToPoint: THREE.Vector3 | null;\n  curAnimation: string | null;\n  animationSet: AnimationSet;\n  initializeAnimationSet: (animationSet: AnimationSet) => void;\n  reset: () => void;\n  setMoveToPoint: (point: THREE.Vector3 | null) => void;\n  getMoveToPoint: () => {\n    moveToPoint: THREE.Vector3 | null;\n  };\n} & {\n  [key in keyof AnimationSet]: () => void;\n};\n","import { create } from \"zustand\";\nimport { subscribeWithSelector } from \"zustand/middleware\";\n\nexport const useJoystickControls = /* @__PURE__ */ create(\n  /* @__PURE__ */ subscribeWithSelector<State>((set, get) => {\n    return {\n      /**\n       * Joystick state manegement\n       */\n      // Initial joystick/button state\n      curJoystickDis: 0 as number,\n      curJoystickAng: 0 as number,\n      curRunState: false as boolean,\n      curButton1Pressed: false as boolean,\n      curButton2Pressed: false as boolean,\n      curButton3Pressed: false as boolean,\n      curButton4Pressed: false as boolean,\n      curButton5Pressed: false as boolean,\n\n      setJoystick: (\n        joystickDis: number,\n        joystickAng: number,\n        runState: boolean\n      ) => {\n        set(() => {\n          return {\n            curJoystickDis: joystickDis,\n            curJoystickAng: joystickAng,\n            curRunState: runState,\n          };\n        });\n      },\n\n      resetJoystick: () => {\n        set((state) => {\n          if (state.curJoystickDis !== 0 || state.curJoystickAng !== 0) {\n            return {\n              curJoystickDis: 0,\n              curJoystickAng: 0,\n              curRunState: false,\n            };\n          }\n          return {};\n        });\n      },\n\n      pressButton1: () => {\n        set((state) => {\n          if (!state.curButton1Pressed) {\n            return {\n              curButton1Pressed: true,\n            };\n          }\n          return {};\n        });\n      },\n\n      pressButton2: () => {\n        set((state) => {\n          if (!state.curButton2Pressed) {\n            return {\n              curButton2Pressed: true,\n            };\n          }\n          return {};\n        });\n      },\n\n      pressButton3: () => {\n        set((state) => {\n          if (!state.curButton3Pressed) {\n            return {\n              curButton3Pressed: true,\n            };\n          }\n          return {};\n        });\n      },\n\n      pressButton4: () => {\n        set((state) => {\n          if (!state.curButton4Pressed) {\n            return {\n              curButton4Pressed: true,\n            };\n          }\n          return {};\n        });\n      },\n\n      pressButton5: () => {\n        set((state) => {\n          if (!state.curButton5Pressed) {\n            return {\n              curButton5Pressed: true,\n            };\n          }\n          return {};\n        });\n      },\n\n      releaseAllButtons: () => {\n        set((state) => {\n          if (state.curButton1Pressed) {\n            return {\n              curButton1Pressed: false,\n            };\n          }\n          if (state.curButton2Pressed) {\n            return {\n              curButton2Pressed: false,\n            };\n          }\n          if (state.curButton3Pressed) {\n            return {\n              curButton3Pressed: false,\n            };\n          }\n          if (state.curButton4Pressed) {\n            return {\n              curButton4Pressed: false,\n            };\n          }\n          if (state.curButton5Pressed) {\n            return {\n              curButton5Pressed: false,\n            };\n          }\n          return {};\n        });\n      },\n\n      getJoystickValues: () => {\n        return {\n          joystickDis: get().curJoystickDis,\n          joystickAng: get().curJoystickAng,\n          runState: get().curRunState,\n          button1Pressed: get().curButton1Pressed,\n          button2Pressed: get().curButton2Pressed,\n          button3Pressed: get().curButton3Pressed,\n          button4Pressed: get().curButton4Pressed,\n          button5Pressed: get().curButton5Pressed,\n        };\n      },\n    };\n  })\n);\n\ntype State = {\n  curJoystickDis: number;\n  curJoystickAng: number;\n  curRunState: boolean;\n  curButton1Pressed: boolean;\n  curButton2Pressed: boolean;\n  curButton3Pressed: boolean;\n  curButton4Pressed: boolean;\n  curButton5Pressed: boolean;\n  setJoystick: (\n    joystickDis: number,\n    joystickAng: number,\n    runState: boolean\n  ) => void;\n  resetJoystick: () => void;\n  pressButton1: () => void;\n  pressButton2: () => void;\n  pressButton3: () => void;\n  pressButton4: () => void;\n  pressButton5: () => void;\n  releaseAllButtons: () => void;\n  getJoystickValues: () => {\n    joystickDis: number;\n    joystickAng: number;\n    runState: boolean;\n    button1Pressed: boolean;\n    button2Pressed: boolean;\n    button3Pressed: boolean;\n    button4Pressed: boolean;\n    button5Pressed: boolean;\n  };\n};\n","import { useGLTF, useAnimations } from \"@react-three/drei\";\nimport { useEffect, useRef, Suspense } from \"react\";\nimport * as THREE from \"three\";\nimport { useGame, type AnimationSet } from \"./stores/useGame\";\nimport React from \"react\";\n\nexport function EcctrlAnimation(props: EcctrlAnimationProps) {\n  // Change the character src to yours\n  const group = useRef<THREE.Group | null>(null);\n  const { animations } = useGLTF(props.characterURL);\n  const { actions } = useAnimations(animations, group);\n\n  /**\n   * Character animations setup\n   */\n  const curAnimation = useGame((state) => state.curAnimation);\n  const resetAnimation = useGame((state) => state.reset);\n  const initializeAnimationSet = useGame(\n    (state) => state.initializeAnimationSet\n  );\n\n  useEffect(() => {\n    // Initialize animation set\n    initializeAnimationSet(props.animationSet);\n  }, []);\n\n  useEffect(() => {\n    // Play animation\n    // const action = actions[curAnimation ? curAnimation : props.animationSet.jumpIdle];\n    const key = curAnimation ?? props.animationSet.jumpIdle;\n    const action = key ? actions[key] : null;\n\n    // For jump and jump land animation, only play once and clamp when finish\n    if (action === null) return\n\n    if (\n      curAnimation === props.animationSet.jump ||\n      curAnimation === props.animationSet.jumpLand ||\n      curAnimation === props.animationSet.action1 ||\n      curAnimation === props.animationSet.action2 ||\n      curAnimation === props.animationSet.action3 ||\n      curAnimation === props.animationSet.action4\n    ) {\n      action.reset().fadeIn(0.2).setLoop(THREE.LoopOnce, 0).play();\n      action.clampWhenFinished = true;\n    } else {\n      action.reset().fadeIn(0.2).play();\n    }\n\n    // When any action is clamp and finished reset animation\n    (action as any)._mixer.addEventListener(\"finished\", () => resetAnimation());\n\n    return () => {\n      // Fade out previous action\n      action.fadeOut(0.2);\n\n      // Clean up mixer listener, and empty the _listeners array\n      (action as any)._mixer.removeEventListener(\"finished\", () =>\n        resetAnimation()\n      );\n      (action as any)._mixer._listeners = [];\n    };\n  }, [curAnimation]);\n\n  return (\n    <Suspense fallback={null}>\n      <group ref={group} dispose={null} userData={{ camExcludeCollision: true }}>\n        {/* Replace character model here */}\n        {props.children}\n      </group>\n    </Suspense>\n  );\n}\n\nexport type EcctrlAnimationProps = {\n  characterURL: string;\n  animationSet: AnimationSet;\n  children: React.ReactNode;\n};\n","import * as THREE from \"three\"\nimport { Canvas, type ThreeElements } from \"@react-three/fiber\";\nimport React, { useEffect, useState, forwardRef, useMemo, type ReactNode, useCallback, Suspense } from \"react\";\nimport { useSpring, animated } from '@react-spring/three'\nimport { useJoystickControls } from \"./stores/useJoystickControls\";\n\nconst JoystickComponents = (props: EcctrlJoystickProps) => {\n    /**\n     * Preset values/components\n     */\n    let joystickCenterX: number = 0\n    let joystickCenterY: number = 0\n    let joystickHalfWidth: number = 0\n    let joystickHalfHeight: number = 0\n    let joystickMaxDis: number = 0\n    let joystickDis: number = 0\n    let joystickAng: number = 0\n    const touch1MovementVec2 = useMemo(() => new THREE.Vector2(), [])\n    const joystickMovementVec2 = useMemo(() => new THREE.Vector2(), [])\n\n    const [windowSize, setWindowSize] = useState({ innerHeight, innerWidth })\n    const joystickDiv: null | HTMLDivElement = document.querySelector(\"#ecctrl-joystick\")\n\n    /**\n     * Animation preset\n     */\n    const [springs, api] = useSpring(\n        () => ({\n            topRotationX: 0,\n            topRotationY: 0,\n            basePositionX: 0,\n            basePositionY: 0,\n            config: {\n                tension: 600\n            }\n        })\n    )\n\n    /**\n     * Joystick component geometries\n     */\n    const joystickBaseGeo = useMemo(() => new THREE.CylinderGeometry(2.3, 2.1, 0.3, 16), [])\n    const joystickStickGeo = useMemo(() => new THREE.CylinderGeometry(0.3, 0.3, 3, 6), [])\n    const joystickHandleGeo = useMemo(() => new THREE.SphereGeometry(1.4, 8, 8), [])\n\n    /**\n     * Joystick component materials\n     */\n    const joystickBaseMaterial = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.3 }), [])\n    const joystickStickMaterial = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.3 }), [])\n    const joystickHandleMaterial = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.7 }), [])\n\n    /**\n     * Joystick store setup\n     */\n    const setJoystick = useJoystickControls((state) => state.setJoystick)\n    const resetJoystick = useJoystickControls((state) => state.resetJoystick)\n\n    // Touch move function\n    const onTouchMove = useCallback((e: TouchEvent) => {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        const touch1 = e.targetTouches[0];\n\n        const touch1MovementX = touch1.pageX - joystickCenterX\n        const touch1MovementY = -(touch1.pageY - joystickCenterY)\n        touch1MovementVec2.set(touch1MovementX, touch1MovementY)\n\n        joystickDis = Math.min(Math.sqrt(Math.pow(touch1MovementX, 2) + Math.pow(touch1MovementY, 2)), joystickMaxDis)\n        joystickAng = touch1MovementVec2.angle()\n        joystickMovementVec2.set(joystickDis * Math.cos(joystickAng), joystickDis * Math.sin(joystickAng))\n        const runState = joystickDis > joystickMaxDis * (props.joystickRunSensitivity ?? 0.9)\n\n        // Apply animations\n        api.start({\n            topRotationX: -joystickMovementVec2.y / joystickHalfHeight,\n            topRotationY: joystickMovementVec2.x / joystickHalfWidth,\n            basePositionX: joystickMovementVec2.x * 0.002,\n            basePositionY: joystickMovementVec2.y * 0.002,\n        })\n\n        // Pass valus to joystick store\n        setJoystick(joystickDis, joystickAng, runState)\n    }, [api, windowSize])\n\n    // Touch end function\n    const onTouchEnd = (e: TouchEvent) => {\n        // Reset animations\n        api.start({\n            topRotationX: 0,\n            topRotationY: 0,\n            basePositionX: 0,\n            basePositionY: 0,\n        })\n\n        // Reset joystick store values\n        resetJoystick()\n    }\n\n    // Reset window size function\n    const onWindowResize = () => {\n        setWindowSize({ innerHeight: window.innerHeight, innerWidth: window.innerWidth })\n    }\n\n    useEffect(() => {\n        if (!joystickDiv) return;\n\n        const joystickPositionX = joystickDiv.getBoundingClientRect().x\n        const joystickPositionY = joystickDiv.getBoundingClientRect().y\n        joystickHalfWidth = joystickDiv.getBoundingClientRect().width / 2\n        joystickHalfHeight = joystickDiv.getBoundingClientRect().height / 2\n\n        joystickMaxDis = joystickHalfWidth * 0.65\n\n        joystickCenterX = joystickPositionX + joystickHalfWidth\n        joystickCenterY = joystickPositionY + joystickHalfHeight\n\n        joystickDiv.addEventListener(\"touchmove\", onTouchMove, { passive: false })\n        joystickDiv.addEventListener(\"touchend\", onTouchEnd)\n\n        window.visualViewport?.addEventListener(\"resize\", onWindowResize)\n\n        return () => {\n            joystickDiv.removeEventListener(\"touchmove\", onTouchMove)\n            joystickDiv.removeEventListener(\"touchend\", onTouchEnd)\n            window.visualViewport?.removeEventListener(\"resize\", onWindowResize)\n        }\n    })\n\n    return (\n        <Suspense fallback=\"null\">\n            <animated.group position-x={springs.basePositionX} position-y={springs.basePositionY}>\n                <mesh geometry={joystickBaseGeo} material={joystickBaseMaterial} rotation={[-Math.PI / 2, 0, 0]} {...props.joystickBaseProps} />\n            </animated.group>\n            <animated.group rotation-x={springs.topRotationX} rotation-y={springs.topRotationY}>\n                <mesh geometry={joystickStickGeo} material={joystickStickMaterial} rotation={[-Math.PI / 2, 0, 0]} position={[0, 0, 1.5]} {...props.joystickStickProps} />\n                <mesh geometry={joystickHandleGeo} material={joystickHandleMaterial} position={[0, 0, 4]} {...props.joystickHandleProps} />\n            </animated.group>\n        </Suspense>\n    )\n}\n\nconst ButtonComponents = ({ buttonNumber = 1, ...props }: EcctrlJoystickProps) => {\n    /**\n    * Button component geometries\n    */\n    const buttonLargeBaseGeo = useMemo(() => new THREE.CylinderGeometry(1.1, 1, 0.3, 16), [])\n    const buttonSmallBaseGeo = useMemo(() => new THREE.CylinderGeometry(0.9, 0.8, 0.3, 16), [])\n    const buttonTop1Geo = useMemo(() => new THREE.CylinderGeometry(0.9, 0.9, 0.5, 16), [])\n    const buttonTop2Geo = useMemo(() => new THREE.CylinderGeometry(0.9, 0.9, 0.5, 16), [])\n    const buttonTop3Geo = useMemo(() => new THREE.CylinderGeometry(0.7, 0.7, 0.5, 16), [])\n    const buttonTop4Geo = useMemo(() => new THREE.CylinderGeometry(0.7, 0.7, 0.5, 16), [])\n    const buttonTop5Geo = useMemo(() => new THREE.CylinderGeometry(0.7, 0.7, 0.5, 16), [])\n\n    /**\n    * Button component materials\n    */\n    const buttonBaseMaterial = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.3 }), [])\n    const buttonTop1Material = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.5 }), [])\n    const buttonTop2Material = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.5 }), [])\n    const buttonTop3Material = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.5 }), [])\n    const buttonTop4Material = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.5 }), [])\n    const buttonTop5Material = useMemo(() => new THREE.MeshNormalMaterial({ transparent: true, opacity: 0.5 }), [])\n\n    const buttonDiv: null | HTMLDivElement = document.querySelector(\"#ecctrl-button\")\n\n    /**\n    * Animation preset\n    */\n    const [springs, api] = useSpring(\n        () => ({\n            buttonTop1BaseScaleY: 1,\n            buttonTop1BaseScaleXAndZ: 1,\n            buttonTop2BaseScaleY: 1,\n            buttonTop2BaseScaleXAndZ: 1,\n            buttonTop3BaseScaleY: 1,\n            buttonTop3BaseScaleXAndZ: 1,\n            buttonTop4BaseScaleY: 1,\n            buttonTop4BaseScaleXAndZ: 1,\n            buttonTop5BaseScaleY: 1,\n            buttonTop5BaseScaleXAndZ: 1,\n            config: {\n                tension: 600\n            }\n        })\n    )\n\n    /**\n    * Button store setup\n    */\n    const pressButton1 = useJoystickControls((state) => state.pressButton1)\n    const pressButton2 = useJoystickControls((state) => state.pressButton2)\n    const pressButton3 = useJoystickControls((state) => state.pressButton3)\n    const pressButton4 = useJoystickControls((state) => state.pressButton4)\n    const pressButton5 = useJoystickControls((state) => state.pressButton5)\n    const releaseAllButtons = useJoystickControls((state) => state.releaseAllButtons)\n\n    // Pointer down function\n    const onPointerDown = (number: number) => {\n        switch (number) {\n            case 1:\n                pressButton1()\n                api.start({\n                    buttonTop1BaseScaleY: 0.5,\n                    buttonTop1BaseScaleXAndZ: 1.15,\n                })\n                break;\n            case 2:\n                pressButton2()\n                api.start({\n                    buttonTop2BaseScaleY: 0.5,\n                    buttonTop2BaseScaleXAndZ: 1.15,\n                })\n                break;\n            case 3:\n                pressButton3()\n                api.start({\n                    buttonTop3BaseScaleY: 0.5,\n                    buttonTop3BaseScaleXAndZ: 1.15,\n                })\n                break;\n            case 4:\n                pressButton4()\n                api.start({\n                    buttonTop4BaseScaleY: 0.5,\n                    buttonTop4BaseScaleXAndZ: 1.15,\n                })\n                break;\n            case 5:\n                pressButton5()\n                api.start({\n                    buttonTop5BaseScaleY: 0.5,\n                    buttonTop5BaseScaleXAndZ: 1.15,\n                })\n                break;\n            default:\n                break;\n        }\n    }\n\n    // Pointer up function\n    const onPointerUp = () => {\n        releaseAllButtons();\n        api.start({\n            buttonTop1BaseScaleY: 1,\n            buttonTop1BaseScaleXAndZ: 1,\n            buttonTop2BaseScaleY: 1,\n            buttonTop2BaseScaleXAndZ: 1,\n            buttonTop3BaseScaleY: 1,\n            buttonTop3BaseScaleXAndZ: 1,\n            buttonTop4BaseScaleY: 1,\n            buttonTop4BaseScaleXAndZ: 1,\n            buttonTop5BaseScaleY: 1,\n            buttonTop5BaseScaleXAndZ: 1,\n        })\n    }\n\n    useEffect(() => {\n        if (!buttonDiv) return\n        buttonDiv.addEventListener(\"pointerup\", onPointerUp)\n\n        return () => {\n            buttonDiv.removeEventListener(\"pointerup\", onPointerUp)\n        }\n    })\n\n    return (\n        <Suspense fallback=\"null\">\n            {/* Button 1 */}\n            {buttonNumber > 0 &&\n                <animated.group\n                    scale-x={springs.buttonTop1BaseScaleXAndZ}\n                    scale-y={springs.buttonTop1BaseScaleY}\n                    scale-z={springs.buttonTop1BaseScaleXAndZ}\n                    rotation={[-Math.PI / 2, 0, 0]}\n                    position={props.buttonGroup1Position || (buttonNumber === 1 ? [0, 0, 0] : [2, 1, 0])}>\n                    <mesh geometry={buttonLargeBaseGeo} material={buttonBaseMaterial} {...props.buttonLargeBaseProps} onPointerDown={() => onPointerDown(1)} />\n                    <mesh geometry={buttonTop1Geo} material={buttonTop1Material} position={[0, -0.3, 0]} {...props.buttonTop1Props} />\n                </animated.group>}\n            {/* Button 2 */}\n            {buttonNumber > 1 &&\n                <animated.group\n                    scale-x={springs.buttonTop2BaseScaleXAndZ}\n                    scale-y={springs.buttonTop2BaseScaleY}\n                    scale-z={springs.buttonTop2BaseScaleXAndZ}\n                    rotation={[-Math.PI / 2, 0, 0]}\n                    position={props.buttonGroup2Position || [0.5, -1.3, 0]}>\n                    <mesh geometry={buttonLargeBaseGeo} material={buttonBaseMaterial} {...props.buttonLargeBaseProps} onPointerDown={() => onPointerDown(2)} />\n                    <mesh geometry={buttonTop2Geo} material={buttonTop2Material} position={[0, -0.3, 0]} {...props.buttonTop2Props} />\n                </animated.group>}\n            {/* Button 3 */}\n            {buttonNumber > 2 &&\n                <animated.group\n                    scale-x={springs.buttonTop3BaseScaleXAndZ}\n                    scale-y={springs.buttonTop3BaseScaleY}\n                    scale-z={springs.buttonTop3BaseScaleXAndZ}\n                    rotation={[-Math.PI / 2, 0, 0]}\n                    position={props.buttonGroup3Position || [-1, 1, 0]}>\n                    <mesh geometry={buttonSmallBaseGeo} material={buttonBaseMaterial} {...props.buttonSmallBaseProps} onPointerDown={() => onPointerDown(3)} />\n                    <mesh geometry={buttonTop3Geo} material={buttonTop3Material} position={[0, -0.3, 0]} {...props.buttonTop3Props} />\n                </animated.group>}\n            {/* Button 4 */}\n            {buttonNumber > 3 &&\n                <animated.group\n                    scale-x={springs.buttonTop4BaseScaleXAndZ}\n                    scale-y={springs.buttonTop4BaseScaleY}\n                    scale-z={springs.buttonTop4BaseScaleXAndZ}\n                    rotation={[-Math.PI / 2, 0, 0]}\n                    position={props.buttonGroup4Position || [-2, -1.3, 0]}>\n                    <mesh geometry={buttonSmallBaseGeo} material={buttonBaseMaterial} {...props.buttonSmallBaseProps} onPointerDown={() => onPointerDown(4)} />\n                    <mesh geometry={buttonTop4Geo} material={buttonTop4Material} position={[0, -0.3, 0]} {...props.buttonTop4Props} />\n                </animated.group>}\n            {/* Button 5 */}\n            {buttonNumber > 4 &&\n                <animated.group\n                    scale-x={springs.buttonTop5BaseScaleXAndZ}\n                    scale-y={springs.buttonTop5BaseScaleY}\n                    scale-z={springs.buttonTop5BaseScaleXAndZ}\n                    rotation={[-Math.PI / 2, 0, 0]}\n                    position={props.buttonGroup5Position || [0.4, 2.9, 0]}>\n                    <mesh geometry={buttonSmallBaseGeo} material={buttonBaseMaterial} {...props.buttonSmallBaseProps} onPointerDown={() => onPointerDown(5)} />\n                    <mesh geometry={buttonTop5Geo} material={buttonTop5Material} position={[0, -0.3, 0]} {...props.buttonTop5Props} />\n                </animated.group>}\n        </Suspense>\n    )\n}\n\nexport const EcctrlJoystick = forwardRef<HTMLDivElement, EcctrlJoystickProps>((props, ref) => {\n    const joystickWrapperStyle: React.CSSProperties = {\n        userSelect: \"none\",\n        MozUserSelect: \"none\",\n        WebkitUserSelect: \"none\",\n        msUserSelect: \"none\",\n        touchAction: \"none\",\n        pointerEvents: \"none\",\n        overscrollBehavior: \"none\",\n        position: 'fixed',\n        zIndex: '9999',\n        height: props.joystickHeightAndWidth || '200px',\n        width: props.joystickHeightAndWidth || '200px',\n        left: props.joystickPositionLeft || '0',\n        bottom: props.joystickPositionBottom || '0',\n    }\n\n    const buttonWrapperStyle: React.CSSProperties = {\n        userSelect: \"none\",\n        MozUserSelect: \"none\",\n        WebkitUserSelect: \"none\",\n        msUserSelect: \"none\",\n        touchAction: \"none\",\n        pointerEvents: \"none\",\n        overscrollBehavior: \"none\",\n        position: 'fixed',\n        zIndex: '9999',\n        height: props.buttonHeightAndWidth || '200px',\n        width: props.buttonHeightAndWidth || '200px',\n        right: props.buttonPositionRight || '0',\n        bottom: props.buttonPositionBottom || '0',\n    }\n\n    return (\n        <div ref={ref}>\n            <div id=\"ecctrl-joystick\" style={joystickWrapperStyle} onContextMenu={(e) => e.preventDefault()}>\n                <Canvas\n                    shadows\n                    orthographic\n                    camera={{\n                        zoom: props.joystickCamZoom || 26,\n                        position: props.joystickCamPosition || [0, 0, 50],\n                    }}\n                >\n                    <JoystickComponents {...props} />\n                    {props.children}\n                </Canvas>\n            </div>\n            {\n                props.buttonNumber !== 0 &&\n                <div id=\"ecctrl-button\" style={buttonWrapperStyle} onContextMenu={(e) => e.preventDefault()}>\n                    <Canvas\n                        shadows\n                        orthographic\n                        camera={{\n                            zoom: props.buttonCamZoom || 26,\n                            position: props.buttonCamPosition || [0, 0, 50],\n                        }}>\n                        <ButtonComponents {...props} />\n                        {props.children}\n                    </Canvas>\n                </div>\n            }\n        </div>\n    )\n})\n\nexport type EcctrlJoystickProps = {\n    // Joystick props\n    children?: ReactNode;\n    joystickRunSensitivity?: number;\n    joystickPositionLeft?: number;\n    joystickPositionBottom?: number;\n    joystickHeightAndWidth?: number;\n    joystickCamZoom?: number;\n    joystickCamPosition?: [x: number, y: number, z: number];\n    joystickBaseProps?: ThreeElements['mesh'];\n    joystickStickProps?: ThreeElements['mesh'];\n    joystickHandleProps?: ThreeElements['mesh'];\n\n    // Touch buttons props\n    buttonNumber?: number;\n    buttonPositionRight?: number;\n    buttonPositionBottom?: number;\n    buttonHeightAndWidth?: number;\n    buttonCamZoom?: number;\n    buttonCamPosition?: [x: number, y: number, z: number];\n    buttonGroup1Position?: [x: number, y: number, z: number];\n    buttonGroup2Position?: [x: number, y: number, z: number];\n    buttonGroup3Position?: [x: number, y: number, z: number];\n    buttonGroup4Position?: [x: number, y: number, z: number];\n    buttonGroup5Position?: [x: number, y: number, z: number];\n    buttonLargeBaseProps?: ThreeElements['mesh'];\n    buttonSmallBaseProps?: ThreeElements['mesh'];\n    buttonTop1Props?: ThreeElements['mesh'];\n    buttonTop2Props?: ThreeElements['mesh'];\n    buttonTop3Props?: ThreeElements['mesh'];\n    buttonTop4Props?: ThreeElements['mesh'];\n    buttonTop5Props?: ThreeElements['mesh'];\n};","import { useKeyboardControls } from \"@react-three/drei\";\nimport { useFrame } from \"@react-three/fiber\";\nimport {\n  quat,\n  RigidBody,\n  CapsuleCollider,\n  useRapier,\n  RapierRigidBody,\n  type RigidBodyProps,\n  CylinderCollider,\n} from \"@react-three/rapier\";\nimport { useEffect, useRef, useMemo, useState, useImperativeHandle, forwardRef, type ReactNode, type ForwardRefRenderFunction } from \"react\";\nimport * as THREE from \"three\";\nimport { useControls } from \"leva\";\nimport { useFollowCam } from \"./hooks/useFollowCam\";\nimport { useGame } from \"./stores/useGame\";\nimport { useJoystickControls } from \"./stores/useJoystickControls\";\nimport { QueryFilterFlags } from \"@dimforge/rapier3d-compat\";\nimport type {\n  Collider,\n  RayColliderHit,\n  Vector,\n} from \"@dimforge/rapier3d-compat\";\nimport React from \"react\";\n\nexport { EcctrlAnimation } from \"./EcctrlAnimation\";\nexport { useFollowCam } from \"./hooks/useFollowCam\";\nexport { useGame } from \"./stores/useGame\";\nexport { EcctrlJoystick } from \"./EcctrlJoystick\";\nexport { useJoystickControls } from \"./stores/useJoystickControls\";\n\n// Retrieve current moving direction of the character\nconst getMovingDirection = (forward: boolean,\n  backward: boolean,\n  leftward: boolean,\n  rightward: boolean,\n  pivot: THREE.Object3D)\n  : number | null => {\n  if (!forward && !backward && !leftward && !rightward) return null;\n  if (forward && leftward) return pivot.rotation.y + Math.PI / 4;\n  if (forward && rightward) return pivot.rotation.y - Math.PI / 4;\n  if (backward && leftward) return pivot.rotation.y - Math.PI / 4 + Math.PI;\n  if (backward && rightward) return pivot.rotation.y + Math.PI / 4 + Math.PI;\n  if (backward) return pivot.rotation.y + Math.PI;\n  if (leftward) return pivot.rotation.y + Math.PI / 2;\n  if (rightward) return pivot.rotation.y - Math.PI / 2;\n  if (forward) return pivot.rotation.y;\n  return null;\n};\n\nconst Ecctrl: ForwardRefRenderFunction<CustomEcctrlRigidBody, EcctrlProps> = ({\n  children,\n  debug = false,\n  capsuleHalfHeight = 0.35,\n  capsuleRadius = 0.3,\n  floatHeight = 0.3,\n  characterInitDir = 0, // in rad\n  followLight = false,\n  disableControl = false,\n  disableFollowCam = false,\n  disableFollowCamPos = null,\n  disableFollowCamTarget = null,\n  // Follow camera setups\n  camInitDis = -5,\n  camMaxDis = -7,\n  camMinDis = -0.7,\n  camUpLimit = 1.5, // in rad\n  camLowLimit = -1.3, // in rad\n  camInitDir = { x: 0, y: 0 }, // in rad\n  camTargetPos = { x: 0, y: 0, z: 0 },\n  camMoveSpeed = 1,\n  camZoomSpeed = 1,\n  camCollision = true,\n  camCollisionOffset = 0.7,\n  camCollisionSpeedMult = 4,\n  fixedCamRotMult = 1,\n  camListenerTarget = \"domElement\", // document or domElement\n  // Follow light setups\n  followLightPos = { x: 20, y: 30, z: 10 },\n  // Base control setups\n  maxVelLimit = 2.5,\n  turnVelMultiplier = 0.2,\n  turnSpeed = 15,\n  sprintMult = 2,\n  jumpVel = 4,\n  jumpForceToGroundMult = 5,\n  slopJumpMult = 0.25,\n  sprintJumpMult = 1.2,\n  airDragMultiplier = 0.2,\n  dragDampingC = 0.15,\n  accDeltaTime = 8,\n  rejectVelMult = 4,\n  moveImpulsePointY = 0.5,\n  camFollowMult = 11,\n  camLerpMult = 25,\n  fallingGravityScale = 2.5,\n  fallingMaxVel = -20,\n  wakeUpDelay = 200,\n  // Floating Ray setups\n  rayOriginOffest = { x: 0, y: -capsuleHalfHeight, z: 0 },\n  rayHitForgiveness = 0.1,\n  rayLength = capsuleRadius + 2,\n  rayDir = { x: 0, y: -1, z: 0 },\n  floatingDis = capsuleRadius + floatHeight,\n  springK = 1.2,\n  dampingC = 0.08,\n  // Slope Ray setups\n  showSlopeRayOrigin = false,\n  slopeMaxAngle = 1, // in rad\n  slopeRayOriginOffest = capsuleRadius - 0.03,\n  slopeRayLength = capsuleRadius + 3,\n  slopeRayDir = { x: 0, y: -1, z: 0 },\n  slopeUpExtraForce = 0.1,\n  slopeDownExtraForce = 0.2,\n  // AutoBalance Force setups\n  autoBalance = true,\n  autoBalanceSpringK = 0.3,\n  autoBalanceDampingC = 0.03,\n  autoBalanceSpringOnY = 0.5,\n  autoBalanceDampingOnY = 0.015,\n  // Animation temporary setups\n  animated = false,\n  // Mode setups\n  mode = null,\n  // Controller setups\n  controllerKeys = { forward: 12, backward: 13, leftward: 14, rightward: 15, jump: 2, action1: 11, action2: 3, action3: 1, action4: 0 },\n  // Point-to-move setups\n  bodySensorSize = [capsuleHalfHeight / 2, capsuleRadius],\n  bodySensorPosition = { x: 0, y: 0, z: capsuleRadius / 2 },\n  // Other rigibody props from parent\n  ...props\n}: EcctrlProps, ref) => {\n  const characterRef = useRef<RapierRigidBody | null>(null);\n  const characterModelRef = useRef<THREE.Group | null>(null);\n  const characterModelIndicator: THREE.Object3D = useMemo(() => new THREE.Object3D(), [])\n  const defaultControllerKeys = { forward: 12, backward: 13, leftward: 14, rightward: 15, jump: 2, action1: 11, action2: 3, action3: 1, action4: 0 }\n  useImperativeHandle<CustomEcctrlRigidBody | null, CustomEcctrlRigidBody | null>(ref, () => ({\n    get group() {\n      return characterRef.current;\n    },\n    rotateCamera,\n    rotateCharacterOnY,\n  }), []);\n\n  /**\n   * Mode setup\n   */\n  let isModePointToMove: boolean = false\n  let functionKeyDown: boolean = false\n  let isModeFixedCamera: boolean = false\n  let isModeCameraBased: boolean = false\n  const setMoveToPoint = useGame((state) => state.setMoveToPoint)\n  const findMode = (mode: string, modes: string) => modes.split(\" \").some(m => m === mode)\n  if (mode) {\n    if (findMode(\"PointToMove\", mode)) isModePointToMove = true\n    if (findMode(\"FixedCamera\", mode)) isModeFixedCamera = true\n    if (findMode(\"CameraBasedMovement\", mode)) isModeCameraBased = true\n  }\n\n  /** \n   * Body collider setup\n   */\n  const modelFacingVec: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const bodyFacingVec: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const bodyBalanceVec: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const bodyBalanceVecOnX: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const bodyFacingVecOnY: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const bodyBalanceVecOnZ: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const vectorY: THREE.Vector3 = useMemo(() => new THREE.Vector3(0, 1, 0), []);\n  const vectorZ: THREE.Vector3 = useMemo(() => new THREE.Vector3(0, 0, 1), []);\n  const crossVecOnX: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const crossVecOnY: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const crossVecOnZ: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const bodyContactForce: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const slopeRayOriginUpdatePosition: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const camBasedMoveCrossVecOnY: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n\n  // Animation change functions\n  const idleAnimation = !animated ? null : useGame((state) => state.idle);\n  const walkAnimation = !animated ? null : useGame((state) => state.walk);\n  const runAnimation = !animated ? null : useGame((state) => state.run);\n  const jumpAnimation = !animated ? null : useGame((state) => state.jump);\n  const jumpIdleAnimation = !animated\n    ? null\n    : useGame((state) => state.jumpIdle);\n  const fallAnimation = !animated ? null : useGame((state) => state.fall);\n  const action1Animation = !animated ? null : useGame((state) => state.action1);\n  const action2Animation = !animated ? null : useGame((state) => state.action2);\n  const action3Animation = !animated ? null : useGame((state) => state.action3);\n  const action4Animation = !animated ? null : useGame((state) => state.action4);\n\n  /**\n   * Debug settings\n   */\n  let characterControlsDebug = null;\n  let floatingRayDebug = null;\n  let slopeRayDebug = null;\n  let autoBalanceForceDebug = null;\n\n  // Character controls debug\n  characterControlsDebug = useControls(\n    \"Character Controls\",\n    debug\n      ? {\n        maxVelLimit: {\n          value: maxVelLimit,\n          min: 0,\n          max: 10,\n          step: 0.01,\n        },\n        turnVelMultiplier: {\n          value: turnVelMultiplier,\n          min: 0,\n          max: 1,\n          step: 0.01,\n        },\n        turnSpeed: {\n          value: turnSpeed,\n          min: 5,\n          max: 30,\n          step: 0.1,\n        },\n        sprintMult: {\n          value: sprintMult,\n          min: 1,\n          max: 5,\n          step: 0.01,\n        },\n        jumpVel: {\n          value: jumpVel,\n          min: 0,\n          max: 10,\n          step: 0.01,\n        },\n        jumpForceToGroundMult: {\n          value: jumpForceToGroundMult,\n          min: 0,\n          max: 80,\n          step: 0.1,\n        },\n        slopJumpMult: {\n          value: slopJumpMult,\n          min: 0,\n          max: 1,\n          step: 0.01,\n        },\n        sprintJumpMult: {\n          value: sprintJumpMult,\n          min: 1,\n          max: 3,\n          step: 0.01,\n        },\n        airDragMultiplier: {\n          value: airDragMultiplier,\n          min: 0,\n          max: 1,\n          step: 0.01,\n        },\n        dragDampingC: {\n          value: dragDampingC,\n          min: 0,\n          max: 0.5,\n          step: 0.01,\n        },\n        accDeltaTime: {\n          value: accDeltaTime,\n          min: 0,\n          max: 50,\n          step: 1,\n        },\n        rejectVelMult: {\n          value: rejectVelMult,\n          min: 0,\n          max: 10,\n          step: 0.1,\n        },\n        moveImpulsePointY: {\n          value: moveImpulsePointY,\n          min: 0,\n          max: 3,\n          step: 0.1,\n        },\n        camFollowMult: {\n          value: camFollowMult,\n          min: 0,\n          max: 15,\n          step: 0.1,\n        },\n      }\n      : {},\n    { collapsed: true }\n  ) as Partial<CharacterControlsSchema>;\n  if (debug) {\n    maxVelLimit = characterControlsDebug.maxVelLimit ?? maxVelLimit;\n    turnVelMultiplier = characterControlsDebug.turnVelMultiplier ?? turnVelMultiplier;\n    turnSpeed = characterControlsDebug.turnSpeed ?? turnSpeed;\n    sprintMult = characterControlsDebug.sprintMult ?? sprintMult;\n    jumpVel = characterControlsDebug.jumpVel ?? jumpVel;\n    jumpForceToGroundMult = characterControlsDebug.jumpForceToGroundMult ?? jumpForceToGroundMult;\n    slopJumpMult = characterControlsDebug.slopJumpMult ?? slopJumpMult;\n    sprintJumpMult = characterControlsDebug.sprintJumpMult ?? sprintJumpMult;\n    airDragMultiplier = characterControlsDebug.airDragMultiplier ?? airDragMultiplier;\n    dragDampingC = characterControlsDebug.dragDampingC ?? dragDampingC;\n    accDeltaTime = characterControlsDebug.accDeltaTime ?? accDeltaTime;\n    rejectVelMult = characterControlsDebug.rejectVelMult ?? rejectVelMult;\n    moveImpulsePointY = characterControlsDebug.moveImpulsePointY ?? moveImpulsePointY;\n    camFollowMult = characterControlsDebug.camFollowMult ?? camFollowMult;\n  }\n\n  // Floating ray debug\n  floatingRayDebug = useControls(\n    \"Floating Ray\",\n    debug\n      ? {\n        rayOriginOffest: {\n          x: 0,\n          y: -capsuleHalfHeight,\n          z: 0,\n        },\n        rayHitForgiveness: {\n          value: rayHitForgiveness,\n          min: 0,\n          max: 0.5,\n          step: 0.01,\n        },\n        rayLength: {\n          value: capsuleRadius + 2,\n          min: 0,\n          max: capsuleRadius + 10,\n          step: 0.01,\n        },\n        rayDir: { x: 0, y: -1, z: 0 },\n        floatingDis: {\n          value: capsuleRadius + floatHeight,\n          min: 0,\n          max: capsuleRadius + 2,\n          step: 0.01,\n        },\n        springK: {\n          value: springK,\n          min: 0,\n          max: 5,\n          step: 0.01,\n        },\n        dampingC: {\n          value: dampingC,\n          min: 0,\n          max: 3,\n          step: 0.01,\n        },\n      }\n      : {},\n    { collapsed: true }\n  ) as Partial<FloatingRaySchema>;\n  if (debug) {\n    rayOriginOffest = floatingRayDebug.rayOriginOffest ?? rayOriginOffest;\n    rayHitForgiveness = floatingRayDebug.rayHitForgiveness ?? rayHitForgiveness;\n    rayLength = floatingRayDebug.rayLength ?? rayLength;\n    rayDir = floatingRayDebug.rayDir ?? rayDir;\n    floatingDis = floatingRayDebug.floatingDis ?? floatingDis;\n    springK = floatingRayDebug.springK ?? springK;\n    dampingC = floatingRayDebug.dampingC ?? dampingC;\n  }\n\n  // Slope ray debug\n  slopeRayDebug = useControls(\n    \"Slope Ray\",\n    debug\n      ? {\n        showSlopeRayOrigin: false,\n        slopeMaxAngle: {\n          value: slopeMaxAngle,\n          min: 0,\n          max: 1.57,\n          step: 0.01\n        },\n        slopeRayOriginOffest: {\n          value: capsuleRadius,\n          min: 0,\n          max: capsuleRadius + 3,\n          step: 0.01,\n        },\n        slopeRayLength: {\n          value: capsuleRadius + 3,\n          min: 0,\n          max: capsuleRadius + 13,\n          step: 0.01,\n        },\n        slopeRayDir: { x: 0, y: -1, z: 0 },\n        slopeUpExtraForce: {\n          value: slopeUpExtraForce,\n          min: 0,\n          max: 5,\n          step: 0.01,\n        },\n        slopeDownExtraForce: {\n          value: slopeDownExtraForce,\n          min: 0,\n          max: 5,\n          step: 0.01,\n        },\n      }\n      : {},\n    { collapsed: true }\n  ) as Partial<SlopeRaySchema>;\n  if (debug) {\n    showSlopeRayOrigin = slopeRayDebug.showSlopeRayOrigin ?? showSlopeRayOrigin;\n    slopeMaxAngle = slopeRayDebug.slopeMaxAngle ?? slopeMaxAngle;\n    slopeRayOriginOffest = slopeRayDebug.slopeRayOriginOffest ?? slopeRayOriginOffest;\n    slopeRayLength = slopeRayDebug.slopeRayLength ?? slopeRayLength;\n    slopeRayDir = slopeRayDebug.slopeRayDir ?? slopeRayDir;\n    slopeUpExtraForce = slopeRayDebug.slopeUpExtraForce ?? slopeUpExtraForce;\n    slopeDownExtraForce = slopeRayDebug.slopeDownExtraForce ?? slopeDownExtraForce;\n  }\n\n  // Auto balance force debug\n  autoBalanceForceDebug = useControls(\n    \"AutoBalance Force\",\n    debug\n      ? {\n        autoBalance: {\n          value: true,\n        },\n        autoBalanceSpringK: {\n          value: autoBalanceSpringK,\n          min: 0,\n          max: 5,\n          step: 0.01,\n        },\n        autoBalanceDampingC: {\n          value: autoBalanceDampingC,\n          min: 0,\n          max: 0.1,\n          step: 0.001,\n        },\n        autoBalanceSpringOnY: {\n          value: autoBalanceSpringOnY,\n          min: 0,\n          max: 5,\n          step: 0.01,\n        },\n        autoBalanceDampingOnY: {\n          value: autoBalanceDampingOnY,\n          min: 0,\n          max: 0.1,\n          step: 0.001,\n        },\n      }\n      : {},\n    { collapsed: true }\n  ) as Partial<AutoBalanceForceSchema>;\n  if (debug) {\n    autoBalance = autoBalanceForceDebug.autoBalance ?? autoBalance;\n    autoBalanceSpringK = autoBalanceForceDebug.autoBalanceSpringK ?? autoBalanceSpringK;\n    autoBalanceDampingC = autoBalanceForceDebug.autoBalanceDampingC ?? autoBalanceDampingC;\n    autoBalanceSpringOnY = autoBalanceForceDebug.autoBalanceSpringOnY ?? autoBalanceSpringOnY;\n    autoBalanceDampingOnY = autoBalanceForceDebug.autoBalanceDampingOnY ?? autoBalanceDampingOnY;\n  }\n\n  /**\n   * Check if inside keyboardcontrols\n   */\n  function useIsInsideKeyboardControls() {\n    try {\n      return !!useKeyboardControls()\n    } catch {\n      return false\n    }\n  }\n  const isInsideKeyboardControls = useIsInsideKeyboardControls();\n\n  /**\n   * keyboard controls setup\n   */\n  const [subscribeKeys, getKeys] = isInsideKeyboardControls ? useKeyboardControls() : [null];\n  const presetKeys = { forward: false, backward: false, leftward: false, rightward: false, jump: false, run: false };\n  const { rapier, world } = useRapier();\n\n  /**\n   * Joystick controls setup\n   */\n  const getJoystickValues = useJoystickControls(state => state.getJoystickValues)\n  const pressButton1 = useJoystickControls((state) => state.pressButton1)\n  const pressButton2 = useJoystickControls((state) => state.pressButton2)\n  const pressButton3 = useJoystickControls((state) => state.pressButton3)\n  const pressButton4 = useJoystickControls((state) => state.pressButton4)\n  const pressButton5 = useJoystickControls((state) => state.pressButton5)\n  const releaseAllButtons = useJoystickControls((state) => state.releaseAllButtons)\n  const setJoystick = useJoystickControls((state) => state.setJoystick)\n  const resetJoystick = useJoystickControls((state) => state.resetJoystick)\n\n  /**\n   * Gamepad controls setup\n   */\n  const [controllerIndex, setControllerIndex] = useState<number | null>(null)\n  const gamepadKeys = { forward: false, backward: false, leftward: false, rightward: false };\n  const gamepadJoystickVec2: THREE.Vector2 = useMemo(() => new THREE.Vector2(), [])\n  let gamepadJoystickDis: number = 0\n  let gamepadJoystickAng: number = 0\n  const gamepadConnect = (e: any) => { setControllerIndex(e.gamepad.index) }\n  const gamepadDisconnect = () => { setControllerIndex(null) }\n  const mergedKeys = useMemo(() => Object.assign({}, defaultControllerKeys, controllerKeys), [controllerKeys])\n  const handleButtons = (buttons: readonly GamepadButton[]) => {\n    gamepadKeys.forward = buttons[mergedKeys.forward].pressed\n    gamepadKeys.backward = buttons[mergedKeys.backward].pressed\n    gamepadKeys.leftward = buttons[mergedKeys.leftward].pressed\n    gamepadKeys.rightward = buttons[mergedKeys.rightward].pressed\n\n    // Gamepad trigger the EcctrlJoystick buttons to play animations\n    if (buttons[mergedKeys.action4].pressed) {\n      pressButton2()\n    } else if (buttons[mergedKeys.action3].pressed) {\n      pressButton4()\n    } else if (buttons[mergedKeys.jump].pressed) {\n      pressButton1()\n    } else if (buttons[mergedKeys.action2].pressed) {\n      pressButton3()\n    } else if (buttons[mergedKeys.action1].pressed) {\n      pressButton5()\n    } else {\n      releaseAllButtons()\n    }\n  }\n\n  const handleSticks = (axes: readonly number[]) => {\n    // Gamepad first joystick trigger the EcctrlJoystick event to move the character\n    if (Math.abs(axes[0]) > 0 || Math.abs(axes[1]) > 0) {\n      gamepadJoystickVec2.set(axes[0], -axes[1])\n      gamepadJoystickDis = Math.min(Math.sqrt(Math.pow(gamepadJoystickVec2.x, 2) + Math.pow(gamepadJoystickVec2.y, 2)), 1)\n      gamepadJoystickAng = gamepadJoystickVec2.angle()\n      const runState = gamepadJoystickDis > 0.7\n      setJoystick(gamepadJoystickDis, gamepadJoystickAng, runState)\n    } else {\n      gamepadJoystickDis = 0\n      gamepadJoystickAng = 0\n      resetJoystick()\n    }\n    // Gamepad second joystick trigger the useFollowCam event to move the camera\n    if (Math.abs(axes[2]) > 0 || Math.abs(axes[3]) > 0) {\n      joystickCamMove(axes[2], axes[3])\n    }\n  }\n\n  // can jump setup\n  let canJump: boolean = false;\n  let isFalling: boolean = false;\n  const initialGravityScale: number = useMemo(() => props.gravityScale ?? 1, [])\n\n  // on moving object state\n  let massRatio: number = 1;\n  let isOnMovingObject: boolean = false;\n  const standingForcePoint: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const movingObjectDragForce: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const movingObjectVelocity: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const movingObjectVelocityInCharacterDir: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const distanceFromCharacterToObject: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const objectAngvelToLinvel: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const velocityDiff: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n\n  /**\n   * Initial light setup\n   */\n  let dirLight: THREE.DirectionalLight;\n\n  /**\n   * Follow camera initial setups from props\n   */\n  const cameraSetups = {\n    disableFollowCam,\n    disableFollowCamPos,\n    disableFollowCamTarget,\n    camInitDis,\n    camMaxDis,\n    camMinDis,\n    camUpLimit,\n    camLowLimit,\n    camInitDir,\n    camMoveSpeed: isModeFixedCamera ? 0 : camMoveSpeed, // Disable camera move in fixed camera mode\n    camZoomSpeed: isModeFixedCamera ? 0 : camZoomSpeed, // Disable camera zoom in fixed camera mode\n    camCollisionOffset,\n    camCollisionSpeedMult,\n    camListenerTarget,\n  };\n\n  /**\n   * Load camera pivot and character move preset\n   */\n  const { pivot, followCam, cameraCollisionDetect, joystickCamMove } =\n    useFollowCam(cameraSetups);\n  const pivotPosition: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const pivotXAxis: THREE.Vector3 = useMemo(() => new THREE.Vector3(1, 0, 0), []);\n  const pivotYAxis: THREE.Vector3 = useMemo(() => new THREE.Vector3(0, 1, 0), []);\n  const pivotZAxis: THREE.Vector3 = useMemo(() => new THREE.Vector3(0, 0, 1), []);\n  const followCamPosition: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const modelEuler: THREE.Euler = useMemo(() => new THREE.Euler(), []);\n  const modelQuat: THREE.Quaternion = useMemo(() => new THREE.Quaternion(), []);\n  const moveImpulse: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const movingDirection: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const moveAccNeeded: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const jumpVelocityVec: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const jumpDirection: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const currentVel: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const currentPos: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const dragForce: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const dragAngForce: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const wantToMoveVel: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const rejectVel: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n\n  /**\n   * Floating Ray setup\n   */\n  let floatingForce = null;\n  const springDirVec: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const characterMassForce: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const rayOrigin: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const rayCast = new rapier.Ray(rayOrigin, rayDir);\n  let rayHit: RayColliderHit | null = null;\n\n  /**Test shape ray */\n  // const shape = new rapier.Capsule(0.2,0.1)\n\n  /**\n   * Slope detection ray setup\n   */\n  let slopeAngle: number = 0;\n  let actualSlopeNormal: Vector | null = null;\n  let actualSlopeAngle: number = 0;\n  const actualSlopeNormalVec: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const floorNormal: THREE.Vector3 = useMemo(() => new THREE.Vector3(0, 1, 0), []);\n  const slopeRayOriginRef = useRef<THREE.Mesh | null>(null);\n  const slopeRayorigin: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const slopeRayCast = new rapier.Ray(slopeRayorigin, slopeRayDir);\n  let slopeRayHit: RayColliderHit | null = null;\n\n  /**\n   * Point to move setup\n   */\n  let isBodyHitWall = false;\n  let isPointMoving = false;\n  const crossVector: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const pointToPoint: THREE.Vector3 = useMemo(() => new THREE.Vector3(), []);\n  const getMoveToPoint = useGame((state) => state.getMoveToPoint);\n  const bodySensorRef = useRef<Collider | null>(null);\n  const handleOnIntersectionEnter = () => {\n    isBodyHitWall = true\n  }\n  const handleOnIntersectionExit = () => {\n    isBodyHitWall = false\n  }\n\n  /**\n   * Character moving function\n   */\n  let characterRotated: boolean = true;\n  const moveCharacter = (\n    _: number,\n    run: boolean,\n    slopeAngle: number,\n    movingObjectVelocity: THREE.Vector3\n  ) => {\n    if (!characterRef.current) return\n\n    /**\n     * Setup moving direction\n     */\n    // Only apply slope angle to moving direction\n    // when slope angle is between 0.2rad and slopeMaxAngle, \n    // and actualSlopeAngle < slopeMaxAngle\n    if (\n      actualSlopeAngle < slopeMaxAngle &&\n      Math.abs(slopeAngle) > 0.2 &&\n      Math.abs(slopeAngle) < slopeMaxAngle\n    ) {\n      movingDirection.set(0, Math.sin(slopeAngle), Math.cos(slopeAngle));\n    }\n    // If on a slopeMaxAngle slope, only apply small a mount of forward direction\n    else if (actualSlopeAngle >= slopeMaxAngle) {\n      movingDirection.set(\n        0,\n        Math.sin(slopeAngle) > 0 ? 0 : Math.sin(slopeAngle),\n        Math.sin(slopeAngle) > 0 ? 0.1 : 1\n      );\n    } else {\n      movingDirection.set(0, 0, 1);\n    }\n\n    // Apply character quaternion to moving direction\n    movingDirection.applyQuaternion(characterModelIndicator.quaternion);\n\n    /**\n     * Moving object conditions\n     */\n    // Calculate moving object velocity direction according to character moving direction\n    movingObjectVelocityInCharacterDir\n      .copy(movingObjectVelocity)\n      .projectOnVector(movingDirection)\n      .multiply(movingDirection);\n    // Calculate angle between moving object velocity direction and character moving direction\n    const angleBetweenCharacterDirAndObjectDir =\n      movingObjectVelocity.angleTo(movingDirection);\n\n    /**\n     * Setup rejection velocity, (currently only work on ground)\n     */\n    const wantToMoveMeg = currentVel.dot(movingDirection);\n    wantToMoveVel.set(\n      movingDirection.x * wantToMoveMeg,\n      0,\n      movingDirection.z * wantToMoveMeg\n    );\n    rejectVel.copy(currentVel).sub(wantToMoveVel);\n\n    /**\n     * Calculate required accelaration and force: a = v/t\n     * If it's on a moving/rotating platform, apply platform velocity to v accordingly\n     * Also, apply reject velocity when character is moving opposite of it's moving direction\n     */\n    moveAccNeeded.set(\n      (movingDirection.x *\n        (maxVelLimit * (run ? sprintMult : 1) +\n          movingObjectVelocityInCharacterDir.x) -\n        (currentVel.x -\n          movingObjectVelocity.x *\n          Math.sin(angleBetweenCharacterDirAndObjectDir) +\n          rejectVel.x * (isOnMovingObject ? 0 : rejectVelMult))) /\n      accDeltaTime,\n      0,\n      (movingDirection.z *\n        (maxVelLimit * (run ? sprintMult : 1) +\n          movingObjectVelocityInCharacterDir.z) -\n        (currentVel.z -\n          movingObjectVelocity.z *\n          Math.sin(angleBetweenCharacterDirAndObjectDir) +\n          rejectVel.z * (isOnMovingObject ? 0 : rejectVelMult))) /\n      accDeltaTime\n    );\n\n    // Wanted to move force function: F = ma\n    const moveForceNeeded = moveAccNeeded.multiplyScalar(\n      characterRef.current.mass()\n    );\n\n    /**\n     * Check if character complete turned to the wanted direction\n     */\n    characterRotated =\n      Math.sin(characterModelIndicator.rotation.y).toFixed(3) ==\n      Math.sin(modelEuler.y).toFixed(3);\n\n    // If character hasn't complete turning, change the impulse quaternion follow characterModelIndicator quaternion\n    if (!characterRotated) {\n      moveImpulse.set(\n        moveForceNeeded.x *\n        turnVelMultiplier *\n        (canJump ? 1 : airDragMultiplier), // if it's in the air, give it less control\n        slopeAngle === null || slopeAngle == 0 // if it's on a slope, apply extra up/down force to the body\n          ? 0\n          : movingDirection.y *\n          turnVelMultiplier *\n          (movingDirection.y > 0 // check it is on slope up or slope down\n            ? slopeUpExtraForce\n            : slopeDownExtraForce) *\n          (run ? sprintMult : 1),\n        moveForceNeeded.z *\n        turnVelMultiplier *\n        (canJump ? 1 : airDragMultiplier) // if it's in the air, give it less control\n      );\n    }\n    // If character complete turning, change the impulse quaternion default\n    else {\n      moveImpulse.set(\n        moveForceNeeded.x * (canJump ? 1 : airDragMultiplier),\n        slopeAngle === null || slopeAngle == 0 // if it's on a slope, apply extra up/down force to the body\n          ? 0\n          : movingDirection.y *\n          (movingDirection.y > 0 // check it is on slope up or slope down\n            ? slopeUpExtraForce\n            : slopeDownExtraForce) *\n          (run ? sprintMult : 1),\n        moveForceNeeded.z * (canJump ? 1 : airDragMultiplier)\n      );\n    }\n\n    // Move character at proper direction and impulse\n    characterRef.current.applyImpulseAtPoint(\n      moveImpulse,\n      {\n        x: currentPos.x,\n        y: currentPos.y + moveImpulsePointY,\n        z: currentPos.z,\n      },\n      true\n    );\n  };\n\n  /**\n   * Character auto balance function\n   */\n  const autoBalanceCharacter = () => {\n    if (!characterRef.current) return\n    // Match body component to character model rotation on Y\n    bodyFacingVec.set(0, 0, 1).applyQuaternion(quat(characterRef.current.rotation()))\n    bodyBalanceVec.set(0, 1, 0).applyQuaternion(quat(characterRef.current.rotation()))\n\n    bodyBalanceVecOnX.set(0, bodyBalanceVec.y, bodyBalanceVec.z)\n    bodyFacingVecOnY.set(bodyFacingVec.x, 0, bodyFacingVec.z)\n    bodyBalanceVecOnZ.set(bodyBalanceVec.x, bodyBalanceVec.y, 0)\n\n    // Check if is camera based movement\n    if (isModeCameraBased && slopeRayOriginRef.current) {\n      modelEuler.y = pivot.rotation.y\n      pivot.getWorldDirection(modelFacingVec)\n      // Update slopeRayOrigin to new positon\n      slopeRayOriginUpdatePosition.set(movingDirection.x, 0, movingDirection.z)\n      camBasedMoveCrossVecOnY.copy(slopeRayOriginUpdatePosition).cross(modelFacingVec)\n      slopeRayOriginRef.current.position.x = slopeRayOriginOffest * Math.sin(slopeRayOriginUpdatePosition.angleTo(modelFacingVec) * (camBasedMoveCrossVecOnY.y < 0 ? 1 : -1))\n      slopeRayOriginRef.current.position.z = slopeRayOriginOffest * Math.cos(slopeRayOriginUpdatePosition.angleTo(modelFacingVec) * (camBasedMoveCrossVecOnY.y < 0 ? 1 : -1))\n    } else {\n      characterModelIndicator.getWorldDirection(modelFacingVec)\n    }\n    crossVecOnX.copy(vectorY).cross(bodyBalanceVecOnX);\n    crossVecOnY.copy(modelFacingVec).cross(bodyFacingVecOnY);\n    crossVecOnZ.copy(vectorY).cross(bodyBalanceVecOnZ);\n\n    dragAngForce.set(\n      (crossVecOnX.x < 0 ? 1 : -1) *\n      autoBalanceSpringK * (bodyBalanceVecOnX.angleTo(vectorY))\n      - characterRef.current.angvel().x * autoBalanceDampingC,\n      (crossVecOnY.y < 0 ? 1 : -1) *\n      autoBalanceSpringOnY * (modelFacingVec.angleTo(bodyFacingVecOnY))\n      - characterRef.current.angvel().y * autoBalanceDampingOnY,\n      (crossVecOnZ.z < 0 ? 1 : -1) *\n      autoBalanceSpringK * (bodyBalanceVecOnZ.angleTo(vectorY))\n      - characterRef.current.angvel().z * autoBalanceDampingC,\n    );\n\n    // Apply balance torque impulse\n    characterRef.current.applyTorqueImpulse(dragAngForce, true)\n  };\n\n  /**\n   * Character sleep function\n   */\n  const sleepCharacter = () => {\n    if (!characterRef.current) return\n    if (document.visibilityState === \"hidden\") {\n      characterRef.current.sleep()\n    } else {\n      setTimeout(() => {\n        if (characterRef.current) characterRef.current.wakeUp()\n      }, wakeUpDelay)\n    }\n  }\n\n  /**\n   * Point-to-move function\n   */\n  const pointToMove = (delta: number, slopeAngle: number, movingObjectVelocity: THREE.Vector3, functionKeyDown: boolean) => {\n    const moveToPoint = getMoveToPoint().moveToPoint;\n    if (moveToPoint) {\n      pointToPoint.set(moveToPoint.x - currentPos.x, 0, moveToPoint.z - currentPos.z)\n      crossVector.crossVectors(pointToPoint, vectorZ)\n      // Rotate character to moving direction\n      modelEuler.y = (crossVector.y > 0 ? -1 : 1) * pointToPoint.angleTo(vectorZ);\n      // If mode is also set to fixed camera. keep the camera on the back of character\n      if (isModeFixedCamera) pivot.rotation.y = THREE.MathUtils.lerp(pivot.rotation.y, modelEuler.y, fixedCamRotMult * delta * 3);\n      // Once character close to the target point (distance<0.3),\n      // Or character close to the wall (bodySensor intersects) \n      // stop moving\n      if (characterRef.current) {\n        if (pointToPoint.length() > 0.3 && !isBodyHitWall && !functionKeyDown) {\n          moveCharacter(delta, false, slopeAngle, movingObjectVelocity)\n          isPointMoving = true\n        } else {\n          setMoveToPoint(null);\n          isPointMoving = false\n        }\n      }\n    }\n  }\n\n  /**\n   * Rotate camera function\n   */\n  const rotateCamera = (x: number, y: number) => {\n    pivot.rotation.y += y;\n    followCam.rotation.x = Math.min(\n      Math.max(followCam.rotation.x + x, camLowLimit),\n      camUpLimit\n    );\n  };\n\n  /**\n   * Rotate character on Y function\n   */\n  const rotateCharacterOnY = (rad: number) => {\n    modelEuler.y += rad;\n  };\n\n  useEffect(() => {\n    // Initialize directional light\n    if (followLight && characterModelRef.current) {\n      dirLight = characterModelRef.current.parent?.parent?.children.find(\n        (item) => {\n          return item.name === \"followLight\";\n        }\n      ) as THREE.DirectionalLight;\n    }\n  });\n\n  /**\n   * Keyboard controls subscribe setup\n   */\n  // If inside keyboardcontrols, active subscribeKeys\n  if (isInsideKeyboardControls && subscribeKeys) {\n    useEffect(() => {\n      if (!animated) return\n\n      // Action 1 key subscribe for special animation\n      const unSubscribeAction1 = subscribeKeys(\n        (state) => state.action1,\n        (value) => {\n          if (value) {\n            action1Animation && action1Animation();\n          }\n        }\n      );\n\n      // Action 2 key subscribe for special animation\n      const unSubscribeAction2 = subscribeKeys(\n        (state) => state.action2,\n        (value) => {\n          if (value) {\n            action2Animation && action2Animation();\n          }\n        }\n      );\n\n      // Action 3 key subscribe for special animation\n      const unSubscribeAction3 = subscribeKeys(\n        (state) => state.action3,\n        (value) => {\n          if (value) {\n            action3Animation && action3Animation();\n          }\n        }\n      );\n\n      // Trigger key subscribe for special animation\n      const unSubscribeAction4 = subscribeKeys(\n        (state) => state.action4,\n        (value) => {\n          if (value) {\n            action4Animation && action4Animation();\n          }\n        }\n      );\n\n      return () => {\n        unSubscribeAction1();\n        unSubscribeAction2();\n        unSubscribeAction3();\n        unSubscribeAction4();\n      };\n    });\n  }\n\n  /**\n   * Joystick subscribe setup\n   */\n  useEffect(() => {\n    if (!animated) return\n\n    // Subscribe button 2\n    const unSubPressButton2 = useJoystickControls.subscribe(\n      (state) => state.curButton2Pressed,\n      (value) => {\n        if (value) {\n          action4Animation && action4Animation();\n        }\n      }\n    )\n\n    // Subscribe button 3\n    const unSubPressButton3 = useJoystickControls.subscribe(\n      (state) => state.curButton3Pressed,\n      (value) => {\n        if (value) {\n          action2Animation && action2Animation();\n        }\n      }\n    )\n\n    // Subscribe button 4\n    const unSubPressButton4 = useJoystickControls.subscribe(\n      (state) => state.curButton4Pressed,\n      (value) => {\n        if (value) {\n          action3Animation && action3Animation();\n        }\n      }\n    )\n\n    // Subscribe button 5\n    const unSubPressButton5 = useJoystickControls.subscribe(\n      (state) => state.curButton5Pressed,\n      (value) => {\n        if (value) {\n          action1Animation && action1Animation();\n        }\n      }\n    )\n\n    return () => {\n      unSubPressButton2();\n      unSubPressButton3();\n      unSubPressButton4();\n      unSubPressButton5();\n    };\n  })\n\n  useEffect(() => {\n    // Lock character rotations at Y axis\n    characterRef.current?.setEnabledRotations(\n      autoBalance ? true : false,\n      autoBalance ? true : false,\n      autoBalance ? true : false,\n      false\n    );\n\n    // Reset character quaternion\n    return (() => {\n      if (characterRef.current && characterModelRef.current) {\n        characterModelRef.current.quaternion.set(0, 0, 0, 1);\n        characterRef.current.setRotation({ x: 0, y: 0, z: 0, w: 1 }, false);\n      }\n    })\n  }, [autoBalance]);\n\n  useEffect(() => {\n    // Initialize character facing direction\n    modelEuler.y = characterInitDir\n\n    window.addEventListener(\"visibilitychange\", sleepCharacter);\n    window.addEventListener(\"gamepadconnected\", gamepadConnect);\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnect);\n\n    return () => {\n      window.removeEventListener(\"visibilitychange\", sleepCharacter);\n      window.removeEventListener(\"gamepadconnected\", gamepadConnect);\n      window.removeEventListener(\"gamepaddisconnected\", gamepadDisconnect);\n    }\n  }, [])\n\n  useFrame((state, delta) => {\n    if (delta > 1) delta %= 1;\n\n    // Character current position/velocity\n    if (!characterRef.current) return\n    currentPos.copy(characterRef.current.translation() as THREE.Vector3);\n    currentVel.copy(characterRef.current.linvel() as THREE.Vector3);\n    // Assign userDate properties\n    (characterRef.current.userData as userDataType).canJump = canJump;\n    (characterRef.current.userData as userDataType).slopeAngle = slopeAngle;\n    (characterRef.current.userData as userDataType).characterRotated = characterRotated;\n    (characterRef.current.userData as userDataType).isOnMovingObject = isOnMovingObject;\n\n\n    /**\n     * Apply character position to directional light\n     */\n    if (followLight && dirLight && characterModelRef.current) {\n      dirLight.position.x = currentPos.x + followLightPos.x;\n      dirLight.position.y = currentPos.y + followLightPos.y;\n      dirLight.position.z = currentPos.z + followLightPos.z;\n      dirLight.target = characterModelRef.current;\n    }\n\n    /**\n     * Camera movement\n     */\n    pivotXAxis.set(1, 0, 0)\n    pivotXAxis.applyQuaternion(pivot.quaternion)\n    pivotZAxis.set(0, 0, 1)\n    pivotZAxis.applyQuaternion(pivot.quaternion)\n    pivotPosition.copy(currentPos)\n      .addScaledVector(pivotXAxis, camTargetPos.x)\n      .addScaledVector(pivotYAxis, camTargetPos.y + (capsuleHalfHeight + capsuleRadius / 2))\n      .addScaledVector(pivotZAxis, camTargetPos.z)\n    pivot.position.lerp(pivotPosition, 1 - Math.exp(-camFollowMult * delta));\n\n    if (!disableFollowCam) {\n      followCam.getWorldPosition(followCamPosition);\n      state.camera.position.lerp(followCamPosition, 1 - Math.exp(-camLerpMult * delta));\n      state.camera.lookAt(pivot.position);\n    }\n\n    /**\n     * Camera collision detect\n     */\n    camCollision && cameraCollisionDetect(delta);\n\n    /**\n     * If disableControl is true, skip all following features \n     */\n    if (disableControl) return;\n\n    /**\n     * Getting all gamepad control values\n     */\n    if (controllerIndex !== null) {\n      const gamepad = navigator.getGamepads()[controllerIndex]\n      if (!gamepad) return\n      handleButtons(gamepad.buttons)\n      handleSticks(gamepad.axes)\n      // Getting moving directions (IIFE)\n      modelEuler.y = ((movingDirection) => movingDirection === null ? modelEuler.y : movingDirection)\n        (getMovingDirection(gamepadKeys.forward, gamepadKeys.backward, gamepadKeys.leftward, gamepadKeys.rightward, pivot))\n    }\n\n    /**\n     * Getting all joystick control values\n     */\n    const {\n      joystickDis,\n      joystickAng,\n      runState,\n      button1Pressed,\n    } = getJoystickValues()\n\n    // Move character to the moving direction (joystick controls)\n    if (joystickDis > 0) {\n      // Apply camera rotation to character model\n      modelEuler.y = pivot.rotation.y + (joystickAng - Math.PI / 2)\n      moveCharacter(delta, runState, slopeAngle, movingObjectVelocity);\n    }\n\n    /**\n     * Getting all the useful keys from useKeyboardControls\n     */\n    const { forward, backward, leftward, rightward, jump, run } = (isInsideKeyboardControls && getKeys) ? getKeys() : presetKeys;\n\n    // Getting moving directions (IIFE)\n    modelEuler.y = ((movingDirection) => movingDirection === null ? modelEuler.y : movingDirection)\n      (getMovingDirection(forward, backward, leftward, rightward, pivot))\n\n    // Move character to the moving direction\n    if (forward || backward || leftward || rightward || gamepadKeys.forward || gamepadKeys.backward || gamepadKeys.leftward || gamepadKeys.rightward)\n      moveCharacter(delta, run, slopeAngle, movingObjectVelocity);\n\n    // Jump impulse\n    if ((jump || button1Pressed) && canJump) {\n      // characterRef.current.applyImpulse(jumpDirection.set(0, 0.5, 0), true);\n      jumpVelocityVec.set(\n        currentVel.x,\n        run ? sprintJumpMult * jumpVel : jumpVel,\n        currentVel.z\n      );\n      // Apply slope normal to jump direction\n      characterRef.current.setLinvel(\n        jumpDirection\n          .set(0, (run ? sprintJumpMult * jumpVel : jumpVel) * slopJumpMult, 0)\n          .projectOnVector(actualSlopeNormalVec)\n          .add(jumpVelocityVec),\n        true\n      );\n      // Apply jump force downward to the standing platform\n      characterMassForce.y *= jumpForceToGroundMult;\n      rayHit?.collider\n        .parent()\n        ?.applyImpulseAtPoint(characterMassForce, standingForcePoint, true);\n    }\n\n    // Rotate character Indicator\n    modelQuat.setFromEuler(modelEuler);\n    characterModelIndicator.quaternion.rotateTowards(\n      modelQuat,\n      delta * turnSpeed\n    );\n\n    // If autobalance is off, rotate character model itself\n    if (!autoBalance && characterModelRef.current) {\n      if (isModeCameraBased) {\n        characterModelRef.current.quaternion.copy(pivot.quaternion)\n      } else {\n        characterModelRef.current.quaternion.copy(characterModelIndicator.quaternion)\n      }\n    }\n\n    /**\n     * Ray casting detect if on ground\n     */\n    rayOrigin.addVectors(currentPos, rayOriginOffest as THREE.Vector3);\n    rayHit = world.castRay(\n      rayCast,\n      rayLength,\n      false,\n      QueryFilterFlags.EXCLUDE_SENSORS,\n      undefined,\n      undefined,\n      characterRef.current,\n      // this exclude any collider with userData: excludeEcctrlRay\n      ((collider: Collider) => {\n        const parent = collider.parent();\n        if (!parent) return false;\n        const data = parent.userData as userDataType | undefined;\n        return !data?.excludeEcctrlRay;\n      })\n    );\n\n    /**Test shape ray */\n    // rayHit = world.castShape(\n    //   currentPos,\n    //   { w: 0, x: 0, y: 0, z: 0 },\n    //   {x:0,y:-1,z:0},\n    //   shape,\n    //   rayLength,\n    //   true,\n    //   null,\n    //   null,\n    //   characterRef.current\n    // );\n\n    if (rayHit && rayHit.timeOfImpact < floatingDis + rayHitForgiveness) {\n      if (slopeRayHit && actualSlopeAngle < slopeMaxAngle) {\n        canJump = true;\n      }\n    } else {\n      canJump = false;\n    }\n\n    /**\n     * Ray detect if on rigid body or dynamic platform, then apply the linear velocity and angular velocity to character\n     */\n    if (rayHit && canJump) {\n      if (rayHit.collider.parent()) {\n        // Getting the standing force apply point\n        standingForcePoint.set(\n          rayOrigin.x,\n          rayOrigin.y - rayHit.timeOfImpact,\n          rayOrigin.z\n        );\n        const rayHitObjectBodyType = rayHit.collider.parent()?.bodyType();\n        const rayHitObjectBodyMass = rayHit.collider.parent()?.mass();\n        if (rayHitObjectBodyMass) massRatio = characterRef.current.mass() / rayHitObjectBodyMass;\n        // Body type 0 is rigid body, body type 1 is fixed body, body type 2 is kinematic body\n        if (rayHitObjectBodyType === 0 || rayHitObjectBodyType === 2) {\n          isOnMovingObject = true;\n          // Calculate distance between character and moving object\n          distanceFromCharacterToObject\n            .copy(currentPos)\n            .sub(rayHit.collider.parent()?.translation() as THREE.Vector3);\n          // Moving object linear velocity\n          const movingObjectLinvel = rayHit.collider.parent()?.linvel() as THREE.Vector3;\n          // Moving object angular velocity\n          const movingObjectAngvel = rayHit.collider.parent()?.angvel() as THREE.Vector3;\n          // Combine object linear velocity and angular velocity to movingObjectVelocity\n          movingObjectVelocity.set(\n            movingObjectLinvel.x +\n            objectAngvelToLinvel.crossVectors(\n              movingObjectAngvel,\n              distanceFromCharacterToObject\n            ).x,\n            movingObjectLinvel.y,\n            movingObjectLinvel.z +\n            objectAngvelToLinvel.crossVectors(\n              movingObjectAngvel,\n              distanceFromCharacterToObject\n            ).z\n          ).multiplyScalar(Math.min(1, 1 / massRatio));\n          // If the velocity diff is too high (> 30), ignore movingObjectVelocity\n          velocityDiff.subVectors(movingObjectVelocity, currentVel);\n          if (velocityDiff.length() > 30) movingObjectVelocity.multiplyScalar(1 / velocityDiff.length());\n\n          // Apply opposite drage force to the stading rigid body, body type 0\n          // Character moving and unmoving should provide different drag force to the platform\n          if (rayHitObjectBodyType === 0) {\n            if (\n              !forward && !backward && !leftward && !rightward &&\n              canJump &&\n              joystickDis === 0 &&\n              !isPointMoving &&\n              !gamepadKeys.forward && !gamepadKeys.backward && !gamepadKeys.leftward && !gamepadKeys.rightward\n            ) {\n              movingObjectDragForce.copy(bodyContactForce)\n                .multiplyScalar(delta)\n                .multiplyScalar(Math.min(1, 1 / massRatio)) // Scale up/down base on different masses ratio\n                .negate()\n              bodyContactForce.set(0, 0, 0);\n            } else {\n              movingObjectDragForce.copy(moveImpulse)\n                .multiplyScalar(Math.min(1, 1 / massRatio)) // Scale up/down base on different masses ratio\n                .negate();\n            }\n            rayHit.collider.parent()?.applyImpulseAtPoint(\n              movingObjectDragForce,\n              standingForcePoint,\n              true\n            );\n          }\n        } else { // on fixed body\n          massRatio = 1;\n          isOnMovingObject = false;\n          bodyContactForce.set(0, 0, 0);\n          movingObjectVelocity.set(0, 0, 0);\n        }\n      }\n    } else { // in the air\n      massRatio = 1;\n      isOnMovingObject = false;\n      bodyContactForce.set(0, 0, 0);\n      movingObjectVelocity.set(0, 0, 0);\n    }\n\n    /**\n     * Slope ray casting detect if on slope\n     */\n    slopeRayOriginRef.current?.getWorldPosition(slopeRayorigin);\n    slopeRayorigin.y = rayOrigin.y;\n    slopeRayHit = world.castRay(\n      slopeRayCast,\n      slopeRayLength,\n      false,\n      QueryFilterFlags.EXCLUDE_SENSORS,\n      undefined,\n      undefined,\n      characterRef.current,\n      // this exclude any collider with userData: excludeEcctrlRay\n      ((collider: Collider) => {\n        const parent = collider.parent();\n        if (!parent) return false;\n        const data = parent.userData as userDataType | undefined;\n        return !data?.excludeEcctrlRay;\n      })\n    );\n\n    // Calculate slope angle\n    if (slopeRayHit) {\n      actualSlopeNormal = slopeRayHit.collider.castRayAndGetNormal(\n        slopeRayCast,\n        slopeRayLength,\n        false\n      )?.normal ?? null;\n      if (actualSlopeNormal) {\n        actualSlopeNormalVec?.set(\n          actualSlopeNormal.x,\n          actualSlopeNormal.y,\n          actualSlopeNormal.z\n        );\n        actualSlopeAngle = actualSlopeNormalVec?.angleTo(floorNormal);\n      }\n    }\n    if (slopeRayHit && rayHit && slopeRayHit.timeOfImpact < floatingDis + 0.5) {\n      if (canJump) {\n        // Round the slope angle to 2 decimal places\n        slopeAngle = Number(\n          Math.atan(\n            (rayHit.timeOfImpact - slopeRayHit.timeOfImpact) / slopeRayOriginOffest\n          ).toFixed(2)\n        );\n      } else {\n        slopeAngle = 0;\n      }\n    } else {\n      slopeAngle = 0;\n    }\n\n    /**\n     * Apply floating force\n     */\n    if (rayHit != null) {\n      if (canJump && rayHit.collider.parent()) {\n        floatingForce =\n          springK * (floatingDis - rayHit.timeOfImpact) -\n          characterRef.current.linvel().y * dampingC;\n        characterRef.current.applyImpulse(\n          springDirVec.set(0, floatingForce, 0),\n          false\n        );\n\n        // Apply opposite force to standing object (gravity g in rapier is 0.11 ?_?)\n        characterMassForce.set(0, floatingForce > 0 ? -floatingForce : 0, 0);\n        rayHit.collider\n          .parent()\n          ?.applyImpulseAtPoint(characterMassForce, standingForcePoint, true);\n      }\n    }\n\n    /**\n     * Apply drag force if it's not moving\n     */\n    if (\n      !forward && !backward && !leftward && !rightward &&\n      canJump &&\n      joystickDis === 0 &&\n      !isPointMoving &&\n      !gamepadKeys.forward && !gamepadKeys.backward && !gamepadKeys.leftward && !gamepadKeys.rightward\n    ) {\n      // not on a moving object\n      if (!isOnMovingObject) {\n        dragForce.set(\n          -currentVel.x * dragDampingC,\n          0,\n          -currentVel.z * dragDampingC\n        );\n        characterRef.current.applyImpulse(dragForce, false);\n      }\n      // on a moving object\n      else {\n        dragForce.set(\n          (movingObjectVelocity.x - currentVel.x) * dragDampingC,\n          0,\n          (movingObjectVelocity.z - currentVel.z) * dragDampingC\n        );\n        characterRef.current.applyImpulse(dragForce, true);\n      }\n    }\n\n    /**\n     * Detect character falling state\n     */\n    isFalling = (currentVel.y < 0 && !canJump) ? true : false\n\n    /**\n     * Setup max falling speed && extra falling gravity\n     * Remove gravity if falling speed higher than fallingMaxVel (negetive number so use \"<\")\n     */\n    if (characterRef.current) {\n      if (currentVel.y < fallingMaxVel) {\n        if (characterRef.current.gravityScale() !== 0) {\n          characterRef.current.setGravityScale(0, true)\n        }\n      } else {\n        if (!isFalling && characterRef.current.gravityScale() !== initialGravityScale) {\n          // Apply initial gravity after landed\n          characterRef.current.setGravityScale(initialGravityScale, true)\n        } else if (isFalling && characterRef.current.gravityScale() !== fallingGravityScale) {\n          // Apply larger gravity when falling (if initialGravityScale === fallingGravityScale, won't trigger this)\n          characterRef.current.setGravityScale(fallingGravityScale, true)\n        }\n      }\n    }\n\n    /**\n     * Apply auto balance force to the character\n     */\n    if (autoBalance && characterRef.current) autoBalanceCharacter();\n\n    /**\n     * Point to move feature\n     */\n    if (isModePointToMove) {\n      functionKeyDown = (forward || backward || leftward || rightward || joystickDis > 0 || gamepadKeys.forward || gamepadKeys.backward || gamepadKeys.leftward || gamepadKeys.rightward || jump || button1Pressed)\n      pointToMove(delta, slopeAngle, movingObjectVelocity, functionKeyDown)\n    }\n\n    /**\n     * Fixed camera feature\n     */\n    if (isModeFixedCamera) {\n      if (\n        leftward ||\n        gamepadKeys.leftward ||\n        (joystickDis > 0 && joystickAng > 2 * Math.PI / 3 && joystickAng < 4 * Math.PI / 3) ||\n        (gamepadJoystickDis > 0 && gamepadJoystickAng > 2 * Math.PI / 3 && gamepadJoystickAng < 4 * Math.PI / 3)\n      ) {\n        pivot.rotation.y += (run ? delta * sprintMult * fixedCamRotMult : delta * fixedCamRotMult)\n      } else if (\n        rightward ||\n        gamepadKeys.rightward ||\n        (joystickDis > 0 && joystickAng < Math.PI / 3 || joystickAng > 5 * Math.PI / 3) ||\n        (gamepadJoystickDis > 0 && gamepadJoystickAng < Math.PI / 3 || gamepadJoystickAng > 5 * Math.PI / 3)\n      ) {\n        pivot.rotation.y -= (run ? delta * sprintMult * fixedCamRotMult : delta * fixedCamRotMult)\n      }\n    }\n\n    /**\n     * Apply all the animations\n     */\n    if (animated) {\n      if (!forward && !backward && !leftward && !rightward && !jump &&\n        !button1Pressed && joystickDis === 0 &&\n        !isPointMoving &&\n        !gamepadKeys.forward && !gamepadKeys.backward && !gamepadKeys.leftward && !gamepadKeys.rightward &&\n        canJump\n      ) {\n        idleAnimation && idleAnimation();\n      } else if ((jump || button1Pressed) && canJump) {\n        jumpAnimation && jumpAnimation();\n      } else if (canJump &&\n        (\n          forward || backward || leftward || rightward ||\n          joystickDis > 0 ||\n          isPointMoving ||\n          gamepadKeys.forward || gamepadKeys.backward || gamepadKeys.leftward || gamepadKeys.rightward\n        )) {\n        (run || runState) ? runAnimation && runAnimation() : walkAnimation && walkAnimation();\n      } else if (!canJump) {\n        jumpIdleAnimation && jumpIdleAnimation();\n      }\n      // On high sky, play falling animation\n      if (rayHit == null && isFalling) {\n        fallAnimation && fallAnimation();\n      }\n    }\n  });\n\n  return (\n    <RigidBody\n      colliders={false}\n      ref={characterRef}\n      position={props.position || [0, 5, 0]}\n      friction={props.friction || -0.5}\n      onContactForce={(e) => bodyContactForce.set(e.totalForce.x, e.totalForce.y, e.totalForce.z)}\n      onCollisionExit={() => bodyContactForce.set(0, 0, 0)}\n      userData={{ canJump: false }}\n      {...props}\n    >\n      <CapsuleCollider\n        name=\"character-capsule-collider\"\n        args={[capsuleHalfHeight, capsuleRadius]}\n      />\n      {/* Body collide sensor (only for point to move mode) */}\n      {isModePointToMove &&\n        <CylinderCollider\n          ref={bodySensorRef}\n          sensor\n          mass={0}\n          args={[bodySensorSize[0], bodySensorSize[1]]}\n          position={[bodySensorPosition.x, bodySensorPosition.y, bodySensorPosition.z]}\n          onIntersectionEnter={handleOnIntersectionEnter}\n          onIntersectionExit={handleOnIntersectionExit}\n        />}\n      <group ref={characterModelRef} userData={{ camExcludeCollision: true }}>\n        {/* This mesh is used for positioning the slope ray origin */}\n        <mesh\n          position={[\n            rayOriginOffest.x,\n            rayOriginOffest.y,\n            rayOriginOffest.z + slopeRayOriginOffest,\n          ]}\n          ref={slopeRayOriginRef}\n          visible={showSlopeRayOrigin}\n          userData={{ camExcludeCollision: true }} // this won't be collide by camera ray\n        >\n          <boxGeometry args={[0.15, 0.15, 0.15]} />\n        </mesh>\n        {/* Character model */}\n        {children}\n      </group>\n    </RigidBody>\n  );\n}\n\nexport default forwardRef(Ecctrl);\n\ntype CharacterControlsSchema = {\n  maxVelLimit: number;\n  turnVelMultiplier: number;\n  turnSpeed: number;\n  sprintMult: number;\n  jumpVel: number;\n  jumpForceToGroundMult: number;\n  slopJumpMult: number;\n  sprintJumpMult: number;\n  airDragMultiplier: number;\n  dragDampingC: number;\n  accDeltaTime: number;\n  rejectVelMult: number;\n  moveImpulsePointY: number;\n  camFollowMult: number;\n};\n\ntype FloatingRaySchema = {\n  rayOriginOffest: { x: number, y: number, z: number };\n  rayHitForgiveness: number;\n  rayLength: number;\n  rayDir: { x: number, y: number, z: number };\n  floatingDis: number;\n  springK: number;\n  dampingC: number;\n};\n\ntype SlopeRaySchema = {\n  showSlopeRayOrigin: boolean;\n  slopeMaxAngle: number;\n  slopeRayOriginOffest: number;\n  slopeRayLength: number;\n  slopeRayDir: { x: number, y: number, z: number };\n  slopeUpExtraForce: number;\n  slopeDownExtraForce: number;\n};\n\ntype AutoBalanceForceSchema = {\n  autoBalance: boolean;\n  autoBalanceSpringK: number;\n  autoBalanceDampingC: number;\n  autoBalanceSpringOnY: number;\n  autoBalanceDampingOnY: number;\n};\n\nexport type camListenerTargetType = \"document\" | \"domElement\";\n\nexport interface CustomEcctrlRigidBody {\n  group: RapierRigidBody | null;\n  rotateCamera: (x: number, y: number) => void;\n  rotateCharacterOnY: (rad: number) => void;\n}\n\nexport interface EcctrlProps extends RigidBodyProps {\n  children?: ReactNode;\n  debug?: boolean;\n  capsuleHalfHeight?: number;\n  capsuleRadius?: number;\n  floatHeight?: number;\n  characterInitDir?: number;\n  followLight?: boolean;\n  disableControl?: boolean;\n  disableFollowCam?: boolean;\n  disableFollowCamPos?: { x: number, y: number, z: number } | null;\n  disableFollowCamTarget?: { x: number, y: number, z: number } | null;\n  // Follow camera setups\n  camInitDis?: number;\n  camMaxDis?: number;\n  camMinDis?: number;\n  camUpLimit?: number;\n  camLowLimit?: number;\n  camInitDir?: { x: number, y: number };\n  camTargetPos?: { x: number, y: number, z: number };\n  camMoveSpeed?: number;\n  camZoomSpeed?: number;\n  camCollision?: boolean;\n  camCollisionOffset?: number;\n  camCollisionSpeedMult?: number;\n  fixedCamRotMult?: number;\n  camListenerTarget?: camListenerTargetType;\n  // Follow light setups\n  followLightPos?: { x: number, y: number, z: number };\n  // Base control setups\n  maxVelLimit?: number;\n  turnVelMultiplier?: number;\n  turnSpeed?: number;\n  sprintMult?: number;\n  jumpVel?: number;\n  jumpForceToGroundMult?: number;\n  slopJumpMult?: number;\n  sprintJumpMult?: number;\n  airDragMultiplier?: number;\n  dragDampingC?: number;\n  accDeltaTime?: number;\n  rejectVelMult?: number;\n  moveImpulsePointY?: number;\n  camFollowMult?: number;\n  camLerpMult?: number;\n  fallingGravityScale?: number;\n  fallingMaxVel?: number;\n  wakeUpDelay?: number;\n  // Floating Ray setups\n  rayOriginOffest?: { x: number; y: number; z: number };\n  rayHitForgiveness?: number;\n  rayLength?: number;\n  rayDir?: { x: number; y: number; z: number };\n  floatingDis?: number;\n  springK?: number;\n  dampingC?: number;\n  // Slope Ray setups\n  showSlopeRayOrigin?: boolean;\n  slopeMaxAngle?: number;\n  slopeRayOriginOffest?: number;\n  slopeRayLength?: number;\n  slopeRayDir?: { x: number; y: number; z: number };\n  slopeUpExtraForce?: number;\n  slopeDownExtraForce?: number;\n  // Head Ray setups\n  showHeadRayOrigin?: boolean;\n  headRayOriginOffest?: number;\n  headRayLength?: number;\n  headRayDir?: { x: number; y: number; z: number };\n  // AutoBalance Force setups\n  autoBalance?: boolean;\n  autoBalanceSpringK?: number;\n  autoBalanceDampingC?: number;\n  autoBalanceSpringOnY?: number;\n  autoBalanceDampingOnY?: number;\n  // Animation temporary setups\n  animated?: boolean;\n  // Mode setups\n  mode?: string | null;\n  // Controller setups\n  controllerKeys?: { forward?: number, backward?: number, leftward?: number, rightward?: number, jump?: number, action1?: number, action2?: number, action3?: number, action4?: number }\n  // Point-to-move setups\n  bodySensorSize?: Array<number>;\n  bodySensorPosition?: { x: number, y: number, z: number }\n  // Other rigibody props from parent\n  props?: RigidBodyProps;\n};\n\nexport interface userDataType {\n  canJump?: boolean;\n  slopeAngle?: number | null;\n  characterRotated?: boolean;\n  isOnMovingObject?: boolean;\n  excludeEcctrlRay?: boolean;\n}"],"names":["_a","animated","mode","slopeAngle","movingObjectVelocity","functionKeyDown","_b","movingDirection","_c","_d","_e","_f","_g","_h","_j","_i","_k"],"mappings":"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"}}]
}