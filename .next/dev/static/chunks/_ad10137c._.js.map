{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/DaycareEnvironment.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { RigidBody, CuboidCollider } from \"@react-three/rapier\"\n\nexport function DaycareEnvironment() {\n  // Decorative elements (posters) with explicit thin colliders\n  const decorativeElements = useMemo(() => {\n    const elements = []\n\n    for (let i = 0; i < 8; i++) {\n      const angle = (i / 8) * Math.PI * 2\n      const radius = 35\n      const x = Math.cos(angle) * radius\n      const z = Math.sin(angle) * radius\n\n      // Poster is a plane, so we give it a tiny cuboid collider explicitly.\n      elements.push(\n        <RigidBody key={`wall-art-${i}`} type=\"fixed\" colliders={false}>\n          <CuboidCollider\n            // half extents (width/2, height/2, depth/2)\n            args={[1, 0.75, 0.03]}\n            position={[x, 3, z]}\n            rotation={[0, angle + Math.PI, 0]}\n          />\n          <mesh position={[x, 3, z]} rotation={[0, angle + Math.PI, 0]}>\n            <planeGeometry args={[2, 1.5]} />\n            <meshStandardMaterial\n              color={i % 2 === 0 ? \"#FFE5EC\" : \"#D4F1F4\"}\n              roughness={0.5}\n            />\n          </mesh>\n        </RigidBody>\n      )\n    }\n\n    return elements\n  }, [])\n\n  return (\n    <>\n      {/* =========================\n          FLOOR (visual plane + thick collider)\n         ========================= */}\n      <RigidBody type=\"fixed\" colliders={false} friction={1.2} restitution={0.2}>\n        {/* Collider thickness: 0.5 tall (half-height 0.25), top at y=0 */}\n        <CuboidCollider args={[40, 0.25, 40]} position={[0, -0.25, 0]} />\n\n        {/* Visual plane at y=0 */}\n        <mesh receiveShadow position={[0, 0, 0]} rotation={[-Math.PI / 2, 0, 0]}>\n          <planeGeometry args={[80, 80]} />\n          <meshStandardMaterial color=\"#FFF5F7\" roughness={0.8} metalness={0.1} />\n        </mesh>\n      </RigidBody>\n\n      {/* =========================\n          CEILING (optional)\n         ========================= */}\n      <RigidBody type=\"fixed\" colliders={false}>\n        {/* Ceiling collider: thin slab near y=6 */}\n        <CuboidCollider args={[40, 0.15, 40]} position={[0, 6.15, 0]} />\n        <mesh position={[0, 6, 0]} rotation={[Math.PI / 2, 0, 0]}>\n          <planeGeometry args={[80, 80]} />\n          <meshStandardMaterial\n            color=\"#FFFAF0\"\n            side={2}\n            transparent\n            opacity={0.9}\n          />\n        </mesh>\n      </RigidBody>\n\n      {/* =========================\n          WALLS\n         ========================= */}\n      <WallSegment\n        position={[0, 2, -40]}\n        rotation={[0, 0, 0]}\n        width={80}\n        height={4}\n        thickness={0.35}\n        color=\"#E0BBE4\"\n        hasWindows\n      />\n      <WallSegment\n        position={[0, 2, 40]}\n        rotation={[0, Math.PI, 0]}\n        width={80}\n        height={4}\n        thickness={0.35}\n        color=\"#E0BBE4\"\n        hasWindows\n      />\n      <WallSegment\n        position={[-40, 2, 0]}\n        rotation={[0, Math.PI / 2, 0]}\n        width={80}\n        height={4}\n        thickness={0.35}\n        color=\"#FFDFD3\"\n        hasWindows\n      />\n      <WallSegment\n        position={[40, 2, 0]}\n        rotation={[0, -Math.PI / 2, 0]}\n        width={80}\n        height={4}\n        thickness={0.35}\n        color=\"#FFDFD3\"\n        hasWindows\n      />\n\n      {/* Interior walls */}\n      <WallSegment\n        position={[-10, 2, 15]}\n        rotation={[0, 0, 0]}\n        width={20}\n        height={4}\n        thickness={0.35}\n        color=\"#D4F1F4\"\n      />\n      <WallSegment\n        position={[10, 2, -15]}\n        rotation={[0, Math.PI / 2, 0]}\n        width={15}\n        height={4}\n        thickness={0.35}\n        color=\"#FFEAA7\"\n      />\n\n      {/* =========================\n          DECORATIVE RUGS (visual only)\n         ========================= */}\n      <mesh position={[0, 0.01, 0]} rotation={[-Math.PI / 2, 0, 0]}>\n        <circleGeometry args={[8, 32]} />\n        <meshStandardMaterial color=\"#FFE5EC\" roughness={0.9} />\n      </mesh>\n\n      <mesh position={[-15, 0.01, -15]} rotation={[-Math.PI / 2, 0, 0]}>\n        <circleGeometry args={[5, 32]} />\n        <meshStandardMaterial color=\"#E0BBE4\" roughness={0.9} />\n      </mesh>\n\n      <mesh position={[15, 0.01, 15]} rotation={[-Math.PI / 2, 0, 0]}>\n        <circleGeometry args={[5, 32]} />\n        <meshStandardMaterial color=\"#D4F1F4\" roughness={0.9} />\n      </mesh>\n\n      {/* =========================\n          DECORATIVE WALL ART\n         ========================= */}\n      {decorativeElements}\n    </>\n  )\n}\n\ninterface WallSegmentProps {\n  position: [number, number, number]\n  rotation: [number, number, number]\n  width: number\n  height: number\n  thickness?: number\n  color: string\n  hasWindows?: boolean\n}\n\n/**\n * WallSegment: visual wall + explicit cuboid collider.\n * IMPORTANT: collider uses thickness so the player doesn't snag on a paper-thin mesh.\n */\nfunction WallSegment({\n  position,\n  rotation,\n  width,\n  height,\n  thickness = 0.35,\n  color,\n  hasWindows = false,\n}: WallSegmentProps) {\n  return (\n    <RigidBody type=\"fixed\" colliders={false}>\n      {/* Collider centered on the wall segment */}\n      <CuboidCollider\n        args={[width / 2, height / 2, thickness / 2]}\n        position={position}\n        rotation={rotation}\n      />\n\n      {/* Visuals */}\n      <group position={position} rotation={rotation}>\n        <mesh castShadow receiveShadow>\n          <boxGeometry args={[width, height, thickness]} />\n          <meshStandardMaterial color={color} roughness={0.7} metalness={0.2} />\n        </mesh>\n\n        {hasWindows && (\n          <>\n            <mesh position={[0, 0, thickness / 2 + 0.01]}>\n              <planeGeometry args={[width * 0.8, height * 0.6]} />\n              <meshStandardMaterial color=\"#D4F1F4\" transparent opacity={0.7} />\n            </mesh>\n\n            <mesh position={[-width * 0.35, height * 0.2, thickness / 2 + 0.02]}>\n              <boxGeometry args={[0.5, 0.1, 0.03]} />\n              <meshStandardMaterial color=\"#FFE5EC\" />\n            </mesh>\n            <mesh position={[width * 0.35, height * 0.2, thickness / 2 + 0.02]}>\n              <boxGeometry args={[0.5, 0.1, 0.03]} />\n              <meshStandardMaterial color=\"#FFE5EC\" />\n            </mesh>\n          </>\n        )}\n      </group>\n    </RigidBody>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 647, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/stores/gameStore.ts"],"sourcesContent":["import { create } from \"zustand\"\nimport { subscribeWithSelector } from \"zustand/middleware\"\nimport type {\n  Player,\n  Caregiver,\n  Lobby,\n  InteractiveObject,\n  Accident,\n  ChatMessage,\n  Vector3,\n  ClothingState,\n  NeedGauges,\n} from \"@/lib/types/gameTypes\"\n\ninterface GameState {\n  // Lobby state\n  currentLobby: Lobby | null\n  currentPlayerId: string | null\n\n  // Players and NPCs\n  players: Map<string, Player>\n  caregivers: Map<string, Caregiver>\n\n  // Environment\n  objects: Map<string, InteractiveObject>\n  accidents: Map<string, Accident>\n\n  // Chat\n  messages: ChatMessage[]\n\n  // UI state\n  isVoiceActive: boolean\n  selectedPlayerId: string | null\n  showPaywall: boolean\n\n  // Actions\n  setCurrentLobby: (lobby: Lobby) => void\n  setCurrentPlayer: (playerId: string) => void\n  updatePlayer: (playerId: string, updates: Partial<Player>) => void\n  updateCaregiver: (caregiverId: string, updates: Partial<Caregiver>) => void\n  addMessage: (message: ChatMessage) => void\n  addAccident: (accident: Accident) => void\n  cleanAccident: (accidentId: string) => void\n  updateObject: (objectId: string, updates: Partial<InteractiveObject>) => void\n  setVoiceActive: (active: boolean) => void\n  setSelectedPlayer: (playerId: string | null) => void\n  setShowPaywall: (show: boolean) => void\n  updatePlayerPosition: (playerId: string, position: Vector3, rotation: number) => void\n  updatePlayerClothing: (playerId: string, clothing: Partial<ClothingState>) => void\n  updatePlayerNeeds: (playerId: string, needs: Partial<NeedGauges>) => void\n  addCaregiver: (caregiver: Caregiver) => void\n}\n\nexport const useGameStore = create<GameState>()(\n  subscribeWithSelector((set, get) => ({\n    currentLobby: null,\n    currentPlayerId: null,\n    players: new Map(),\n    caregivers: new Map(),\n    objects: new Map(),\n    accidents: new Map(),\n    messages: [],\n    isVoiceActive: false,\n    selectedPlayerId: null,\n    showPaywall: false,\n\n    setCurrentLobby: (lobby) =>\n      set({\n        currentLobby: lobby,\n        players: new Map(lobby.players),\n        caregivers: new Map(lobby.caregivers),\n        objects: new Map(lobby.objects),\n        accidents: new Map(lobby.accidents),\n      }),\n\n    setCurrentPlayer: (playerId) => set({ currentPlayerId: playerId }),\n\n    updatePlayer: (playerId, updates) =>\n      set((state) => {\n        const players = new Map(state.players)\n        const player = players.get(playerId)\n        if (player) {\n          players.set(playerId, { ...player, ...updates })\n        }\n        return player ? { players } : state\n      }),\n\n    updateCaregiver: (caregiverId, updates) =>\n      set((state) => {\n        const caregivers = new Map(state.caregivers)\n        const caregiver = caregivers.get(caregiverId)\n        if (caregiver) {\n          caregivers.set(caregiverId, { ...caregiver, ...updates })\n        }\n        return caregiver ? { caregivers } : state\n      }),\n\n    addMessage: (message) =>\n      set((state) => ({\n        messages: [...state.messages, message].slice(-100), // Keep last 100 messages\n      })),\n\n    addAccident: (accident) =>\n      set((state) => {\n        const accidents = new Map(state.accidents)\n        accidents.set(accident.id, accident)\n        return { accidents }\n      }),\n\n    cleanAccident: (accidentId) =>\n      set((state) => {\n        const accidents = new Map(state.accidents)\n        const accident = accidents.get(accidentId)\n        if (accident) {\n          accidents.set(accidentId, { ...accident, cleanedUp: true })\n        }\n        return { accidents }\n      }),\n\n    updateObject: (objectId, updates) =>\n      set((state) => {\n        const objects = new Map(state.objects)\n        const obj = objects.get(objectId)\n        if (obj) {\n          objects.set(objectId, { ...obj, ...updates })\n        }\n        return { objects }\n      }),\n\n    setVoiceActive: (active) => set({ isVoiceActive: active }),\n\n    setSelectedPlayer: (playerId) => set({ selectedPlayerId: playerId }),\n\n    setShowPaywall: (show) => set({ showPaywall: show }),\n\n    updatePlayerPosition: (playerId, position, rotation) =>\n      set((state) => {\n        const players = new Map(state.players)\n        const player = players.get(playerId)\n        if (player) {\n          if (\n            player.position.x === position.x &&\n            player.position.y === position.y &&\n            player.position.z === position.z &&\n            player.rotation === rotation\n          ) {\n            return state\n          }\n          players.set(playerId, { ...player, position, rotation })\n        }\n        return player ? { players } : state\n      }),\n\n    updatePlayerClothing: (playerId, clothing) =>\n      set((state) => {\n        const players = new Map(state.players)\n        const player = players.get(playerId)\n        if (player) {\n          players.set(playerId, {\n            ...player,\n            clothing: { ...player.clothing, ...clothing },\n          })\n        }\n        return player ? { players } : state\n      }),\n\n    updatePlayerNeeds: (playerId, needs) =>\n      set((state) => {\n        const players = new Map(state.players)\n        const player = players.get(playerId)\n        if (player) {\n          players.set(playerId, {\n            ...player,\n            needs: { ...player.needs, ...needs },\n          })\n        }\n        return player ? { players } : state\n      }),\n\n    addCaregiver: (caregiver) =>\n      set((state) => {\n        const caregivers = new Map(state.caregivers)\n        caregivers.set(caregiver.id, caregiver)\n        return { caregivers }\n      }),\n  })),\n)\n\nexport const selectPlayerById = (state: GameState, playerId: string) => state.players.get(playerId)\n\nexport const selectAllPlayers = (state: GameState) => state.players\n\nexport const selectCaregiverById = (state: GameState, caregiverId: string) => state.caregivers.get(caregiverId)\n\nexport const selectAllCaregivers = (state: GameState) => state.caregivers\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAoDO,MAAM,eAAe,IAAA,qJAAM,IAChC,IAAA,yKAAqB,EAAC,CAAC,KAAK,MAAQ,CAAC;QACnC,cAAc;QACd,iBAAiB;QACjB,SAAS,IAAI;QACb,YAAY,IAAI;QAChB,SAAS,IAAI;QACb,WAAW,IAAI;QACf,UAAU,EAAE;QACZ,eAAe;QACf,kBAAkB;QAClB,aAAa;QAEb,iBAAiB,CAAC,QAChB,IAAI;gBACF,cAAc;gBACd,SAAS,IAAI,IAAI,MAAM,OAAO;gBAC9B,YAAY,IAAI,IAAI,MAAM,UAAU;gBACpC,SAAS,IAAI,IAAI,MAAM,OAAO;gBAC9B,WAAW,IAAI,IAAI,MAAM,SAAS;YACpC;QAEF,kBAAkB,CAAC,WAAa,IAAI;gBAAE,iBAAiB;YAAS;QAEhE,cAAc,CAAC,UAAU,UACvB,IAAI,CAAC;gBACH,MAAM,UAAU,IAAI,IAAI,MAAM,OAAO;gBACrC,MAAM,SAAS,QAAQ,GAAG,CAAC;gBAC3B,IAAI,QAAQ;oBACV,QAAQ,GAAG,CAAC,UAAU;wBAAE,GAAG,MAAM;wBAAE,GAAG,OAAO;oBAAC;gBAChD;gBACA,OAAO,SAAS;oBAAE;gBAAQ,IAAI;YAChC;QAEF,iBAAiB,CAAC,aAAa,UAC7B,IAAI,CAAC;gBACH,MAAM,aAAa,IAAI,IAAI,MAAM,UAAU;gBAC3C,MAAM,YAAY,WAAW,GAAG,CAAC;gBACjC,IAAI,WAAW;oBACb,WAAW,GAAG,CAAC,aAAa;wBAAE,GAAG,SAAS;wBAAE,GAAG,OAAO;oBAAC;gBACzD;gBACA,OAAO,YAAY;oBAAE;gBAAW,IAAI;YACtC;QAEF,YAAY,CAAC,UACX,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;2BAAI,MAAM,QAAQ;wBAAE;qBAAQ,CAAC,KAAK,CAAC,CAAC;gBAChD,CAAC;QAEH,aAAa,CAAC,WACZ,IAAI,CAAC;gBACH,MAAM,YAAY,IAAI,IAAI,MAAM,SAAS;gBACzC,UAAU,GAAG,CAAC,SAAS,EAAE,EAAE;gBAC3B,OAAO;oBAAE;gBAAU;YACrB;QAEF,eAAe,CAAC,aACd,IAAI,CAAC;gBACH,MAAM,YAAY,IAAI,IAAI,MAAM,SAAS;gBACzC,MAAM,WAAW,UAAU,GAAG,CAAC;gBAC/B,IAAI,UAAU;oBACZ,UAAU,GAAG,CAAC,YAAY;wBAAE,GAAG,QAAQ;wBAAE,WAAW;oBAAK;gBAC3D;gBACA,OAAO;oBAAE;gBAAU;YACrB;QAEF,cAAc,CAAC,UAAU,UACvB,IAAI,CAAC;gBACH,MAAM,UAAU,IAAI,IAAI,MAAM,OAAO;gBACrC,MAAM,MAAM,QAAQ,GAAG,CAAC;gBACxB,IAAI,KAAK;oBACP,QAAQ,GAAG,CAAC,UAAU;wBAAE,GAAG,GAAG;wBAAE,GAAG,OAAO;oBAAC;gBAC7C;gBACA,OAAO;oBAAE;gBAAQ;YACnB;QAEF,gBAAgB,CAAC,SAAW,IAAI;gBAAE,eAAe;YAAO;QAExD,mBAAmB,CAAC,WAAa,IAAI;gBAAE,kBAAkB;YAAS;QAElE,gBAAgB,CAAC,OAAS,IAAI;gBAAE,aAAa;YAAK;QAElD,sBAAsB,CAAC,UAAU,UAAU,WACzC,IAAI,CAAC;gBACH,MAAM,UAAU,IAAI,IAAI,MAAM,OAAO;gBACrC,MAAM,SAAS,QAAQ,GAAG,CAAC;gBAC3B,IAAI,QAAQ;oBACV,IACE,OAAO,QAAQ,CAAC,CAAC,KAAK,SAAS,CAAC,IAChC,OAAO,QAAQ,CAAC,CAAC,KAAK,SAAS,CAAC,IAChC,OAAO,QAAQ,CAAC,CAAC,KAAK,SAAS,CAAC,IAChC,OAAO,QAAQ,KAAK,UACpB;wBACA,OAAO;oBACT;oBACA,QAAQ,GAAG,CAAC,UAAU;wBAAE,GAAG,MAAM;wBAAE;wBAAU;oBAAS;gBACxD;gBACA,OAAO,SAAS;oBAAE;gBAAQ,IAAI;YAChC;QAEF,sBAAsB,CAAC,UAAU,WAC/B,IAAI,CAAC;gBACH,MAAM,UAAU,IAAI,IAAI,MAAM,OAAO;gBACrC,MAAM,SAAS,QAAQ,GAAG,CAAC;gBAC3B,IAAI,QAAQ;oBACV,QAAQ,GAAG,CAAC,UAAU;wBACpB,GAAG,MAAM;wBACT,UAAU;4BAAE,GAAG,OAAO,QAAQ;4BAAE,GAAG,QAAQ;wBAAC;oBAC9C;gBACF;gBACA,OAAO,SAAS;oBAAE;gBAAQ,IAAI;YAChC;QAEF,mBAAmB,CAAC,UAAU,QAC5B,IAAI,CAAC;gBACH,MAAM,UAAU,IAAI,IAAI,MAAM,OAAO;gBACrC,MAAM,SAAS,QAAQ,GAAG,CAAC;gBAC3B,IAAI,QAAQ;oBACV,QAAQ,GAAG,CAAC,UAAU;wBACpB,GAAG,MAAM;wBACT,OAAO;4BAAE,GAAG,OAAO,KAAK;4BAAE,GAAG,KAAK;wBAAC;oBACrC;gBACF;gBACA,OAAO,SAAS;oBAAE;gBAAQ,IAAI;YAChC;QAEF,cAAc,CAAC,YACb,IAAI,CAAC;gBACH,MAAM,aAAa,IAAI,IAAI,MAAM,UAAU;gBAC3C,WAAW,GAAG,CAAC,UAAU,EAAE,EAAE;gBAC7B,OAAO;oBAAE;gBAAW;YACtB;IACJ,CAAC;AAGI,MAAM,mBAAmB,CAAC,OAAkB,WAAqB,MAAM,OAAO,CAAC,GAAG,CAAC;AAEnF,MAAM,mBAAmB,CAAC,QAAqB,MAAM,OAAO;AAE5D,MAAM,sBAAsB,CAAC,OAAkB,cAAwB,MAAM,UAAU,CAAC,GAAG,CAAC;AAE5F,MAAM,sBAAsB,CAAC,QAAqB,MAAM,UAAU"}},
    {"offset": {"line": 826, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/DaycareObjects.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { RigidBody } from \"@react-three/rapier\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport type { InteractiveObject } from \"@/lib/types/gameTypes\"\n\nexport function DaycareObjects() {\n  const objectsMap = useGameStore((state) => state.objects)\n  const objects = useMemo(() => Array.from(objectsMap.values()), [objectsMap])\n\n  return (\n    <>\n      {objects.map((obj) => (\n        <InteractiveObjectMesh key={obj.id} object={obj} />\n      ))}\n\n      {/* Default objects if none loaded */}\n      {objects.length === 0 && <DefaultDaycareObjects />}\n    </>\n  )\n}\n\nfunction InteractiveObjectMesh({ object }: { object: InteractiveObject }) {\n  const updateObject = useGameStore((state) => state.updateObject)\n\n  const handleClick = () => {\n    console.log(\"[v0] Object clicked:\", object.id, object.type)\n    // Handle object interaction\n  }\n\n  return (\n    <RigidBody\n      type=\"fixed\"\n      colliders=\"cuboid\"\n      position={[object.position.x, object.position.y, object.position.z]}\n      rotation={[0, object.rotation, 0]}\n    >\n      <ObjectByType type={object.type} isOccupied={object.isOccupied} onClick={handleClick} />\n    </RigidBody>\n  )\n}\n\nfunction ObjectByType({\n  type,\n  isOccupied,\n  onClick,\n}: {\n  type: InteractiveObject[\"type\"]\n  isOccupied: boolean\n  onClick: () => void\n}) {\n  const occupiedColor = isOccupied ? \"#FFA5A5\" : \"#B5EAD7\"\n\n  switch (type) {\n    case \"changing_station\":\n      return <ChangingStation color={occupiedColor} onClick={onClick} />\n\n    case \"timeout_chair\":\n      return <TimeoutChair color={occupiedColor} onClick={onClick} />\n\n    case \"timeout_stool\":\n      return <TimeoutStool color={occupiedColor} onClick={onClick} />\n\n    case \"slide\":\n      return <Slide color={occupiedColor} onClick={onClick} />\n\n    case \"play_area\":\n      return <PlayArea color={occupiedColor} onClick={onClick} />\n\n    case \"potty\":\n      return <Potty color={occupiedColor} onClick={onClick} />\n\n    case \"toilet_female\":\n    case \"toilet_male\":\n      return <Toilet color={occupiedColor} onClick={onClick} />\n\n    case \"toy_box\":\n      return <ToyBox color={occupiedColor} onClick={onClick} />\n\n    case \"music_system\":\n      return <MusicSystem color={occupiedColor} onClick={onClick} />\n\n    default:\n      return <DefaultObject color={occupiedColor} onClick={onClick} />\n  }\n}\n\nfunction ChangingStation({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Table/platform */}\n      <mesh position={[0, 0.75, 0]} castShadow receiveShadow>\n        <boxGeometry args={[2, 0.2, 1.5]} />\n        <meshStandardMaterial color={color} roughness={0.6} />\n      </mesh>\n      {/* Legs */}\n      <mesh position={[-0.8, 0.35, -0.6]} castShadow>\n        <cylinderGeometry args={[0.05, 0.05, 0.7]} />\n        <meshStandardMaterial color=\"#C7CEEA\" />\n      </mesh>\n      <mesh position={[0.8, 0.35, -0.6]} castShadow>\n        <cylinderGeometry args={[0.05, 0.05, 0.7]} />\n        <meshStandardMaterial color=\"#C7CEEA\" />\n      </mesh>\n      <mesh position={[-0.8, 0.35, 0.6]} castShadow>\n        <cylinderGeometry args={[0.05, 0.05, 0.7]} />\n        <meshStandardMaterial color=\"#C7CEEA\" />\n      </mesh>\n      <mesh position={[0.8, 0.35, 0.6]} castShadow>\n        <cylinderGeometry args={[0.05, 0.05, 0.7]} />\n        <meshStandardMaterial color=\"#C7CEEA\" />\n      </mesh>\n      {/* Cushion/pad */}\n      <mesh position={[0, 0.95, 0]}>\n        <boxGeometry args={[1.8, 0.3, 1.3]} />\n        <meshStandardMaterial color=\"#FFE5EC\" roughness={0.9} />\n      </mesh>\n    </group>\n  )\n}\n\nfunction TimeoutChair({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Seat */}\n      <mesh position={[0, 0.4, 0]} castShadow receiveShadow>\n        <boxGeometry args={[0.6, 0.1, 0.6]} />\n        <meshStandardMaterial color={color} roughness={0.6} />\n      </mesh>\n      {/* Back */}\n      <mesh position={[0, 0.8, -0.25]} castShadow>\n        <boxGeometry args={[0.6, 0.7, 0.1]} />\n        <meshStandardMaterial color={color} roughness={0.6} />\n      </mesh>\n      {/* Legs */}\n      {[\n        [-0.25, 0.2, -0.25],\n        [0.25, 0.2, -0.25],\n        [-0.25, 0.2, 0.25],\n        [0.25, 0.2, 0.25],\n      ].map((pos, i) => (\n        <mesh key={i} position={pos as [number, number, number]} castShadow>\n          <cylinderGeometry args={[0.03, 0.03, 0.4]} />\n          <meshStandardMaterial color=\"#E0BBE4\" />\n        </mesh>\n      ))}\n    </group>\n  )\n}\n\nfunction TimeoutStool({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Seat */}\n      <mesh position={[0, 0.3, 0]} castShadow receiveShadow>\n        <cylinderGeometry args={[0.3, 0.3, 0.1]} />\n        <meshStandardMaterial color={color} roughness={0.6} />\n      </mesh>\n      {/* Legs */}\n      {[\n        [-0.2, 0.125, -0.2],\n        [0.2, 0.125, -0.2],\n        [-0.2, 0.125, 0.2],\n        [0.2, 0.125, 0.2],\n      ].map((pos, i) => (\n        <mesh key={i} position={pos as [number, number, number]} castShadow>\n          <cylinderGeometry args={[0.025, 0.025, 0.25]} />\n          <meshStandardMaterial color=\"#FFDFD3\" />\n        </mesh>\n      ))}\n    </group>\n  )\n}\n\nfunction Slide({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Slide surface */}\n      <mesh position={[0, 1, 0]} rotation={[-Math.PI / 6, 0, 0]} castShadow receiveShadow>\n        <boxGeometry args={[1.2, 0.1, 3]} />\n        <meshStandardMaterial color={color} roughness={0.3} metalness={0.4} />\n      </mesh>\n      {/* Side rails */}\n      <mesh position={[-0.55, 1.2, 0]} rotation={[-Math.PI / 6, 0, 0]} castShadow>\n        <boxGeometry args={[0.1, 0.3, 3]} />\n        <meshStandardMaterial color=\"#D4F1F4\" />\n      </mesh>\n      <mesh position={[0.55, 1.2, 0]} rotation={[-Math.PI / 6, 0, 0]} castShadow>\n        <boxGeometry args={[0.1, 0.3, 3]} />\n        <meshStandardMaterial color=\"#D4F1F4\" />\n      </mesh>\n      {/* Platform */}\n      <mesh position={[0, 2, -1.2]} castShadow>\n        <boxGeometry args={[1.2, 0.2, 0.8]} />\n        <meshStandardMaterial color=\"#FFEAA7\" />\n      </mesh>\n      {/* Support structure */}\n      <mesh position={[0, 1, -1.2]} castShadow>\n        <cylinderGeometry args={[0.1, 0.1, 2]} />\n        <meshStandardMaterial color=\"#E0BBE4\" />\n      </mesh>\n    </group>\n  )\n}\n\nfunction PlayArea({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Play mat */}\n      <mesh position={[0, 0.05, 0]} rotation={[-Math.PI / 2, 0, 0]}>\n        <circleGeometry args={[2, 32]} />\n        <meshStandardMaterial color={color} roughness={0.9} />\n      </mesh>\n      {/* Toys scattered around */}\n      <mesh position={[-0.5, 0.2, 0.5]} castShadow>\n        <boxGeometry args={[0.3, 0.3, 0.3]} />\n        <meshStandardMaterial color=\"#FFE5EC\" />\n      </mesh>\n      <mesh position={[0.6, 0.15, -0.4]} castShadow>\n        <sphereGeometry args={[0.15]} />\n        <meshStandardMaterial color=\"#D4F1F4\" />\n      </mesh>\n      <mesh position={[0, 0.25, 0]} castShadow>\n        <cylinderGeometry args={[0.2, 0.2, 0.5]} />\n        <meshStandardMaterial color=\"#FFDFD3\" />\n      </mesh>\n    </group>\n  )\n}\n\nfunction Potty({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Base */}\n      <mesh position={[0, 0.15, 0]} castShadow receiveShadow>\n        <cylinderGeometry args={[0.25, 0.3, 0.3]} />\n        <meshStandardMaterial color={color} roughness={0.4} />\n      </mesh>\n      {/* Bowl */}\n      <mesh position={[0, 0.35, 0]} castShadow>\n        <cylinderGeometry args={[0.22, 0.18, 0.15]} />\n        <meshStandardMaterial color=\"#FFFFFF\" roughness={0.2} metalness={0.3} />\n      </mesh>\n      {/* Back support */}\n      <mesh position={[0, 0.5, -0.2]} castShadow>\n        <boxGeometry args={[0.4, 0.3, 0.1]} />\n        <meshStandardMaterial color={color} roughness={0.6} />\n      </mesh>\n    </group>\n  )\n}\n\nfunction Toilet({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Base */}\n      <mesh position={[0, 0.2, 0]} castShadow receiveShadow>\n        <boxGeometry args={[0.5, 0.4, 0.6]} />\n        <meshStandardMaterial color=\"#FFFFFF\" roughness={0.2} metalness={0.3} />\n      </mesh>\n      {/* Bowl */}\n      <mesh position={[0, 0.45, 0]} castShadow>\n        <cylinderGeometry args={[0.2, 0.2, 0.1]} />\n        <meshStandardMaterial color=\"#FFFFFF\" roughness={0.2} metalness={0.3} />\n      </mesh>\n      {/* Tank */}\n      <mesh position={[0, 0.7, -0.2]} castShadow>\n        <boxGeometry args={[0.45, 0.5, 0.2]} />\n        <meshStandardMaterial color=\"#FFFFFF\" roughness={0.2} metalness={0.3} />\n      </mesh>\n      {/* Seat */}\n      <mesh position={[0, 0.5, 0]} rotation={[-Math.PI / 2, 0, 0]}>\n        <ringGeometry args={[0.15, 0.25, 32]} />\n        <meshStandardMaterial color={color} roughness={0.4} side={2} />\n      </mesh>\n    </group>\n  )\n}\n\nfunction ToyBox({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Box body */}\n      <mesh position={[0, 0.4, 0]} castShadow receiveShadow>\n        <boxGeometry args={[1.2, 0.8, 0.8]} />\n        <meshStandardMaterial color={color} roughness={0.7} />\n      </mesh>\n      {/* Lid */}\n      <mesh position={[0, 0.85, 0]} castShadow>\n        <boxGeometry args={[1.25, 0.1, 0.85]} />\n        <meshStandardMaterial color=\"#E0BBE4\" roughness={0.7} />\n      </mesh>\n      {/* Toys peeking out */}\n      <mesh position={[-0.3, 0.9, 0]} castShadow>\n        <sphereGeometry args={[0.1]} />\n        <meshStandardMaterial color=\"#FFE5EC\" />\n      </mesh>\n      <mesh position={[0.2, 0.95, 0.1]} castShadow>\n        <boxGeometry args={[0.15, 0.15, 0.15]} />\n        <meshStandardMaterial color=\"#D4F1F4\" />\n      </mesh>\n    </group>\n  )\n}\n\nfunction MusicSystem({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <group onClick={onClick}>\n      {/* Base unit */}\n      <mesh position={[0, 0.5, 0]} castShadow receiveShadow>\n        <boxGeometry args={[0.8, 0.6, 0.4]} />\n        <meshStandardMaterial color={color} roughness={0.5} metalness={0.5} />\n      </mesh>\n      {/* Display/screen */}\n      <mesh position={[0, 0.55, 0.21]}>\n        <planeGeometry args={[0.6, 0.3]} />\n        <meshStandardMaterial color=\"#87CEEB\" emissive=\"#87CEEB\" emissiveIntensity={0.5} />\n      </mesh>\n      {/* Buttons */}\n      {[-0.2, 0, 0.2].map((x, i) => (\n        <mesh key={i} position={[x, 0.25, 0.21]} castShadow>\n          <cylinderGeometry args={[0.05, 0.05, 0.05]} />\n          <meshStandardMaterial color=\"#FFE5EC\" />\n        </mesh>\n      ))}\n    </group>\n  )\n}\n\nfunction DefaultObject({ color, onClick }: { color: string; onClick: () => void }) {\n  return (\n    <mesh onClick={onClick} castShadow receiveShadow>\n      <boxGeometry args={[1, 1, 1]} />\n      <meshStandardMaterial color={color} roughness={0.6} />\n    </mesh>\n  )\n}\n\nfunction DefaultDaycareObjects() {\n  return (\n    <>\n      {/* Changing station */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[-15, 0, 10]}>\n        <ChangingStation color=\"#B5EAD7\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Timeout chairs */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[15, 0, -15]}>\n        <TimeoutChair color=\"#B5EAD7\" onClick={() => {}} />\n      </RigidBody>\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[17, 0, -15]}>\n        <TimeoutChair color=\"#B5EAD7\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Slide */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[-20, 0, -10]}>\n        <Slide color=\"#FFB7B2\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Play areas */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[0, 0, 0]}>\n        <PlayArea color=\"#D4F1F4\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Potties */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[-5, 0, 15]}>\n        <Potty color=\"#FFEAA7\" onClick={() => {}} />\n      </RigidBody>\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[-3, 0, 15]}>\n        <Potty color=\"#FFEAA7\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Toilets */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[18, 0, 18]}>\n        <Toilet color=\"#E0BBE4\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Toy boxes */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[-10, 0, -5]}>\n        <ToyBox color=\"#FFDFD3\" onClick={() => {}} />\n      </RigidBody>\n\n      {/* Music system */}\n      <RigidBody type=\"fixed\" colliders=\"cuboid\" position={[10, 0, 10]}>\n        <MusicSystem color=\"#C7CEEA\" onClick={() => {}} />\n      </RigidBody>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2568, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/types/gameTypes.ts"],"sourcesContent":["import { z } from \"zod\"\n\nexport type PlayerRole = \"caregiver\" | \"little\"\nexport type Gender = \"male\" | \"female\"\nexport type AgeGroup = \"1-4\" | \"4-7\" | \"7-9\" | \"12+\"\nexport type DisciplineStatus = \"green\" | \"yellow\" | \"red\"\nexport type UnderwearType = \"diaper\" | \"training_pants\" | \"underwear\"\nexport type UnderwearState = \"clean\" | \"wet\" | \"messy\" | \"both\"\nexport type AdminRole = \"owner\" | \"admin\" | \"mod\" | \"none\"\nexport type SpankingImplement = \"hand\" | \"paddle\" | \"belt\"\nexport type BehaviorSeverity = 1 | 2 | 3 | 4 | 5\nexport type AuthorityActionType =\n  | \"escort\"\n  | \"physical_control\"\n  | \"relocation\"\n  | \"cooldown\"\n  | \"mouth_soaping\"\n  | \"disciplinary_action\"\n  | \"spanking_otk\"\nexport type Alignment = \"little_angel\" | \"good_boy_girl\" | \"boy_girl\" | \"bad_boy_girl\" | \"little_shit\"\nexport type VoiceEmotion = \"neutral\" | \"caring\" | \"firm\" | \"playful\" | \"stern\"\nexport type VoiceProvider = \"inworld\" | \"eastworld\" | \"bark\" | \"elevenlabs\"\nexport type VoiceRecognitionProvider = \"elevenlabs\" | \"openai\" | \"whisper\"\nexport type VoiceSynthesisProvider = \"elevenlabs\" | \"bark\" | \"inworld\"\nexport type PunishmentType = \"timeout\" | \"spanking\" | \"warning\" | \"mouth_soap\" | \"privilege_loss\"\nexport type MessageType = \"chat\" | \"whisper\" | \"announcement\" | \"punishment\" | \"reward\"\nexport type EntityType = \"player\" | \"npc\" | \"object\" | \"accident\"\nexport type SoundEventType = \"voice\" | \"cry\" | \"music\" | \"ambient\"\nexport type ControlIntensity = \"light\" | \"firm\"\nexport type ControlPoint = \"arm\" | \"shoulder\" | \"upper_back\"\nexport type RestrictedCapability = \"movement\" | \"interaction\" | \"voice\"\nexport type DisciplinaryEffect = \"morale_penalty\" | \"privilege_loss\" | \"reputation_change\"\nexport type BehaviorCategory = \"safety\" | \"rule_violation\" | \"disruption\"\nexport type ConstraintType = \"time\" | \"cooldown\" | \"energy\" | \"authority\"\nexport type Rotation = number\n\nexport interface Vector3 {\n  x: number\n  y: number\n  z: number\n}\n\n// AI Perception and World State Interfaces\nexport interface EntityRef {\n  id: string\n  type: EntityType\n  position: Vector3\n}\n\nexport interface SoundEvent {\n  id: string\n  type: SoundEventType\n  source: string\n  position: Vector3\n  intensity: number\n  timestamp: number\n}\n\nexport interface Perception {\n  visibleEntities: EntityRef[]\n  distances: Map<string, number>\n  occluded: boolean\n  audioEvents: SoundEvent[]\n}\n\nexport interface WorldState {\n  navmesh: any // Simplified navmesh data\n  hazards: string[]\n  interactables: Map<string, InteractiveObject>\n}\n\nexport interface Intent {\n  goals: Goal[]\n  constraints: Constraint[]\n  cooldowns: Map<string, number>\n}\n\nexport interface Goal {\n  id: string\n  priority: number\n  description: string\n  targetId?: string\n  location?: Vector3\n}\n\nexport interface Constraint {\n  type: ConstraintType\n  value: number\n  description: string\n}\n\n// Voice System Interfaces\nexport interface VoiceProfile {\n  provider: VoiceProvider\n  voiceId: string\n  pitch: number\n  speed: number\n  emotion: VoiceEmotion\n  recognitionProvider: VoiceRecognitionProvider\n  synthesisProvider: VoiceSynthesisProvider\n}\n\nexport interface VoiceRecognitionResult {\n  text: string\n  confidence: number\n  language: string\n  duration: number\n}\n\nexport interface VoiceSynthesisOptions {\n  voiceId: string\n  stability?: number\n  similarityBoost?: number\n  style?: number\n  useSpeakerBoost?: boolean\n}\n\nexport interface VoiceService {\n  // Speech Recognition (STT)\n  recognizeSpeech(audioData: ArrayBuffer): Promise<VoiceRecognitionResult>\n  startContinuousRecognition(): Promise<void>\n  stopContinuousRecognition(): Promise<string>\n\n  // Speech Synthesis (TTS)\n  synthesizeSpeech(text: string, options: VoiceSynthesisOptions): Promise<ArrayBuffer>\n\n  // Voice Management\n  getAvailableVoices(): Promise<VoiceProfile[]>\n  createVoiceProfile(voiceId: string): Promise<VoiceProfile>\n\n  // Audio Processing\n  processAudioInput(stream: MediaStream): Promise<void>\n  setAudioLevelCallback(callback: (level: number) => void): void\n\n  // Configuration\n  setRecognitionLanguage(language: string): void\n  setSynthesisLanguage(language: string): void\n  setVoiceProfile(profile: VoiceProfile): void\n}\n\n// Behavior and Authority System Interfaces\nexport interface BehaviorEvent {\n  id: string\n  actorId: string\n  category: BehaviorCategory\n  severity: BehaviorSeverity\n  timestamp: number\n  description: string\n  evidence?: string[]\n}\n\nexport interface PhysicalControlAction {\n  type: \"physical_control\"\n  authorityId: string\n  targetId: string\n  controlPoint: ControlPoint\n  intensity: ControlIntensity\n  durationMs: number\n}\n\nexport interface EscortAction {\n  type: \"escort\"\n  authorityId: string\n  targetId: string\n  destinationId: string\n  canResist: boolean\n  reason: string\n}\n\nexport interface CooldownAction {\n  type: \"cooldown\"\n  targetId: string\n  durationMs: number // hard-cap enforced (e.g. 5 min)\n  restrictedCapabilities: RestrictedCapability[]\n  reason: string\n}\n\nexport interface DisciplinaryAction {\n  type: \"disciplinary_action\"\n  targetId: string\n  effect: DisciplinaryEffect\n  magnitude: number\n  reason: string\n}\n\nexport type AuthorityIntervention = PhysicalControlAction | EscortAction | CooldownAction | DisciplinaryAction\n\nexport interface AuthorityDecision {\n  authorityId: string\n  targetId: string\n  triggeringEventId: string\n  confidence: number\n  interventions: AuthorityIntervention[]\n  reasoning: string\n}\n\nexport interface CharacterCustomization {\n  skinColor: string\n  ageGroup: AgeGroup\n  hairColor?: string\n  eyeColor?: string\n  facialFeatures?: string[]\n}\n\nexport interface ClothingState {\n  shirt: boolean\n  pants: boolean\n  socks: boolean\n  shoes: boolean\n  underwearType: UnderwearType\n  underwearState: UnderwearState\n  diaperFillLevel: number\n  pacifierIn: boolean\n}\n\nexport interface NeedGauges {\n  bladder: number\n  bowel: number\n  hunger: number\n}\n\nexport interface Player {\n  id: string\n  name: string\n  role: PlayerRole\n  gender: Gender\n  adminRole: AdminRole\n  character: CharacterCustomization\n  clothing: ClothingState\n  needs: NeedGauges\n  position: Vector3\n  rotation: Rotation\n  disciplineStatus: DisciplineStatus\n  alignment: Alignment\n  isInTimeout: boolean\n  timeoutEndTime?: number\n  isBeingLed: boolean\n  ledBy?: string\n  currentAnimation: string\n  privileges: string[]\n  rewards: Reward[]\n  punishments: Punishment[]\n  voiceId?: string\n  lastVoiceActivity?: number\n}\n\nexport interface CaregiverPersonality {\n  strictness: number // 0-100\n  nurturing: number // 0-100\n  patience: number // 0-100\n  fairness: number // 0-100\n  responsiveness: number // 0-100\n}\n\nexport interface Caregiver extends Player {\n  role: \"caregiver\"\n  personality: CaregiverPersonality\n  perception: Perception\n  worldState: WorldState\n  currentIntent: Intent\n  voiceProfile: VoiceProfile\n  isAI: boolean\n  lastDecisionTime?: number\n}\n\nexport interface Reward {\n  id: string\n  name: string\n  description: string\n  givenBy: string\n  timestamp: number\n  alignmentBonus: number\n}\n\nexport interface Punishment {\n  id: string\n  type: PunishmentType\n  reason: string\n  givenBy: string\n  timestamp: number\n  duration?: number\n  implement?: SpankingImplement\n  alignmentPenalty: number\n}\n\nexport interface LobbySettings {\n  name: string\n  maxPlayers: number\n  staffOnlyRoleChanges: boolean\n  staffOnlyGenderChanges: boolean\n  isPrivate: boolean\n  monetizationEnabled: boolean\n  trialDays: number\n}\n\nexport interface Lobby {\n  id: string\n  inviteCode: string\n  settings: LobbySettings\n  ownerId: string\n  players: Map<string, Player>\n  caregivers: Map<string, Caregiver>\n  objects: Map<string, InteractiveObject>\n  accidents: Map<string, Accident>\n  createdAt: number\n  trialEndDate?: number\n  isSuspended: boolean\n}\n\nexport interface ChatMessage {\n  id: string\n  senderId: string\n  senderName: string\n  content: string\n  timestamp: number\n  isSystem: boolean\n  messageType: MessageType\n  alignmentChange?: number\n}\n\nexport interface Accident {\n  id: string\n  type: \"pee\" | \"poop\"\n  position: Vector3\n  playerId: string\n  timestamp: number\n  cleanedUp: boolean\n  size: number // 0-100%\n  cause?: string\n}\n\nexport interface InteractiveObject {\n  id: string\n  type:\n    | \"slide\"\n    | \"changing_station\"\n    | \"timeout_chair\"\n    | \"timeout_stool\"\n    | \"play_area\"\n    | \"potty\"\n    | \"toilet_male\"\n    | \"toilet_female\"\n    | \"toy_box\"\n    | \"music_system\"\n  position: Vector3\n  rotation: Rotation\n  isOccupied: boolean\n  occupiedBy?: string\n  isLocked: boolean\n  requiredPrivilege?: string\n  interactionRadius: number\n}\n\nexport type ClientMessage =\n  | { type: \"join_lobby\"; lobbyId: string; player: Omit<Player, \"id\"> }\n  | { type: \"create_lobby\"; settings: LobbySettings; player: Omit<Player, \"id\"> }\n  | { type: \"leave_lobby\" }\n  | { type: \"move\"; position: Vector3; rotation: Rotation }\n  | { type: \"animation\"; animation: string }\n  | { type: \"chat\"; content: string; messageType?: \"chat\" | \"whisper\" }\n  | { type: \"voice_message\"; audioData: ArrayBuffer }\n  | { type: \"update_role\"; targetId: string; role: PlayerRole }\n  | { type: \"update_gender\"; targetId: string; gender: Gender }\n  | { type: \"update_admin_role\"; targetId: string; adminRole: AdminRole }\n  | { type: \"update_settings\"; settings: Partial<LobbySettings> }\n  | { type: \"discipline\"; targetId: string; status: DisciplineStatus }\n  | { type: \"give_reward\"; targetId: string; reward: Omit<Reward, \"id\" | \"givenBy\" | \"timestamp\"> }\n  | { type: \"give_punishment\"; targetId: string; punishment: Omit<Punishment, \"id\" | \"givenBy\" | \"timestamp\"> }\n  | { type: \"start_leading\"; targetId: string }\n  | { type: \"stop_leading\" }\n  | { type: \"interact_object\"; objectId: string; action: string }\n  | { type: \"change_clothing\"; clothing: Partial<ClothingState> }\n  | { type: \"use_potty\" }\n  | { type: \"eat_food\"; foodType: string }\n  | { type: \"drink\"; liquidType: string }\n  | { type: \"change_diaper\"; targetId: string; newType: UnderwearType }\n  | { type: \"clean_accident\"; accidentId: string }\n  | { type: \"ai_caregiver_command\"; caregiverId: string; command: string }\n\nexport type ServerMessage =\n  | { type: \"lobby_joined\"; lobby: SerializedLobby; playerId: string }\n  | { type: \"lobby_created\"; lobby: SerializedLobby; playerId: string; inviteCode: string }\n  | { type: \"player_joined\"; player: Player }\n  | { type: \"player_left\"; playerId: string }\n  | { type: \"player_moved\"; playerId: string; position: Vector3; rotation: Rotation }\n  | { type: \"player_animation\"; playerId: string; animation: string }\n  | { type: \"chat_message\"; message: ChatMessage }\n  | { type: \"voice_message\"; senderId: string; audioData: ArrayBuffer }\n  | { type: \"player_updated\"; player: Player }\n  | { type: \"settings_updated\"; settings: LobbySettings }\n  | { type: \"discipline_updated\"; playerId: string; status: DisciplineStatus }\n  | { type: \"alignment_updated\"; playerId: string; alignment: Alignment; change: number }\n  | { type: \"reward_given\"; playerId: string; reward: Reward }\n  | { type: \"punishment_given\"; playerId: string; punishment: Punishment }\n  | { type: \"leading_started\"; leaderId: string; targetId: string }\n  | { type: \"leading_stopped\"; leaderId: string; targetId: string }\n  | { type: \"object_state\"; objectId: string; isOccupied: boolean; occupiedBy?: string }\n  | { type: \"object_occupied\"; objectId: string; playerId: string; objectType: string }\n  | { type: \"object_vacated\"; objectId: string; playerId: string }\n  | { type: \"clothing_changed\"; playerId: string; clothing: ClothingState }\n  | { type: \"needs_updated\"; playerId: string; needs: NeedGauges }\n  | { type: \"accident_occurred\"; accident: Accident }\n  | { type: \"accident_cleaned\"; accidentId: string }\n  | { type: \"diaper_change_started\"; caregiverId: string; littleId: string }\n  | { type: \"diaper_change_completed\"; caregiverId: string; littleId: string }\n  | { type: \"timeout_started\"; playerId: string; duration: number; reason: string }\n  | { type: \"timeout_ended\"; playerId: string }\n  | { type: \"ai_caregiver_action\"; caregiverId: string; action: AuthorityDecision }\n  | { type: \"ai_caregiver_speech\"; caregiverId: string; message: string }\n  | { type: \"error\"; message: string }\n\nexport interface SerializedLobby {\n  id: string\n  inviteCode: string\n  settings: LobbySettings\n  ownerId: string\n  players: Player[]\n  caregivers: Caregiver[]\n  objects: InteractiveObject[]\n  accidents: Accident[]\n  createdAt: number\n  trialEndDate?: number\n  isSuspended: boolean\n}\n\nexport const lobbySettingsSchema = z.object({\n  name: z.string().min(1).max(50),\n  maxPlayers: z.number().min(2).max(20),\n  staffOnlyRoleChanges: z.boolean(),\n  staffOnlyGenderChanges: z.boolean(),\n  isPrivate: z.boolean(),\n})\n\nexport function getAgeGroupScale(ageGroup: AgeGroup): number {\n  switch (ageGroup) {\n    case \"1-4\":\n      return 0.6\n    case \"4-7\":\n      return 0.75\n    case \"7-9\":\n      return 0.85\n    case \"12+\":\n      return 1.0\n  }\n}\n\nexport function canUsePottyAlone(ageGroup: AgeGroup): boolean {\n  return ageGroup === \"7-9\" || ageGroup === \"12+\"\n}\n\nexport function canUseBathroomAlone(ageGroup: AgeGroup): boolean {\n  return ageGroup === \"12+\"\n}\n\nexport function needsEscort(ageGroup: AgeGroup): boolean {\n  return ageGroup === \"1-4\" || ageGroup === \"4-7\"\n}\n\nexport function getAlignmentColor(alignment: Alignment): string {\n  switch (alignment) {\n    case \"little_angel\":\n      return \"#FFD700\"\n    case \"good_boy_girl\":\n      return \"#90EE90\"\n    case \"boy_girl\":\n      return \"#87CEEB\"\n    case \"bad_boy_girl\":\n      return \"#FFA500\"\n    case \"little_shit\":\n      return \"#FF6347\"\n  }\n}\n\nexport function calculateAlignmentChange(currentAlignment: Alignment, change: number): Alignment {\n  // This would need more sophisticated logic in a real implementation\n  const alignmentOrder: Alignment[] = [\"little_shit\", \"bad_boy_girl\", \"boy_girl\", \"good_boy_girl\", \"little_angel\"]\n\n  const currentIndex = alignmentOrder.indexOf(currentAlignment)\n  const newIndex = Math.max(0, Math.min(alignmentOrder.length - 1, currentIndex + change))\n\n  return alignmentOrder[newIndex]\n}\n\n// Voice Service Configuration for AI Caregivers\nexport const VOICE_SERVICE_CONFIG = {\n  // Default voice settings for AI caregivers\n  CAREGIVER_VOICE: {\n    stability: 0.7,\n    similarityBoost: 0.8,\n    style: 0.3,\n    useSpeakerBoost: true,\n  },\n\n  // Audio processing settings\n  AUDIO_SETTINGS: {\n    sampleRate: 44100,\n    channels: 1,\n    bitDepth: 16,\n    chunkDuration: 1000, // 1 second\n  },\n\n  // Recognition settings (for player speech recognition)\n  RECOGNITION_SETTINGS: {\n    language: \"en\",\n    model: \"eleven_multilingual_v2\",\n    confidence: 0.8,\n  },\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AAyaO,MAAM,sBAAsB,0KAAC,CAAC,MAAM,CAAC;IAC1C,MAAM,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;IAC5B,YAAY,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;IAClC,sBAAsB,0KAAC,CAAC,OAAO;IAC/B,wBAAwB,0KAAC,CAAC,OAAO;IACjC,WAAW,0KAAC,CAAC,OAAO;AACtB;AAEO,SAAS,iBAAiB,QAAkB;IACjD,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;IACX;AACF;AAEO,SAAS,iBAAiB,QAAkB;IACjD,OAAO,aAAa,SAAS,aAAa;AAC5C;AAEO,SAAS,oBAAoB,QAAkB;IACpD,OAAO,aAAa;AACtB;AAEO,SAAS,YAAY,QAAkB;IAC5C,OAAO,aAAa,SAAS,aAAa;AAC5C;AAEO,SAAS,kBAAkB,SAAoB;IACpD,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;IACX;AACF;AAEO,SAAS,yBAAyB,gBAA2B,EAAE,MAAc;IAClF,oEAAoE;IACpE,MAAM,iBAA8B;QAAC;QAAe;QAAgB;QAAY;QAAiB;KAAe;IAEhH,MAAM,eAAe,eAAe,OAAO,CAAC;IAC5C,MAAM,WAAW,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,eAAe,MAAM,GAAG,GAAG,eAAe;IAEhF,OAAO,cAAc,CAAC,SAAS;AACjC;AAGO,MAAM,uBAAuB;IAClC,2CAA2C;IAC3C,iBAAiB;QACf,WAAW;QACX,iBAAiB;QACjB,OAAO;QACP,iBAAiB;IACnB;IAEA,4BAA4B;IAC5B,gBAAgB;QACd,YAAY;QACZ,UAAU;QACV,UAAU;QACV,eAAe;IACjB;IAEA,uDAAuD;IACvD,sBAAsB;QACpB,UAAU;QACV,OAAO;QACP,YAAY;IACd;AACF"}},
    {"offset": {"line": 2672, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/shaders/CharacterShader.ts"],"sourcesContent":["import { ShaderMaterial, UniformsUtils, Vector3, Color } from 'three'\n\nexport interface CharacterShaderOptions {\n  skinColor: string\n  hairColor: string\n  eyeColor: string\n  clothingColor: string\n  ageGroup: string\n  emotions?: {\n    happiness: number\n    sadness: number\n    anger: number\n    surprise: number\n  }\n  timeOfDay?: number\n  wetness?: number\n  diaperState?: 'clean' | 'wet' | 'messy' | 'both'\n}\n\nexport class CharacterShaderMaterial extends ShaderMaterial {\n  constructor(options: CharacterShaderOptions) {\n    super()\n\n    // Convert hex colors to THREE.Color objects\n    const skinColor = new Color(options.skinColor)\n    const hairColor = new Color(options.hairColor)\n    const eyeColor = new Color(options.eyeColor)\n    const clothingColor = new Color(options.clothingColor)\n\n    // Shader uniforms\n    this.uniforms = {\n      uSkinColor: { value: skinColor },\n      uHairColor: { value: hairColor },\n      uEyeColor: { value: eyeColor },\n      uClothingColor: { value: clothingColor },\n      uTime: { value: 0 },\n      uEmotions: { value: [0.5, 0, 0, 0] }, // happiness, sadness, anger, surprise\n      uWetness: { value: 0 },\n      uCameraPosition: { value: new Vector3() },\n      uWorldPosition: { value: new Vector3() },\n      uAgeGroup: { value: this.getAgeGroupMultiplier(options.ageGroup) },\n      uDiaperState: { value: this.getDiaperStateValue(options.diaperState || 'clean') },\n      uLightDirection: { value: new Vector3(0.5, 1.0, 0.3).normalize() },\n      uAmbientLight: { value: 0.3 },\n      uDiffuseLight: { value: 0.8 },\n    }\n    \n    // Set vertex shader\n    this.vertexShader = `\n      varying vec3 vNormal;\n      varying vec3 vPosition;\n      varying vec2 vUv;\n      varying vec3 vWorldPosition;\n\n      void main() {\n        vPosition = position;\n        vNormal = normalize(normalMatrix * normal);\n        vUv = uv;\n        vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    `\n    \n    // Set fragment shader\n    this.fragmentShader = `\n      uniform vec3 uSkinColor;\n      uniform vec3 uHairColor;\n      uniform vec3 uEyeColor;\n      uniform vec3 uClothingColor;\n      uniform float uTime;\n      uniform vec4 uEmotions;\n      uniform float uWetness;\n      uniform vec3 uCameraPosition;\n      uniform vec3 uWorldPosition;\n      uniform float uAgeGroup;\n      uniform float uDiaperState;\n      uniform vec3 uLightDirection;\n      uniform float uAmbientLight;\n      uniform float uDiffuseLight;\n\n      varying vec3 vNormal;\n      varying vec3 vPosition;\n      varying vec2 vUv;\n      varying vec3 vWorldPosition;\n\n      // Simple noise function for texture variation\n      float noise(vec2 p) {\n        return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n      }\n\n      void main() {\n        vec3 normal = normalize(vNormal);\n\n        // Lighting calculation\n        vec3 lightDir = normalize(uLightDirection);\n        float diffuse = max(dot(normal, lightDir), 0.0);\n        float ambient = uAmbientLight;\n        \n        // Camera-based rim lighting\n        vec3 viewDir = normalize(uCameraPosition - vWorldPosition);\n        float rim = 1.0 - max(dot(normal, viewDir), 0.0);\n        rim = smoothstep(0.0, 1.0, rim) * 0.2;\n\n        // Color selection based on UV coordinates and emotions\n        vec3 baseColor;\n        float emotionIntensity = uEmotions.x * 0.3 + uEmotions.y * 0.2 + uEmotions.z * 0.2 + uEmotions.w * 0.3;\n\n        if (vUv.y > 0.7) {\n          // Hair area\n          baseColor = uHairColor;\n          // Add emotion-based hair variation\n          baseColor += vec3(uEmotions.z * 0.1, -uEmotions.y * 0.1, 0.0);\n        } else if (vUv.y > 0.5) {\n          // Skin area\n          baseColor = uSkinColor;\n          // Add wetness effect\n          if (uWetness > 0.0) {\n            baseColor = mix(baseColor, vec3(0.7, 0.8, 1.0), uWetness * 0.3);\n          }\n          // Add emotion-based skin variation\n          baseColor += vec3(uEmotions.x * 0.05, -uEmotions.y * 0.05, 0.0);\n        } else {\n          // Clothing area\n          baseColor = uClothingColor;\n          // Diaper state affects color\n          if (uDiaperState > 0.0) {\n            baseColor = mix(baseColor, vec3(0.6, 0.8, 1.0), uDiaperState * 0.2);\n          }\n        }\n\n        // Age group affects overall brightness\n        baseColor *= uAgeGroup;\n\n        // Add subtle texture variation\n        float textureNoise = noise(vUv * 10.0 + uTime * 0.1);\n        baseColor *= (0.95 + textureNoise * 0.1);\n\n        // Apply emotion intensity\n        baseColor *= (1.0 + emotionIntensity * 0.1);\n\n        // Apply lighting\n        vec3 litColor = baseColor * (ambient + diffuse * uDiffuseLight) + rim;\n\n        // Add subtle fresnel effect\n        float fresnel = pow(1.0 - max(dot(normal, viewDir), 0.0), 3.0);\n        litColor += fresnel * 0.1;\n\n        gl_FragColor = vec4(litColor, 1.0);\n      }\n    `\n    \n    this.transparent = false\n    this.depthWrite = true\n    this.depthTest = true\n    this.side = 2 // Double-sided\n  }\n  \n  private getAgeGroupMultiplier(ageGroup: string): number {\n    switch (ageGroup) {\n      case '1-4': return 0.6\n      case '4-7': return 0.75\n      case '7-9': return 0.85\n      case '12+': return 1.0\n      default: return 0.8\n    }\n  }\n  \n  private getDiaperStateValue(state: string): number {\n    switch (state) {\n      case 'clean': return 0.0\n      case 'wet': return 1.0\n      case 'messy': return 2.0\n      case 'both': return 3.0\n      default: return 0.0\n    }\n  }\n  \n  updateTime(time: number) {\n    this.uniforms.uTime.value = time\n  }\n\n  updateEmotions(emotions: CharacterShaderOptions['emotions']) {\n    this.uniforms.uEmotions.value = [\n      emotions?.happiness || 0,\n      emotions?.sadness || 0,\n      emotions?.anger || 0,\n      emotions?.surprise || 0\n    ]\n  }\n\n  updateWetness(wetness: number) {\n    this.uniforms.uWetness.value = wetness\n  }\n\n  updateCameraPosition(position: Vector3) {\n    this.uniforms.uCameraPosition.value.copy(position)\n  }\n\n  updateWorldPosition(position: Vector3) {\n    this.uniforms.uWorldPosition.value.copy(position)\n  }\n\n  // Additional methods for better shader management\n  dispose() {\n    super.dispose()\n  }\n\n  clone(): this {\n    const cloned = new CharacterShaderMaterial({\n      skinColor: `#${this.uniforms.uSkinColor.value.getHexString()}`,\n      hairColor: `#${this.uniforms.uHairColor.value.getHexString()}`,\n      eyeColor: `#${this.uniforms.uEyeColor.value.getHexString()}`,\n      clothingColor: `#${this.uniforms.uClothingColor.value.getHexString()}`,\n      ageGroup: this.getAgeGroupFromMultiplier(this.uniforms.uAgeGroup.value),\n      emotions: {\n        happiness: this.uniforms.uEmotions.value[0],\n        sadness: this.uniforms.uEmotions.value[1],\n        anger: this.uniforms.uEmotions.value[2],\n        surprise: this.uniforms.uEmotions.value[3]\n      },\n      wetness: this.uniforms.uWetness.value,\n      diaperState: this.getDiaperStateFromValue(this.uniforms.uDiaperState.value)\n    }) as this\n    \n    // Copy additional uniforms\n    cloned.uniforms.uTime.value = this.uniforms.uTime.value\n    cloned.uniforms.uCameraPosition.value.copy(this.uniforms.uCameraPosition.value)\n    cloned.uniforms.uWorldPosition.value.copy(this.uniforms.uWorldPosition.value)\n    cloned.uniforms.uLightDirection.value.copy(this.uniforms.uLightDirection.value)\n    cloned.uniforms.uAmbientLight.value = this.uniforms.uAmbientLight.value\n    cloned.uniforms.uDiffuseLight.value = this.uniforms.uDiffuseLight.value\n    \n    return cloned\n  }\n\n  private getAgeGroupFromMultiplier(multiplier: number): string {\n    switch (multiplier) {\n      case 0.6: return '1-4'\n      case 0.75: return '4-7'\n      case 0.85: return '7-9'\n      case 1.0: return '12+'\n      default: return '4-7'\n    }\n  }\n\n  private getDiaperStateFromValue(value: number): 'clean' | 'wet' | 'messy' | 'both' {\n    switch (value) {\n      case 0.0: return 'clean'\n      case 1.0: return 'wet'\n      case 2.0: return 'messy'\n      case 3.0: return 'both'\n      default: return 'clean'\n    }\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2957, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/animations/CharacterAnimationSystem.ts"],"sourcesContent":["// Character Animation System with crying, pee, diaper change animations\nimport { useRef, useEffect, useState, useMemo } from 'react'\nimport { useFrame } from '@react-three/fiber'\nimport { AnimationMixer, LoopRepeat, Vector3, Quaternion } from 'three'\nimport { gsap } from 'gsap'\nimport type { CharacterShaderMaterial } from '../shaders/CharacterShader'\nimport type { CharacterCustomization, ClothingState } from '@/lib/types/gameTypes'\n\nexport type CharacterAnimation = \n  | 'idle'\n  | 'walk'\n  | 'run'\n  | 'jump'\n  | 'crawl'\n  | 'sit'\n  | 'cry'\n  | 'pee'\n  | 'diaper_change'\n  | 'cry_intense'\n  | 'happy_dance'\n  | 'timeout_pose'\n  | 'spank_otk'\n  | 'being_led'\n\nexport interface AnimationConfig {\n  duration: number\n  loop: boolean\n  easing: string\n  priority: number // Higher priority animations interrupt lower ones\n}\n\nexport interface AnimationState {\n  current: CharacterAnimation\n  previous: CharacterAnimation\n  isPlaying: boolean\n  startTime: number\n  duration: number\n  speed: number\n}\n\nexport class CharacterAnimationController {\n  private mixer: AnimationMixer | null = null\n  private currentAnimation: CharacterAnimation = 'idle'\n  private animations: Map<CharacterAnimation, AnimationConfig> = new Map()\n  private onAnimationChange?: (animation: CharacterAnimation) => void\n  \n  constructor() {\n    this.setupAnimations()\n  }\n  \n  private setupAnimations() {\n    this.animations.set('idle', {\n      duration: 2.0,\n      loop: true,\n      easing: 'power2.inOut',\n      priority: 0\n    })\n    \n    this.animations.set('walk', {\n      duration: 1.0,\n      loop: true,\n      easing: 'none',\n      priority: 1\n    })\n    \n    this.animations.set('run', {\n      duration: 0.8,\n      loop: true,\n      easing: 'none',\n      priority: 2\n    })\n    \n    this.animations.set('jump', {\n      duration: 1.5,\n      loop: false,\n      easing: 'power2.out',\n      priority: 3\n    })\n    \n    this.animations.set('crawl', {\n      duration: 1.2,\n      loop: true,\n      easing: 'none',\n      priority: 2\n    })\n    \n    this.animations.set('sit', {\n      duration: 2.0,\n      loop: true,\n      easing: 'power2.inOut',\n      priority: 1\n    })\n    \n    // Special gameplay animations\n    this.animations.set('cry', {\n      duration: 3.0,\n      loop: true,\n      easing: 'none',\n      priority: 5\n    })\n    \n    this.animations.set('cry_intense', {\n      duration: 1.5,\n      loop: true,\n      easing: 'none',\n      priority: 6\n    })\n    \n    this.animations.set('pee', {\n      duration: 4.0,\n      loop: false,\n      easing: 'power2.inOut',\n      priority: 7\n    })\n    \n    this.animations.set('diaper_change', {\n      duration: 5.0,\n      loop: false,\n      easing: 'power2.inOut',\n      priority: 8\n    })\n    \n    this.animations.set('happy_dance', {\n      duration: 2.5,\n      loop: true,\n      easing: 'bounce.out',\n      priority: 4\n    })\n    \n    this.animations.set('timeout_pose', {\n      duration: 3.0,\n      loop: true,\n      easing: 'none',\n      priority: 5\n    })\n    \n    this.animations.set('spank_otk', {\n      duration: 3.0,\n      loop: false,\n      easing: 'power2.inOut',\n      priority: 9\n    })\n    \n    this.animations.set('being_led', {\n      duration: 2.0,\n      loop: true,\n      easing: 'none',\n      priority: 4\n    })\n  }\n  \n  setMixer(mixer: AnimationMixer) {\n    this.mixer = mixer\n  }\n  \n  setOnAnimationChange(callback: (animation: CharacterAnimation) => void) {\n    this.onAnimationChange = callback\n  }\n  \n  playAnimation(\n    animation: CharacterAnimation, \n    character?: {\n      position: Vector3\n      rotation: Quaternion\n      scale?: Vector3\n    },\n    options?: {\n      duration?: number\n      speed?: number\n      onComplete?: () => void\n    }\n  ): boolean {\n    if (!this.mixer) return false\n    \n    const config = this.animations.get(animation)\n    if (!config) return false\n    \n    // Check priority - higher priority animations interrupt lower ones\n    const currentConfig = this.animations.get(this.currentAnimation)\n    if (currentConfig && config.priority < currentConfig.priority) {\n      return false\n    }\n    \n    // Create GSAP timeline for the animation\n    const timeline = gsap.timeline({\n      onComplete: () => {\n        if (options?.onComplete) {\n          options.onComplete()\n        }\n      }\n    })\n    \n    // Set character transform if provided\n    if (character) {\n      timeline.set(character, {\n        x: character.position.x,\n        y: character.position.y,\n        z: character.position.z,\n        rotationX: character.rotation.x,\n        rotationY: character.rotation.y,\n        rotationZ: character.rotation.z,\n        scaleX: character.scale?.x || 1,\n        scaleY: character.scale?.y || 1,\n        scaleZ: character.scale?.z || 1,\n      })\n    }\n    \n    // Define animation sequences based on type\n    switch (animation) {\n      case 'cry':\n        this.createCryAnimation(timeline, character)\n        break\n      case 'cry_intense':\n        this.createIntenseCryAnimation(timeline, character)\n        break\n      case 'pee':\n        this.createPeeAnimation(timeline, character)\n        break\n      case 'diaper_change':\n        this.createDiaperChangeAnimation(timeline, character)\n        break\n      case 'happy_dance':\n        this.createHappyDanceAnimation(timeline, character)\n        break\n      case 'timeout_pose':\n        this.createTimeoutPoseAnimation(timeline, character)\n        break\n      case 'spank_otk':\n        this.createSpankAnimation(timeline, character)\n        break\n      case 'being_led':\n        this.createBeingLedAnimation(timeline, character)\n        break\n      default:\n        this.createStandardAnimation(timeline, animation, character)\n    }\n    \n    this.currentAnimation = animation\n    this.onAnimationChange?.(animation)\n    \n    return true\n  }\n  \n  private createCryAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Crying animation with head bobbing and arm movements\n    timeline.to(character, {\n      duration: 0.5,\n      y: character.position.y + 0.2,\n      rotationZ: -0.1,\n      easing: 'power2.in'\n    })\n    \n    // Repeat crying motion\n    timeline.to(character, {\n      duration: 1.0,\n      y: character.position.y - 0.1,\n      rotationZ: 0.1,\n      repeat: -1,\n      yoyo: true,\n      easing: 'sine.inOut'\n    })\n    \n    // Hand to face gesture\n    timeline.to(character, {\n      duration: 0.3,\n      x: character.position.x - 0.3,\n      rotationY: -0.3,\n      repeat: -1,\n      yoyo: true,\n      easing: 'sine.inOut'\n    }, 0)\n  }\n  \n  private createIntenseCryAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // More aggressive crying with full body movement\n    timeline.to(character, {\n      duration: 0.3,\n      y: character.position.y + 0.3,\n      x: character.position.x + 0.1,\n      rotationX: -0.2,\n      rotationZ: 0.2,\n      easing: 'power2.in'\n    })\n    \n    // Violent shaking\n    timeline.to(character, {\n      duration: 0.8,\n      x: character.position.x - 0.2,\n      rotationY: 0.4,\n      repeat: -1,\n      yoyo: true,\n      easing: 'power2.inOut'\n    })\n    \n    // Arms flailing\n    timeline.to(character, {\n      duration: 0.4,\n      rotationZ: -0.5,\n      repeat: -1,\n      yoyo: true,\n      easing: 'bounce.inOut'\n    }, 0)\n  }\n  \n  private createPeeAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Potty preparation\n    timeline.to(character, {\n      duration: 1.0,\n      y: character.position.y - 0.3,\n      rotationX: 0.3,\n      easing: 'power2.inOut'\n    })\n    \n    // Squatting position\n    timeline.to(character, {\n      duration: 1.5,\n      y: character.position.y - 0.6,\n      rotationX: 0.6,\n      scaleY: 0.8,\n      easing: 'power2.inOut'\n    })\n    \n    // Releasing (brief pause)\n    timeline.to(character, {\n      duration: 1.0,\n      y: character.position.y - 0.5,\n      repeat: 0\n    })\n    \n    // Standing up\n    timeline.to(character, {\n      duration: 1.5,\n      y: character.position.y,\n      rotationX: 0,\n      scaleY: 1,\n      easing: 'power2.out'\n    })\n  }\n  \n  private createDiaperChangeAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Lying down\n    timeline.to(character, {\n      duration: 1.0,\n      y: character.position.y - 0.5,\n      rotationX: -1.5,\n      easing: 'power2.inOut'\n    })\n    \n    // Struggling slightly\n    timeline.to(character, {\n      duration: 0.5,\n      rotationZ: 0.2,\n      repeat: 3,\n      yoyo: true,\n      easing: 'sine.inOut'\n    })\n    \n    // Cooperative pose\n    timeline.to(character, {\n      duration: 1.0,\n      rotationX: -1.2,\n      rotationZ: 0,\n      easing: 'power2.inOut'\n    })\n    \n    // Staying still during change\n    timeline.to(character, {\n      duration: 2.0,\n      // Minimal movement - just breathing\n      y: character.position.y - 0.5 + Math.sin(Date.now()) * 0.02,\n      repeat: 0\n    })\n    \n    // Getting up\n    timeline.to(character, {\n      duration: 0.5,\n      y: character.position.y,\n      rotationX: 0,\n      easing: 'power2.out'\n    })\n  }\n  \n  private createHappyDanceAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Jumping up and down\n    timeline.to(character, {\n      duration: 0.4,\n      y: character.position.y + 0.4,\n      scaleY: 1.1,\n      easing: 'bounce.out'\n    })\n    \n    timeline.to(character, {\n      duration: 0.4,\n      y: character.position.y,\n      scaleY: 1,\n      repeat: -1,\n      yoyo: true,\n      easing: 'bounce.in'\n    })\n    \n    // Arms swaying\n    timeline.to(character, {\n      duration: 1.0,\n      rotationY: 0.3,\n      repeat: -1,\n      yoyo: true,\n      easing: 'sine.inOut'\n    })\n  }\n  \n  private createTimeoutPoseAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Defiant pose\n    timeline.to(character, {\n      duration: 1.0,\n      rotationY: Math.PI,\n      y: character.position.y + 0.1,\n      easing: 'power2.inOut'\n    })\n    \n    // Slight bouncing/sulking\n    timeline.to(character, {\n      duration: 2.0,\n      y: character.position.y + 0.05,\n      repeat: -1,\n      yoyo: true,\n      easing: 'sine.inOut'\n    })\n  }\n  \n  private createSpankAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Over-the-knee position\n    timeline.to(character, {\n      duration: 0.8,\n      rotationX: -1.0,\n      y: character.position.y - 0.4,\n      easing: 'power2.inOut'\n    })\n    \n    // Struggling\n    timeline.to(character, {\n      duration: 0.3,\n      rotationZ: 0.3,\n      repeat: 5,\n      yoyo: true,\n      easing: 'power2.inOut'\n    })\n    \n    // Brief pause\n    timeline.to(character, {\n      duration: 0.5,\n      rotationZ: 0,\n      repeat: 0\n    })\n    \n    // Getting up\n    timeline.to(character, {\n      duration: 1.0,\n      rotationX: 0,\n      y: character.position.y,\n      easing: 'power2.out'\n    })\n  }\n  \n  private createBeingLedAnimation(timeline: gsap.core.Timeline, character?: any) {\n    // Passive walking motion\n    timeline.to(character, {\n      duration: 0.8,\n      y: character.position.y + 0.1,\n      repeat: -1,\n      yoyo: true,\n      easing: 'sine.inOut'\n    })\n    \n    // Slight resistance movement\n    timeline.to(character, {\n      duration: 1.5,\n      rotationX: -0.1,\n      repeat: -1,\n      yoyo: true,\n      easing: 'sine.inOut'\n    })\n  }\n  \n  private createStandardAnimation(timeline: gsap.core.Timeline, animation: CharacterAnimation, character?: any) {\n    const config = this.animations.get(animation)!\n    \n    // Simple loop animation for basic movements\n    if (config.loop) {\n      timeline.to(character, {\n        duration: config.duration,\n        repeat: -1,\n        yoyo: true,\n        easing: config.easing,\n        // Add subtle movement based on animation type\n        ...this.getAnimationTransforms(animation, character)\n      })\n    } else {\n      timeline.to(character, {\n        duration: config.duration,\n        easing: config.easing,\n        ...this.getAnimationTransforms(animation, character)\n      })\n    }\n  }\n  \n  private getAnimationTransforms(animation: CharacterAnimation, character?: any) {\n    const transforms: any = {}\n    \n    switch (animation) {\n      case 'walk':\n        transforms.y = character.position.y + 0.05\n        transforms.rotationY = Math.sin(Date.now() * 0.01) * 0.1\n        break\n      case 'run':\n        transforms.y = character.position.y + 0.1\n        transforms.scaleX = 1.05\n        break\n      case 'jump':\n        transforms.y = character.position.y + 0.5\n        transforms.scaleY = 1.2\n        break\n      case 'sit':\n        transforms.y = character.position.y - 0.3\n        transforms.rotationX = 0.2\n        break\n      default:\n        break\n    }\n    \n    return transforms\n  }\n  \n  update(delta: number) {\n    if (this.mixer) {\n      this.mixer.update(delta)\n    }\n  }\n  \n  stop() {\n    if (this.mixer) {\n      this.mixer.stopAllAction()\n    }\n    this.currentAnimation = 'idle'\n  }\n  \n  getCurrentAnimation(): CharacterAnimation {\n    return this.currentAnimation\n  }\n}\n\n// React hook for character animations\nexport function useCharacterAnimations() {\n  const [animationState, setAnimationState] = useState<AnimationState>({\n    current: 'idle',\n    previous: 'idle',\n    isPlaying: false,\n    startTime: 0,\n    duration: 0,\n    speed: 1\n  })\n  \n  const controllerRef = useRef<CharacterAnimationController | null>(null)\n  \n  useEffect(() => {\n    controllerRef.current = new CharacterAnimationController()\n    \n    controllerRef.current.setOnAnimationChange((animation) => {\n      setAnimationState(prev => ({\n        ...prev,\n        current: animation,\n        previous: prev.current,\n        isPlaying: true,\n        startTime: Date.now()\n      }))\n    })\n    \n    return () => {\n      controllerRef.current?.stop()\n    }\n  }, [])\n  \n  const playAnimation = (animation: CharacterAnimation, character?: any, options?: any) => {\n    if (controllerRef.current) {\n      return controllerRef.current.playAnimation(animation, character, {\n        ...options,\n        onComplete: () => {\n          setAnimationState(prev => ({\n            ...prev,\n            isPlaying: false\n          }))\n          if (options?.onComplete) {\n            options.onComplete()\n          }\n        }\n      })\n    }\n    return false\n  }\n  \n  const update = (delta: number) => {\n    controllerRef.current?.update(delta)\n  }\n  \n  return {\n    animationState,\n    playAnimation,\n    update,\n    controller: controllerRef.current\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3476, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/models/CustomCharacterModel.tsx"],"sourcesContent":["// Custom Character Model using Three.js primitives and custom shaders\nimport { useRef, useMemo, useEffect, useState } from 'react'\nimport { useFrame, useThree } from '@react-three/fiber'\nimport { Mesh, Vector3, Quaternion, Euler, Color } from 'three'\nimport { CharacterShaderMaterial } from '../shaders/CharacterShader'\nimport { CharacterAnimation, useCharacterAnimations, type CharacterAnimationController } from '../animations/CharacterAnimationSystem'\nimport type { CharacterCustomization, ClothingState } from '@/lib/types/gameTypes'\n\nexport interface CustomCharacterModelProps {\n  customization: CharacterCustomization\n  clothing: ClothingState\n  position: [number, number, number]\n  rotation?: [number, number, number]\n  scale?: number\n  currentAnimation?: CharacterAnimation\n  onAnimationChange?: (animation: CharacterAnimation) => void\n  emotions?: {\n    happiness: number\n    sadness: number\n    anger: number\n    surprise: number\n  }\n  isAnimated?: boolean\n}\n\nexport function CustomCharacterModel({\n  customization,\n  clothing,\n  position,\n  rotation = [0, 0, 0],\n  scale = 1,\n  currentAnimation = 'idle',\n  onAnimationChange,\n  emotions,\n  isAnimated = true\n}: CustomCharacterModelProps) {\n  const groupRef = useRef<any>(null)\n  const headRef = useRef<Mesh>(null)\n  const bodyRef = useRef<Mesh>(null)\n  const armsRef = useRef<{ left: Mesh; right: Mesh }>(null)\n  const legsRef = useRef<{ left: Mesh; right: Mesh }>(null)\n  const diaperRef = useRef<Mesh>(null)\n  \n  const { camera } = useThree()\n  const [shaderMaterials, setShaderMaterials] = useState<CharacterShaderMaterial[]>([])\n  \n  // Animation system\n  const { animationState, playAnimation, update } = useCharacterAnimations()\n  \n  // Create shader materials with error handling\n  const characterMaterial = useMemo(() => {\n    try {\n      const material = new CharacterShaderMaterial({\n        skinColor: customization.skinColor,\n        hairColor: customization.hairColor || '#8B4513',\n        eyeColor: customization.eyeColor || '#4A90E2',\n        clothingColor: getClothingColor(clothing),\n        ageGroup: customization.ageGroup,\n        emotions: emotions || { happiness: 0.5, sadness: 0, anger: 0, surprise: 0 },\n        wetness: getWetnessLevel(clothing),\n        diaperState: clothing.underwearState\n      })\n      return material\n    } catch (error) {\n      console.error('Error creating character shader material:', error)\n      // Fallback to basic material\n      return {\n        color: customization.skinColor,\n        roughness: 0.8,\n        metalness: 0.1,\n        updateTime: () => {},\n        updateEmotions: () => {},\n        updateWetness: () => {},\n        updateCameraPosition: () => {},\n        updateWorldPosition: () => {},\n        clone: () => {},\n        dispose: () => {}\n      }\n    }\n  }, [customization, clothing, emotions])\n  \n  // Character dimensions based on age group\n  const characterDimensions = useMemo(() => {\n    switch (customization.ageGroup) {\n      case '1-4':\n        return {\n          headSize: 0.25,\n          bodyHeight: 0.6,\n          bodyWidth: 0.3,\n          armLength: 0.35,\n          legLength: 0.4,\n          scale: 0.6\n        }\n      case '4-7':\n        return {\n          headSize: 0.28,\n          bodyHeight: 0.8,\n          bodyWidth: 0.35,\n          armLength: 0.45,\n          legLength: 0.5,\n          scale: 0.75\n        }\n      case '7-9':\n        return {\n          headSize: 0.3,\n          bodyHeight: 1.0,\n          bodyWidth: 0.4,\n          armLength: 0.55,\n          legLength: 0.6,\n          scale: 0.85\n        }\n      case '12+':\n        return {\n          headSize: 0.32,\n          bodyHeight: 1.2,\n          bodyWidth: 0.45,\n          armLength: 0.65,\n          legLength: 0.7,\n          scale: 1.0\n        }\n      default:\n        return {\n          headSize: 0.28,\n          bodyHeight: 0.9,\n          bodyWidth: 0.38,\n          armLength: 0.5,\n          legLength: 0.55,\n          scale: 0.8\n        }\n    }\n  }, [customization.ageGroup])\n  \n  // Update shader uniforms\n  useFrame((state, delta) => {\n    if (isAnimated) {\n      update(delta)\n    }\n    \n    // Update shader uniforms\n    characterMaterial.updateTime(state.clock.elapsedTime)\n    characterMaterial.updateCameraPosition(camera.position)\n    \n    if (groupRef.current) {\n      characterMaterial.updateWorldPosition(groupRef.current.position)\n    }\n    \n    // Animate emotions\n    if (emotions) {\n      characterMaterial.updateEmotions(emotions)\n    }\n    \n    // Update wetness based on clothing state\n    characterMaterial.updateWetness(getWetnessLevel(clothing))\n  })\n  \n  // Handle animation changes\n  useEffect(() => {\n    if (currentAnimation !== animationState.current && isAnimated) {\n      playAnimation(currentAnimation, groupRef.current)\n    }\n  }, [currentAnimation, animationState.current, isAnimated])\n  \n  // Create character body parts\n  const Body = () => (\n    <group ref={groupRef} position={position} rotation={rotation} scale={characterDimensions.scale * scale}>\n      {/* Head */}\n      <mesh ref={headRef} position={[0, characterDimensions.bodyHeight + characterDimensions.headSize, 0]} castShadow>\n        <sphereGeometry args={[characterDimensions.headSize, 16, 16]} />\n        <primitive object={characterMaterial} attach=\"material\" />\n      </mesh>\n      \n      {/* Hair */}\n      {customization.hairColor && (\n        <mesh position={[0, characterDimensions.bodyHeight + characterDimensions.headSize + characterDimensions.headSize * 0.8, 0]} castShadow>\n          <sphereGeometry args={[characterDimensions.headSize * 1.1, 12, 12]} />\n          <meshStandardMaterial color={customization.hairColor} roughness={0.9} />\n        </mesh>\n      )}\n      \n      {/* Body */}\n      <mesh ref={bodyRef} position={[0, characterDimensions.bodyHeight / 2, 0]} castShadow>\n        <cylinderGeometry args={[characterDimensions.bodyWidth / 2, characterDimensions.bodyWidth / 2, characterDimensions.bodyHeight, 8]} />\n        <primitive object={characterMaterial} attach=\"material\" />\n      </mesh>\n      \n      {/* Arms */}\n      <group ref={armsRef}>\n        <mesh \n          position={[-characterDimensions.bodyWidth / 2 - 0.05, characterDimensions.bodyHeight * 0.8, 0]} \n          rotation={[0, 0, Math.PI / 6]} \n          castShadow\n        >\n          <cylinderGeometry args={[0.06, 0.06, characterDimensions.armLength, 8]} />\n          <primitive object={characterMaterial} attach=\"material\" />\n        </mesh>\n        <mesh \n          position={[characterDimensions.bodyWidth / 2 + 0.05, characterDimensions.bodyHeight * 0.8, 0]} \n          rotation={[0, 0, -Math.PI / 6]} \n          castShadow\n        >\n          <cylinderGeometry args={[0.06, 0.06, characterDimensions.armLength, 8]} />\n          <primitive object={characterMaterial} attach=\"material\" />\n        </mesh>\n      </group>\n      \n      {/* Legs */}\n      <group ref={legsRef}>\n        <mesh position={[-characterDimensions.bodyWidth / 4, characterDimensions.legLength / 2, 0]} castShadow>\n          <cylinderGeometry args={[0.08, 0.08, characterDimensions.legLength, 8]} />\n          <primitive object={characterMaterial} attach=\"material\" />\n        </mesh>\n        <mesh position={[characterDimensions.bodyWidth / 4, characterDimensions.legLength / 2, 0]} castShadow>\n          <cylinderGeometry args={[0.08, 0.08, characterDimensions.legLength, 8]} />\n          <primitive object={characterMaterial} attach=\"material\" />\n        </mesh>\n      </group>\n      \n      {/* Diaper */}\n      {clothing.underwearType === 'diaper' && (\n        <mesh ref={diaperRef} position={[0, characterDimensions.bodyHeight * 0.2, characterDimensions.bodyWidth / 2]} castShadow>\n          <boxGeometry args={[characterDimensions.bodyWidth * 0.8, 0.3, 0.1]} />\n          <meshStandardMaterial \n            color={getDiaperColor(clothing.underwearState)} \n            transparent \n            opacity={0.9}\n          />\n        </mesh>\n      )}\n      \n      {/* Face details */}\n      <FaceDetails \n        eyeColor={customization.eyeColor || '#4A90E2'} \n        headHeight={characterDimensions.bodyHeight + characterDimensions.headSize}\n        headSize={characterDimensions.headSize}\n        emotions={emotions}\n      />\n      \n      {/* Clothing overlays */}\n      <ClothingOverlays \n        clothing={clothing} \n        dimensions={characterDimensions}\n      />\n    </group>\n  )\n  \n  return <Body />\n}\n\n// Face details component\nfunction FaceDetails({ \n  eyeColor, \n  headHeight,\n  headSize,\n  emotions \n}: { \n  eyeColor: string\n  headHeight: number\n  headSize: number\n  emotions?: { happiness: number; sadness: number; anger: number; surprise: number }\n}) {\n  const eyeSize = emotions?.surprise && emotions.surprise > 0.3 ? 0.08 : 0.06\n  \n  return (\n    <group position={[0, headHeight - 0.1, headSize * 0.9]}>\n      {/* Eyes */}\n      <mesh position={[-0.12, 0.05, 0]}>\n        <sphereGeometry args={[eyeSize, 8, 8]} />\n        <meshBasicMaterial color={eyeColor} />\n      </mesh>\n      <mesh position={[0.12, 0.05, 0]}>\n        <sphereGeometry args={[eyeSize, 8, 8]} />\n        <meshBasicMaterial color={eyeColor} />\n      </mesh>\n      \n      {/* Mouth - emotion based */}\n      <mesh position={[0, -0.05, 0]}>\n        <sphereGeometry args={[0.03, 6, 6]} />\n        <meshBasicMaterial \n          color={\n            emotions?.happiness && emotions.happiness > 0.5 ? '#FF6B6B' :\n            emotions?.anger && emotions.anger > 0.5 ? '#FF4757' :\n            emotions?.sadness && emotions.sadness > 0.5 ? '#57606F' :\n            '#FF6B6B'\n          } \n        />\n      </mesh>\n      \n      {/* Tears for crying */}\n      {emotions?.sadness && emotions.sadness > 0.3 && (\n        <group>\n          <mesh position={[-0.15, 0.02, 0]}>\n            <sphereGeometry args={[0.02, 4, 4]} />\n            <meshBasicMaterial color=\"#87CEEB\" transparent opacity={0.7} />\n          </mesh>\n          <mesh position={[0.15, 0.02, 0]}>\n            <sphereGeometry args={[0.02, 4, 4]} />\n            <meshBasicMaterial color=\"#87CEEB\" transparent opacity={0.7} />\n          </mesh>\n        </group>\n      )}\n    </group>\n  )\n}\n\n// Clothing overlays component\nfunction ClothingOverlays({ \n  clothing, \n  dimensions \n}: { \n  clothing: ClothingState\n  dimensions: any \n}) {\n  return (\n    <group>\n      {/* Shirt */}\n      {clothing.shirt && (\n        <mesh position={[0, dimensions.bodyHeight * 0.8, 0]} castShadow>\n          <cylinderGeometry args={[dimensions.bodyWidth / 2 + 0.02, dimensions.bodyWidth / 2 + 0.02, dimensions.bodyHeight * 0.6, 8]} />\n          <meshStandardMaterial color=\"#E8E8E8\" roughness={0.8} />\n        </mesh>\n      )}\n      \n      {/* Pants */}\n      {clothing.pants && (\n        <group>\n          <mesh position={[-dimensions.bodyWidth / 6, dimensions.legLength * 0.3, 0]} castShadow>\n            <cylinderGeometry args={[0.1, 0.09, dimensions.legLength * 0.6, 8]} />\n            <meshStandardMaterial color=\"#4169E1\" roughness={0.7} />\n          </mesh>\n          <mesh position={[dimensions.bodyWidth / 6, dimensions.legLength * 0.3, 0]} castShadow>\n            <cylinderGeometry args={[0.1, 0.09, dimensions.legLength * 0.6, 8]} />\n            <meshStandardMaterial color=\"#4169E1\" roughness={0.7} />\n          </mesh>\n        </group>\n      )}\n      \n      {/* Socks */}\n      {clothing.socks && (\n        <group>\n          <mesh position={[-dimensions.bodyWidth / 6, 0.05, 0.05]} castShadow>\n            <boxGeometry args={[0.12, 0.1, 0.18]} />\n            <meshStandardMaterial color=\"#FFFFFF\" />\n          </mesh>\n          <mesh position={[dimensions.bodyWidth / 6, 0.05, 0.05]} castShadow>\n            <boxGeometry args={[0.12, 0.1, 0.18]} />\n            <meshStandardMaterial color=\"#FFFFFF\" />\n          </mesh>\n        </group>\n      )}\n      \n      {/* Shoes */}\n      {clothing.shoes && (\n        <group>\n          <mesh position={[-dimensions.bodyWidth / 6, 0.02, 0.1]} castShadow>\n            <boxGeometry args={[0.16, 0.08, 0.22]} />\n            <meshStandardMaterial color=\"#8B4513\" roughness={0.9} />\n          </mesh>\n          <mesh position={[dimensions.bodyWidth / 6, 0.02, 0.1]} castShadow>\n            <boxGeometry args={[0.16, 0.08, 0.22]} />\n            <meshStandardMaterial color=\"#8B4513\" roughness={0.9} />\n          </mesh>\n        </group>\n      )}\n    </group>\n  )\n}\n\n// Helper functions\nfunction getClothingColor(clothing: ClothingState): string {\n  if (clothing.underwearType === 'diaper') {\n    return getDiaperColor(clothing.underwearState)\n  }\n  return '#E8E8E8' // Default clothing color\n}\n\nfunction getDiaperColor(state: string): string {\n  switch (state) {\n    case 'clean': return '#FFFFFF'\n    case 'wet': return '#ADD8E6'\n    case 'messy': return '#8B4513'\n    case 'both': return '#D2691E'\n    default: return '#FFFFFF'\n  }\n}\n\nfunction getWetnessLevel(clothing: ClothingState): number {\n  switch (clothing.underwearState) {\n    case 'wet': return 0.6\n    case 'messy': return 0.8\n    case 'both': return 1.0\n    default: return 0.0\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4495, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/PlayerController.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRef, useState, useEffect } from \"react\";\nimport { useThree } from \"@react-three/fiber\";\nimport { KeyboardControls, useKeyboardControls } from \"@react-three/drei\";\nimport Ecctrl from \"ecctrl\";\nimport type { ReactNode } from \"react\";\n\nimport { useGameStore } from \"@/lib/stores/gameStore\";\nimport { getAgeGroupScale } from \"@/lib/types/gameTypes\";\nimport type { Player } from \"@/lib/types/gameTypes\";\n\nimport { CustomCharacterModel } from \"./models/CustomCharacterModel\";\nimport type { CharacterAnimation } from \"./animations/CharacterAnimationSystem\";\n\ninterface PlayerControllerProps {\n  player: Player;\n  isLocalPlayer: boolean;\n}\n\nexport function PlayerController({\n  player,\n  isLocalPlayer,\n}: PlayerControllerProps) {\n  const groupRef = useRef<any>(null);\n  const { camera } = useThree();\n\n  const updatePlayer = useGameStore((s) => s.updatePlayer);\n  const scale = getAgeGroupScale(player.character.ageGroup);\n\n  const [currentAnimation, setCurrentAnimation] =\n    useState<CharacterAnimation>(\"idle\");\n\n  const [emotions, setEmotions] = useState({\n    happiness: 0.5,\n    sadness: 0,\n    anger: 0,\n    surprise: 0,\n  });\n\n  const [, getKeys] = useKeyboardControls();\n\n  useEffect(() => {\n    updatePlayer(player.id, { currentAnimation });\n  }, [currentAnimation, player.id, updatePlayer]);\n\n  return (\n        <Ecctrl>\n          <group ref={groupRef} scale={scale}>\n            <CustomCharacterModel\n              customization={player.character}\n              clothing={player.clothing}\n              position={[0, 0, 0]}\n              scale={1}\n              currentAnimation={currentAnimation}\n              emotions={emotions}\n              isAnimated\n            />\n\n            <NameTag\n              name={player.name}\n              alignment={player.alignment}\n            />\n\n            <NeedIndicators player={player} />\n            <EmotionIndicators emotions={emotions} />\n\n            {process.env.NODE_ENV === \"development\" && (\n              <mesh position={[0, 3, 0]}>\n                <planeGeometry args={[2, 0.5]} />\n                <meshBasicMaterial\n                  color=\"#000\"\n                  transparent\n                  opacity={0.7}\n                />\n              </mesh>\n            )}\n          </group>\n        </Ecctrl>\n  );\n}\n\n/* ----------------------------- */\n/* UI Subcomponents              */\n/* ----------------------------- */\n\nfunction NameTag({\n  name,\n  alignment,\n}: {\n  name: string;\n  alignment: Player[\"alignment\"];\n}) {\n  const getAlignmentColor = (a: Player[\"alignment\"]) => {\n    switch (a) {\n      case \"little_angel\":\n        return \"#FFD700\";\n      case \"good_boy_girl\":\n        return \"#90EE90\";\n      case \"boy_girl\":\n        return \"#87CEEB\";\n      case \"bad_boy_girl\":\n        return \"#FFA500\";\n      case \"little_shit\":\n        return \"#FF6347\";\n      default:\n        return \"#FFFFFF\";\n    }\n  };\n\n  return (\n    <group position={[0, 2.2, 0]}>\n      <mesh>\n        <planeGeometry args={[1.5, 0.4]} />\n        <meshBasicMaterial\n          color={getAlignmentColor(alignment)}\n          transparent\n          opacity={0.9}\n        />\n      </mesh>\n    </group>\n  );\n}\n\nfunction NeedIndicators({ player }: { player: Player }) {\n  const { needs } = player;\n\n  return (\n    <group position={[0, 2.5, 0]}>\n      {needs.bladder > 80 && (\n        <mesh position={[-0.3, 0, 0]}>\n          <sphereGeometry args={[0.08]} />\n          <meshBasicMaterial color=\"#FFD700\" />\n        </mesh>\n      )}\n\n      {needs.bowel > 80 && (\n        <mesh position={[0, 0, 0]}>\n          <sphereGeometry args={[0.08]} />\n          <meshBasicMaterial color=\"#8B4513\" />\n        </mesh>\n      )}\n\n      {needs.hunger > 80 && (\n        <mesh position={[0.3, 0, 0]}>\n          <sphereGeometry args={[0.08]} />\n          <meshBasicMaterial color=\"#FF6347\" />\n        </mesh>\n      )}\n    </group>\n  );\n}\n\nfunction EmotionIndicators({\n  emotions,\n}: {\n  emotions: {\n    happiness: number;\n    sadness: number;\n    anger: number;\n    surprise: number;\n  };\n}) {\n  const indicators: ReactNode[] = [];\n\n  if (emotions.happiness > 0.7) {\n    indicators.push(\n      <mesh key=\"happy\" position={[-0.4, 0.3, 0]}>\n        <sphereGeometry args={[0.06]} />\n        <meshBasicMaterial color=\"#FFD700\" />\n      </mesh>\n    );\n  }\n\n  if (emotions.sadness > 0.5) {\n    indicators.push(\n      <mesh key=\"sad\" position={[-0.2, 0.3, 0]}>\n        <sphereGeometry args={[0.06]} />\n        <meshBasicMaterial color=\"#87CEEB\" />\n      </mesh>\n    );\n  }\n\n  if (emotions.anger > 0.5) {\n    indicators.push(\n      <mesh key=\"angry\" position={[0, 0.3, 0]}>\n        <sphereGeometry args={[0.06]} />\n        <meshBasicMaterial color=\"#FF6347\" />\n      </mesh>\n    );\n  }\n\n  if (emotions.surprise > 0.5) {\n    indicators.push(\n      <mesh key=\"surprised\" position={[0.2, 0.3, 0]}>\n        <sphereGeometry args={[0.06]} />\n        <meshBasicMaterial color=\"#DDA0DD\" />\n      </mesh>\n    );\n  }\n\n  return indicators.length ? (\n    <group position={[0, 2.8, 0]}>{indicators}</group>\n  ) : null;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4954, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/PlayerCharacters.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { PlayerController } from \"./PlayerController\"\nimport { KeyboardControls } from \"@react-three/drei\"\nimport { useShallow } from \"zustand/react/shallow\"\n\n// Keyboard controls configuration\nconst keyboardMap = [\n  { name: \"forward\", keys: [\"ArrowUp\", \"KeyW\"] },\n  { name: \"backward\", keys: [\"ArrowDown\", \"KeyS\"] },\n  { name: \"leftward\", keys: [\"ArrowLeft\", \"KeyA\"] },\n  { name: \"rightward\", keys: [\"ArrowRight\", \"KeyD\"] },\n  { name: \"jump\", keys: [\"Space\"] },\n  { name: \"run\", keys: [\"Shift\"] },\n  { name: \"pee\", keys: [\"KeyP\"] },\n  { name: \"poop\", keys: [\"RightShift\", \"KeyP\"] },\n  { name: \"cry\", keys: [\"KeyC\"] },\n  { name: \"grab\", keys: [\"KeyQ\"] },\n  { name: \"crawl\", keys: [\"KeyE\"] },\n];\n\nexport function PlayerCharacters() {\n    const players = useGameStore(\n    useShallow((s) => Array.from(s.players.values()))\n  )\n  const currentPlayerId = useGameStore((s) => s.currentPlayerId)\n\n  return (\n    <KeyboardControls map={keyboardMap}>\n      {players.map((player) => (\n        <PlayerController\n          key={player.id}\n          player={player}\n          isLocalPlayer={player.id === currentPlayerId}\n        />\n      ))}\n    </KeyboardControls>\n  )\n}"],"names":[],"mappings":";;;;;AAGA;AACA;AACA;AACA;;;AANA;;;;;AAQA,kCAAkC;AAClC,MAAM,cAAc;IAClB;QAAE,MAAM;QAAW,MAAM;YAAC;YAAW;SAAO;IAAC;IAC7C;QAAE,MAAM;QAAY,MAAM;YAAC;YAAa;SAAO;IAAC;IAChD;QAAE,MAAM;QAAY,MAAM;YAAC;YAAa;SAAO;IAAC;IAChD;QAAE,MAAM;QAAa,MAAM;YAAC;YAAc;SAAO;IAAC;IAClD;QAAE,MAAM;QAAQ,MAAM;YAAC;SAAQ;IAAC;IAChC;QAAE,MAAM;QAAO,MAAM;YAAC;SAAQ;IAAC;IAC/B;QAAE,MAAM;QAAO,MAAM;YAAC;SAAO;IAAC;IAC9B;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAc;SAAO;IAAC;IAC7C;QAAE,MAAM;QAAO,MAAM;YAAC;SAAO;IAAC;IAC9B;QAAE,MAAM;QAAQ,MAAM;YAAC;SAAO;IAAC;IAC/B;QAAE,MAAM;QAAS,MAAM;YAAC;SAAO;IAAC;CACjC;AAEM,SAAS;;IACZ,MAAM,UAAU,IAAA,6IAAY,EAC5B,IAAA,oKAAU;kDAAC,CAAC,IAAM,MAAM,IAAI,CAAC,EAAE,OAAO,CAAC,MAAM;;IAE/C,MAAM,kBAAkB,IAAA,6IAAY;0DAAC,CAAC,IAAM,EAAE,eAAe;;IAE7D,qBACE,6LAAC,0LAAgB;QAAC,KAAK;kBACpB,QAAQ,GAAG,CAAC,CAAC,uBACZ,6LAAC,+JAAgB;gBAEf,QAAQ;gBACR,eAAe,OAAO,EAAE,KAAK;eAFxB,OAAO,EAAE;;;;;;;;;;AAOxB;GAjBgB;;QACI,6IAAY;QAGN,6IAAY;;;KAJtB"}},
    {"offset": {"line": 5084, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/services/PathfindingService.ts"],"sourcesContent":["import type { Vector3, InteractiveObject } from \"../types/gameTypes\"\n\n/**\n * PathfindingService - Advanced Navigation for AI Caregivers\n * Provides sophisticated pathfinding using A* algorithm with dynamic obstacle avoidance\n * Optimized for the daycare environment with special consideration for child safety\n */\nexport class PathfindingService {\n  private grid: boolean[][]\n  private gridWidth: number\n  private gridHeight: number\n  private cellSize: number\n  private obstacles: Set<string> = new Set()\n  private dynamicObstacles: Map<string, { position: Vector3; radius: number; expiresAt?: number }> = new Map()\n\n  constructor(gridWidth = 40, gridHeight = 40, cellSize = 2) {\n    this.gridWidth = gridWidth\n    this.gridHeight = gridHeight\n    this.cellSize = cellSize\n    this.grid = this.createGrid()\n  }\n\n  /**\n   * Create the initial grid for the daycare environment\n   */\n  private createGrid(): boolean[][] {\n    const grid: boolean[][] = []\n\n    for (let x = 0; x < this.gridWidth; x++) {\n      grid[x] = []\n      for (let y = 0; y < this.gridHeight; y++) {\n        // Mark boundaries as blocked\n        if (x === 0 || x === this.gridWidth - 1 || y === 0 || y === this.gridHeight - 1) {\n          grid[x][y] = false // Blocked\n        } else {\n          grid[x][y] = true // Walkable\n        }\n      }\n    }\n\n    // Add static obstacles (walls, furniture)\n    this.addStaticObstacles(grid)\n\n    return grid\n  }\n\n  /**\n   * Add static obstacles for the daycare environment\n   */\n  private addStaticObstacles(grid: boolean[][]): void {\n    // Interior walls (simplified daycare layout)\n    this.addRectangularObstacle(grid, 15, 15, 10, 1, \"interior_wall_1\")\n    this.addRectangularObstacle(grid, 25, 20, 1, 8, \"interior_wall_2\")\n    this.addRectangularObstacle(grid, 5, 25, 15, 1, \"interior_wall_3\")\n\n    // Furniture areas\n    this.addRectangularObstacle(grid, 8, 8, 3, 3, \"toy_storage\")\n    this.addRectangularObstacle(grid, 30, 12, 4, 2, \"bookshelf\")\n    this.addRectangularObstacle(grid, 12, 30, 6, 3, \"changing_area\")\n\n    // Kitchen/Bathroom areas (blocked for safety)\n    this.addRectangularObstacle(grid, 2, 2, 6, 4, \"kitchen_area\")\n    this.addRectangularObstacle(grid, 32, 32, 6, 6, \"bathroom_area\")\n\n    // Play equipment (circular obstacles)\n    this.addCircularObstacle(grid, 20, 10, 2, \"slide\")\n    this.addCircularObstacle(grid, 15, 25, 2.5, \"climbing_structure\")\n    this.addCircularObstacle(grid, 28, 18, 1.5, \"toy_chest\")\n  }\n\n  /**\n   * Add a rectangular obstacle to the grid\n   */\n  private addRectangularObstacle(\n    grid: boolean[][],\n    startX: number,\n    startY: number,\n    width: number,\n    height: number,\n    id: string,\n  ): void {\n    for (let x = startX; x < startX + width && x < this.gridWidth; x++) {\n      for (let y = startY; y < startY + height && y < this.gridHeight; y++) {\n        if (x >= 0 && y >= 0) {\n          grid[x][y] = false // Blocked\n        }\n      }\n    }\n    this.obstacles.add(id)\n  }\n\n  /**\n   * Add a circular obstacle to the grid\n   */\n  private addCircularObstacle(grid: boolean[][], centerX: number, centerY: number, radius: number, id: string): void {\n    const radiusSquared = radius * radius\n\n    // Calculate integer bounds for the loop to avoid floating-point array indices\n    const startX = Math.max(0, Math.floor(centerX - radius))\n    const endX = Math.min(this.gridWidth, Math.ceil(centerX + radius))\n    const startY = Math.max(0, Math.floor(centerY - radius))\n    const endY = Math.min(this.gridHeight, Math.ceil(centerY + radius))\n\n    for (let x = startX; x < endX; x++) {\n      for (let y = startY; y < endY; y++) {\n        // Additional bounds check to prevent undefined access\n        if (x >= 0 && x < this.gridWidth && y >= 0 && y < this.gridHeight) {\n          const distanceSquared = (x - centerX) * (x - centerX) + (y - centerY) * (y - centerY)\n          if (distanceSquared <= radiusSquared) {\n            grid[x][y] = false // Blocked\n          }\n        }\n      }\n    }\n    this.obstacles.add(id)\n  }\n\n  /**\n   * Add dynamic obstacle (other players, temporary objects)\n   */\n  addDynamicObstacle(id: string, position: Vector3, radius: number, durationMs?: number): void {\n    const expiresAt = durationMs ? Date.now() + durationMs : undefined\n    this.dynamicObstacles.set(id, { position, radius, expiresAt })\n\n    // Clean up expired obstacles periodically\n    if (expiresAt) {\n      setTimeout(() => {\n        this.dynamicObstacles.delete(id)\n      }, durationMs)\n    }\n  }\n\n  /**\n   * Remove dynamic obstacle\n   */\n  removeDynamicObstacle(id: string): void {\n    this.dynamicObstacles.delete(id)\n  }\n\n  /**\n   * Find path using A* algorithm\n   */\n  findPath(start: Vector3, end: Vector3, avoidDynamicObstacles = true): Vector3[] {\n    const startNode = this.worldToGrid(start)\n    const endNode = this.worldToGrid(end)\n\n    // Validate start and end positions\n    if (!this.isValidPosition(startNode.x, startNode.y) || !this.isValidPosition(endNode.x, endNode.y)) {\n      console.warn(\"Invalid start or end position for pathfinding\")\n      return []\n    }\n\n    // If start and end are the same\n    if (startNode.x === endNode.x && startNode.y === endNode.y) {\n      return [start]\n    }\n\n    const openSet: Array<{ x: number; y: number; g: number; h: number; f: number; parent?: { x: number; y: number } }> =\n      []\n    const closedSet: Set<string> = new Set()\n    const cameFrom: Map<string, { x: number; y: number }> = new Map()\n\n    // Add start node to open set\n    const startKey = `${startNode.x},${startNode.y}`\n    const hStart = this.heuristic(startNode, endNode)\n    openSet.push({ x: startNode.x, y: startNode.y, g: 0, h: hStart, f: hStart })\n\n    while (openSet.length > 0) {\n      // Find node with lowest f score\n      let currentIndex = 0\n      for (let i = 1; i < openSet.length; i++) {\n        if (openSet[i].f < openSet[currentIndex].f) {\n          currentIndex = i\n        }\n      }\n      const current = openSet.splice(currentIndex, 1)[0]\n      const currentKey = `${current.x},${current.y}`\n\n      // Add to closed set\n      closedSet.add(currentKey)\n\n      // Check if we reached the goal\n      if (current.x === endNode.x && current.y === endNode.y) {\n        return this.reconstructPath(cameFrom, current, start, end)\n      }\n\n      // Check neighbors\n      const neighbors = this.getNeighbors(current.x, current.y, avoidDynamicObstacles)\n      for (const neighbor of neighbors) {\n        const neighborKey = `${neighbor.x},${neighbor.y}`\n\n        if (closedSet.has(neighborKey)) {\n          continue\n        }\n\n        const tentativeG = current.g + this.getMovementCost(current, neighbor)\n\n        // Check if this path to neighbor is better\n        const existingNodeIndex = openSet.findIndex((node) => node.x === neighbor.x && node.y === neighbor.y)\n\n        if (existingNodeIndex === -1) {\n          // New node\n          const g = tentativeG\n          const h = this.heuristic(neighbor, endNode)\n          const f = g + h\n\n          openSet.push({ x: neighbor.x, y: neighbor.y, g, h, f, parent: { x: current.x, y: current.y } })\n          cameFrom.set(neighborKey, { x: current.x, y: current.y })\n        } else if (tentativeG < openSet[existingNodeIndex].g) {\n          // Better path found\n          openSet[existingNodeIndex].g = tentativeG\n          openSet[existingNodeIndex].f = tentativeG + openSet[existingNodeIndex].h\n          openSet[existingNodeIndex].parent = { x: current.x, y: current.y }\n          cameFrom.set(neighborKey, { x: current.x, y: current.y })\n        }\n      }\n    }\n\n    // No path found\n    console.warn(\"No path found from\", start, \"to\", end)\n    return []\n  }\n\n  /**\n   * Get walkable neighbors for a position\n   */\n  private getNeighbors(x: number, y: number, avoidDynamicObstacles: boolean): Array<{ x: number; y: number }> {\n    const neighbors: Array<{ x: number; y: number }> = []\n    const directions = [\n      { x: -1, y: -1 },\n      { x: 0, y: -1 },\n      { x: 1, y: -1 },\n      { x: -1, y: 0 },\n      { x: 1, y: 0 },\n      { x: -1, y: 1 },\n      { x: 0, y: 1 },\n      { x: 1, y: 1 },\n    ]\n\n    for (const dir of directions) {\n      const newX = x + dir.x\n      const newY = y + dir.y\n\n      if (this.isWalkable(newX, newY, avoidDynamicObstacles)) {\n        neighbors.push({ x: newX, y: newY })\n      }\n    }\n\n    return neighbors\n  }\n\n  /**\n   * Check if a position is walkable\n   */\n  private isWalkable(x: number, y: number, avoidDynamicObstacles: boolean): boolean {\n    // Check grid bounds\n    if (!this.isValidPosition(x, y)) {\n      return false\n    }\n\n    // Check static obstacles\n    if (!this.grid[x][y]) {\n      return false\n    }\n\n    // Check dynamic obstacles\n    if (avoidDynamicObstacles) {\n      const worldPos = this.gridToWorld({ x, y })\n      this.dynamicObstacles.forEach((obstacle, id) => {\n        if (obstacle.expiresAt && Date.now() > obstacle.expiresAt) {\n          return // Skip expired obstacles\n        }\n\n        const distance = this.calculateDistance(worldPos, obstacle.position)\n        if (distance < obstacle.radius + 0.5) {\n          // Add small buffer\n          return false\n        }\n      })\n    }\n\n    return true\n  }\n\n  /**\n   * Check if position is within grid bounds\n   */\n  private isValidPosition(x: number, y: number): boolean {\n    return x >= 0 && x < this.gridWidth && y >= 0 && y < this.gridHeight\n  }\n\n  /**\n   * Calculate heuristic (Manhattan distance for 4-directional, Euclidean for 8-directional)\n   */\n  private heuristic(a: { x: number; y: number }, b: { x: number; y: number }): number {\n    const dx = Math.abs(a.x - b.x)\n    const dy = Math.abs(a.y - b.y)\n    return Math.sqrt(dx * dx + dy * dy) // Euclidean distance\n  }\n\n  /**\n   * Calculate movement cost between two nodes\n   */\n  private getMovementCost(a: { x: number; y: number }, b: { x: number; y: number }): number {\n    const dx = Math.abs(a.x - b.x)\n    const dy = Math.abs(a.y - b.y)\n\n    // Diagonal movement costs more\n    if (dx === 1 && dy === 1) {\n      return Math.SQRT2 // ~1.414\n    }\n\n    return 1 // Straight movement\n  }\n\n  /**\n   * Reconstruct path from cameFrom map\n   */\n  private reconstructPath(\n    cameFrom: Map<string, { x: number; y: number }>,\n    current: { x: number; y: number },\n    startWorld: Vector3,\n    endWorld: Vector3,\n  ): Vector3[] {\n    const path: Vector3[] = []\n\n    // Add end position\n    path.unshift(endWorld)\n\n    // Work backwards from current node\n    let currentKey = `${current.x},${current.y}`\n    while (cameFrom.has(currentKey)) {\n      const parent = cameFrom.get(currentKey)!\n      const parentWorld = this.gridToWorld(parent)\n      path.unshift(parentWorld)\n      currentKey = `${parent.x},${parent.y}`\n    }\n\n    // Add start position\n    path.unshift(startWorld)\n\n    return path\n  }\n\n  /**\n   * Convert world coordinates to grid coordinates\n   */\n  private worldToGrid(position: Vector3): { x: number; y: number } {\n    return {\n      x: Math.floor((position.x + (this.gridWidth * this.cellSize) / 2) / this.cellSize),\n      y: Math.floor((position.z + (this.gridHeight * this.cellSize) / 2) / this.cellSize),\n    }\n  }\n\n  /**\n   * Convert grid coordinates to world coordinates\n   */\n  private gridToWorld(gridPos: { x: number; y: number }): Vector3 {\n    return {\n      x: gridPos.x * this.cellSize - (this.gridWidth * this.cellSize) / 2,\n      y: 0,\n      z: gridPos.y * this.cellSize - (this.gridHeight * this.cellSize) / 2,\n    }\n  }\n\n  /**\n   * Calculate distance between two world positions\n   */\n  private calculateDistance(p1: Vector3, p2: Vector3): number {\n    const dx = p1.x - p2.x\n    const dz = p1.z - p2.z\n    return Math.sqrt(dx * dx + dz * dz)\n  }\n\n  /**\n   * Find nearest walkable position to a given point\n   */\n  findNearestWalkable(position: Vector3, maxSearchRadius = 5): Vector3 | null {\n    const startGrid = this.worldToGrid(position)\n    const searchRadius = Math.ceil(maxSearchRadius / this.cellSize)\n\n    // Check center first\n    if (this.isWalkable(startGrid.x, startGrid.y, true)) {\n      return position\n    }\n\n    // Spiral search outward\n    for (let radius = 1; radius <= searchRadius; radius++) {\n      for (let x = startGrid.x - radius; x <= startGrid.x + radius; x++) {\n        for (let y = startGrid.y - radius; y <= startGrid.y + radius; y++) {\n          // Only check the perimeter of the current radius\n          if (Math.abs(x - startGrid.x) === radius || Math.abs(y - startGrid.y) === radius) {\n            if (this.isWalkable(x, y, true)) {\n              return this.gridToWorld({ x, y })\n            }\n          }\n        }\n      }\n    }\n\n    return null // No walkable position found within radius\n  }\n\n  /**\n   * Update grid with interactive objects\n   */\n  updateWithObjects(objects: InteractiveObject[]): void {\n    // Clear existing dynamic obstacles from objects\n    const objectKeysToRemove: string[] = []\n    this.dynamicObstacles.forEach((obstacle, id) => {\n      if (id.startsWith(\"object_\")) {\n        objectKeysToRemove.push(id)\n      }\n    })\n\n    objectKeysToRemove.forEach((id) => {\n      this.dynamicObstacles.delete(id)\n    })\n\n    // Add current objects as obstacles\n    for (const obj of objects) {\n      if (obj.isOccupied) {\n        this.addDynamicObstacle(`object_${obj.id}`, obj.position, 1.5)\n      }\n    }\n  }\n\n  /**\n   * Get pathfinding debug info\n   */\n  getDebugInfo(): {\n    gridSize: { width: number; height: number }\n    staticObstacles: string[]\n    dynamicObstacles: number\n    cellSize: number\n  } {\n    return {\n      gridSize: { width: this.gridWidth, height: this.gridHeight },\n      staticObstacles: Array.from(this.obstacles),\n      dynamicObstacles: this.dynamicObstacles.size,\n      cellSize: this.cellSize,\n    }\n  }\n\n  /**\n   * Smooth path using line-of-sight checks\n   */\n  smoothPath(path: Vector3[]): Vector3[] {\n    if (path.length <= 2) {\n      return path\n    }\n\n    const smoothedPath: Vector3[] = [path[0]]\n    let currentIndex = 0\n\n    while (currentIndex < path.length - 1) {\n      let farthestReachable = currentIndex + 1\n\n      // Find the farthest point we can reach in a straight line\n      for (let i = currentIndex + 2; i < path.length; i++) {\n        if (this.hasLineOfSight(path[currentIndex], path[i])) {\n          farthestReachable = i\n        } else {\n          break\n        }\n      }\n\n      smoothedPath.push(path[farthestReachable])\n      currentIndex = farthestReachable\n    }\n\n    return smoothedPath\n  }\n\n  /**\n   * Check if there's a line of sight between two points\n   */\n  private hasLineOfSight(start: Vector3, end: Vector3): boolean {\n    const steps = Math.ceil(this.calculateDistance(start, end) / (this.cellSize / 2))\n\n    for (let i = 1; i < steps; i++) {\n      const t = i / steps\n      const point = {\n        x: start.x + (end.x - start.x) * t,\n        y: 0,\n        z: start.z + (end.z - start.z) * t,\n      }\n\n      const gridPos = this.worldToGrid(point)\n      if (!this.isWalkable(gridPos.x, gridPos.y, true)) {\n        return false\n      }\n    }\n\n    return true\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5548, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/services/BrainService.ts"],"sourcesContent":["import type {\n  Caregiver,\n  Player,\n  Lobby,\n  AuthorityDecision,\n  BehaviorEvent,\n  Vector3,\n  EntityRef,\n  SoundEvent,\n  Accident,\n  ChatMessage,\n} from \"@shared/gameTypes\"\nimport { nanoid } from \"nanoid\"\n\n/**\n * Enhanced BrainService - AI Caregiver Decision Making and Behavior System\n * This service provides sophisticated rule-based decision making without external AI dependencies\n * Focuses on deterministic, game-appropriate behaviors for the daycare environment\n */\nexport class BrainService {\n  private caregiver: Caregiver\n  private lobby: Lobby\n  private decisionInterval: number\n  private perceptionRadius: number\n  private lastDecisionTime = 0\n  private behaviorMemory: Map<string, BehaviorEvent[]> = new Map()\n  private interactionCooldowns: Map<string, number> = new Map()\n\n  constructor(\n    caregiver: Caregiver,\n    lobby: Lobby,\n    config: {\n      decisionInterval?: number\n      perceptionRadius?: number\n    } = {},\n  ) {\n    this.caregiver = caregiver\n    this.lobby = lobby\n    this.decisionInterval = config.decisionInterval || 2000 // Default 2 seconds\n    this.perceptionRadius = config.perceptionRadius || 15 // Default 15 units\n  }\n\n  /**\n   * Update the caregiver reference\n   */\n  updateCaregiver(caregiver: Caregiver): void {\n    this.caregiver = caregiver\n  }\n\n  /**\n   * Update the lobby reference\n   */\n  updateLobby(lobby: Lobby): void {\n    this.lobby = lobby\n  }\n\n  /**\n   * Main decision-making loop with enhanced logic\n   */\n  async makeDecision(): Promise<AuthorityDecision | null> {\n    const now = Date.now()\n    if (now - this.lastDecisionTime < this.decisionInterval) {\n      return null\n    }\n    this.lastDecisionTime = now\n\n    // Update perception first\n    this.updatePerception()\n\n    try {\n      // Enhanced decision making with multiple priority levels\n      return this.makeEnhancedDecision()\n    } catch (error) {\n      console.error(\"BrainService decision error:\", error)\n      return null\n    }\n  }\n\n  /**\n   * Enhanced decision making with sophisticated prioritization\n   */\n  private makeEnhancedDecision(): AuthorityDecision | null {\n    // Priority 1: Immediate safety concerns\n    const safetyDecision = this.assessSafetyConcerns()\n    if (safetyDecision) return safetyDecision\n\n    // Priority 2: Critical needs (diaper, bathroom)\n    const needsDecision = this.assessCriticalNeeds()\n    if (needsDecision) return needsDecision\n\n    // Priority 3: Behavioral interventions\n    const behaviorDecision = this.assessBehavioralIssues()\n    if (behaviorDecision) return behaviorDecision\n\n    // Priority 4: Environment maintenance\n    const maintenanceDecision = this.assessEnvironmentMaintenance()\n    if (maintenanceDecision) return maintenanceDecision\n\n    // Priority 5: Positive engagement\n    const engagementDecision = this.assessPositiveEngagement()\n    if (engagementDecision) return engagementDecision\n\n    return null\n  }\n\n  /**\n   * Assess immediate safety concerns\n   */\n  private assessSafetyConcerns(): AuthorityDecision | null {\n    // Check for accidents that pose safety risks\n    const dangerousAccidents = Array.from(this.lobby.accidents.values()).filter(\n      (accident) => !accident.cleanedUp && accident.size > 70,\n    )\n\n    if (dangerousAccidents.length > 0) {\n      const nearestAccident = this.findNearestAccident(dangerousAccidents)\n      return this.createCleaningDecision(nearestAccident, \"dangerous_accident\")\n    }\n\n    // Check for players in dangerous situations\n    const endangeredPlayers = this.identifyEndangeredPlayers()\n    if (endangeredPlayers.length > 0) {\n      const nearestEndangered = this.findNearestPlayer(endangeredPlayers)\n      return this.createInterventionDecision(nearestEndangered, \"safety_rescue\", {\n        type: \"escort\",\n        authorityId: this.caregiver.id,\n        targetId: nearestEndangered.id,\n        destinationId: this.findSafeLocation(nearestEndangered.position),\n        canResist: false,\n        reason: \"safety_concern\",\n      })\n    }\n\n    return null\n  }\n\n  /**\n   * Assess critical player needs\n   */\n  private assessCriticalNeeds(): AuthorityDecision | null {\n    const players = Array.from(this.lobby.players.values())\n\n    // Check for diaper emergencies\n    for (const player of players) {\n      if (this.isDiaperEmergency(player)) {\n        return this.createDiaperChangeDecision(player, \"emergency_diaper_change\")\n      }\n    }\n\n    // Check for bathroom emergencies\n    for (const player of players) {\n      if (this.isBathroomEmergency(player)) {\n        return this.createEscortDecision(player, \"bathroom_emergency\", \"toilet_female\")\n      }\n    }\n\n    // Check for players showing distress signals\n    const distressedPlayers = this.identifyDistressedPlayers()\n    if (distressedPlayers.length > 0) {\n      const nearestDistressed = this.findNearestPlayer(distressedPlayers)\n      return this.createComfortDecision(nearestDistressed, \"distress_comfort\")\n    }\n\n    return null\n  }\n\n  /**\n   * Assess behavioral issues requiring intervention\n   */\n  private assessBehavioralIssues(): AuthorityDecision | null {\n    const players = Array.from(this.lobby.players.values())\n\n    // Check for repeat offenders\n    const repeatOffenders = players.filter((player) => this.isRepeatOffender(player))\n    if (repeatOffenders.length > 0) {\n      const worstOffender = this.findWorstOffender(repeatOffenders)\n      return this.createDisciplinaryDecision(worstOffender, \"repeat_offender\")\n    }\n\n    // Check for current rule violations\n    const ruleViolators = players.filter((player) => this.isCurrentlyViolatingRules(player))\n    if (ruleViolators.length > 0) {\n      const worstViolator = this.findWorstViolator(ruleViolators)\n      return this.createDisciplinaryDecision(worstViolator, \"active_rule_violation\")\n    }\n\n    // Check for timeout completions\n    const timeoutCompleters = players.filter(\n      (player) => player.isInTimeout && player.timeoutEndTime && Date.now() > player.timeoutEndTime,\n    )\n\n    if (timeoutCompleters.length > 0) {\n      const completer = this.findNearestPlayer(timeoutCompleters)\n      return this.createReleaseDecision(completer, \"timeout_completed\")\n    }\n\n    return null\n  }\n\n  /**\n   * Assess environment maintenance needs\n   */\n  private assessEnvironmentMaintenance(): AuthorityDecision | null {\n    // Clean up routine accidents\n    const routineAccidents = Array.from(this.lobby.accidents.values()).filter(\n      (accident) => !accident.cleanedUp && accident.size <= 70,\n    )\n\n    if (routineAccidents.length > 0) {\n      const oldestAccident = routineAccidents.reduce((oldest, current) =>\n        current.timestamp < oldest.timestamp ? current : oldest,\n      )\n      return this.createCleaningDecision(oldestAccident, \"routine_cleanup\")\n    }\n\n    // Check and restock supplies if needed\n    const supplyCheck = this.checkSupplyLevels()\n    if (supplyCheck.needsRestock) {\n      return this.createSupplyRestockDecision(supplyCheck.location, \"supply_maintenance\")\n    }\n\n    return null\n  }\n\n  /**\n   * Assess opportunities for positive engagement\n   */\n  private assessPositiveEngagement(): AuthorityDecision | null {\n    const now = Date.now()\n\n    // Avoid spamming positive interactions\n    if (this.interactionCooldowns.has(\"positive_engagement\")) {\n      const lastEngagement = this.interactionCooldowns.get(\"positive_engagement\")!\n      if (now - lastEngagement < 30000) {\n        // 30 second cooldown\n        return null\n      }\n    }\n\n    const wellBehavedPlayers = this.identifyWellBehavedPlayers()\n    if (wellBehavedPlayers.length > 0) {\n      const exemplaryPlayer = this.findExemplaryPlayer(wellBehavedPlayers)\n      this.interactionCooldowns.set(\"positive_engagement\", now)\n      return this.createRewardDecision(exemplaryPlayer, \"positive_recognition\")\n    }\n\n    return null\n  }\n\n  /**\n   * Update caregiver perception based on current lobby state\n   */\n  updatePerception(): void {\n    const visibleEntities: EntityRef[] = []\n    const distances = new Map<string, number>()\n    const audioEvents: SoundEvent[] = []\n\n    // Scan players\n    this.lobby.players.forEach((player) => {\n      const dist = this.calculateDistance(this.caregiver.position, player.position)\n      if (dist <= this.perceptionRadius) {\n        visibleEntities.push({\n          id: player.id,\n          type: \"player\",\n          position: player.position,\n        })\n        distances.set(player.id, dist)\n\n        // Add audio events for players who are talking\n        if (player.lastVoiceActivity && Date.now() - player.lastVoiceActivity < 5000) {\n          audioEvents.push({\n            id: `audio_${player.id}_${Date.now()}`,\n            type: \"voice\",\n            source: player.id,\n            position: player.position,\n            intensity: Math.max(0.1, 1 - dist / this.perceptionRadius),\n            timestamp: Date.now(),\n          })\n        }\n      }\n    })\n\n    // Scan accidents\n    this.lobby.accidents.forEach((accident) => {\n      const dist = this.calculateDistance(this.caregiver.position, accident.position)\n      if (dist <= this.perceptionRadius) {\n        visibleEntities.push({\n          id: accident.id,\n          type: \"accident\",\n          position: accident.position,\n        })\n        distances.set(accident.id, dist)\n      }\n    })\n\n    // Scan objects\n    this.lobby.objects.forEach((obj) => {\n      const dist = this.calculateDistance(this.caregiver.position, obj.position)\n      if (dist <= this.perceptionRadius) {\n        visibleEntities.push({\n          id: obj.id,\n          type: \"object\",\n          position: obj.position,\n        })\n        distances.set(obj.id, dist)\n      }\n    })\n\n    // Update perception\n    this.caregiver.perception = {\n      visibleEntities,\n      distances,\n      occluded: false,\n      audioEvents,\n    }\n  }\n\n  /**\n   * Process chat messages and generate contextual responses\n   */\n  async processChatMessage(message: ChatMessage): Promise<{ response: string; audio: ArrayBuffer } | null> {\n    if (message.senderId === this.caregiver.id) {\n      return null // Don't respond to self\n    }\n\n    const player = this.lobby.players.get(message.senderId)\n    if (!player) {\n      return null\n    }\n\n    try {\n      const responseText = this.generateContextualResponse(message, player)\n\n      // Add to behavior memory for future decisions\n      this.addToBehaviorMemory(player.id, {\n        id: `chat_${Date.now()}`,\n        actorId: player.id,\n        category: \"rule_violation\", // Neutral category\n        severity: 1,\n        timestamp: Date.now(),\n        description: `Said: \"${message.content}\"`,\n      })\n\n      return { response: responseText, audio: new ArrayBuffer(0) }\n    } catch (error) {\n      console.error(\"Failed to process chat message:\", error)\n      return null\n    }\n  }\n\n  /**\n   * Generate appropriate speech for decisions\n   */\n  async generateSpeechForDecision(decision: AuthorityDecision): Promise<{ text: string; audio: ArrayBuffer }> {\n    const speechText = this.generateDecisionSpeech(decision)\n    return { text: speechText, audio: new ArrayBuffer(0) }\n  }\n\n  /**\n   * Update caregiver intent based on current decision\n   */\n  updateIntent(decision: AuthorityDecision | null): void {\n    if (!decision) {\n      return\n    }\n\n    const goals: any[] = []\n\n    // Add goal based on decision type\n    if (decision.reasoning.includes(\"diaper\")) {\n      goals.push({\n        id: `goal_${nanoid()}`,\n        priority: 1,\n        description: \"Change player diaper\",\n        targetId: decision.targetId,\n      })\n    } else if (decision.reasoning.includes(\"accident\") || decision.reasoning.includes(\"cleanup\")) {\n      goals.push({\n        id: `goal_${nanoid()}`,\n        priority: 1,\n        description: \"Clean up mess\",\n        targetId: decision.targetId,\n      })\n    } else if (decision.reasoning.includes(\"safety\")) {\n      goals.push({\n        id: `goal_${nanoid()}`,\n        priority: 1,\n        description: \"Ensure player safety\",\n        targetId: decision.targetId,\n      })\n    }\n\n    // Update caregiver intent\n    this.caregiver.currentIntent = {\n      goals,\n      constraints: [],\n      cooldowns: new Map(),\n    }\n  }\n\n  // ============ Helper Methods ============\n\n  private calculateDistance(p1: Vector3, p2: Vector3): number {\n    const dx = p1.x - p2.x\n    const dy = p1.y - p2.y\n    const dz = p1.z - p2.z\n    return Math.sqrt(dx * dx + dy * dy + dz * dz)\n  }\n\n  private findNearestAccident(accidents: Accident[]): Accident {\n    return accidents.reduce((nearest, current) => {\n      const currentDist = this.calculateDistance(this.caregiver.position, current.position)\n      const nearestDist = this.calculateDistance(this.caregiver.position, nearest.position)\n      return currentDist < nearestDist ? current : nearest\n    })\n  }\n\n  private findNearestPlayer(players: Player[]): Player {\n    return players.reduce((nearest, current) => {\n      const currentDist = this.calculateDistance(this.caregiver.position, current.position)\n      const nearestDist = this.calculateDistance(this.caregiver.position, nearest.position)\n      return currentDist < nearestDist ? current : nearest\n    })\n  }\n\n  private isDiaperEmergency(player: Player): boolean {\n    return (\n      player.clothing.underwearType === \"diaper\" &&\n      (player.clothing.diaperFillLevel >= 3 || player.clothing.underwearState === \"both\")\n    )\n  }\n\n  private isBathroomEmergency(player: Player): boolean {\n    return player.needs.bladder > 90 || player.needs.bowel > 90\n  }\n\n  private identifyDistressedPlayers(): Player[] {\n    return Array.from(this.lobby.players.values()).filter((player) => {\n      // Check for distress signals\n      const recentMessages = Array.from(this.lobby.players.values()).flatMap((p) => []) // Simplified for now\n\n      return player.disciplineStatus === \"red\" || player.alignment === \"little_shit\" || player.needs.bladder > 80\n    })\n  }\n\n  private isRepeatOffender(player: Player): boolean {\n    const memory = this.behaviorMemory.get(player.id) || []\n    const recentBehaviors = memory.filter(\n      (behavior) => Date.now() - behavior.timestamp < 300000, // Last 5 minutes\n    )\n    return recentBehaviors.length > 2\n  }\n\n  private findWorstOffender(players: Player[]): Player {\n    return players.reduce((worst, current) => {\n      const worstMemory = this.behaviorMemory.get(worst.id) || []\n      const currentMemory = this.behaviorMemory.get(current.id) || []\n\n      const worstScore = worstMemory.length\n      const currentScore = currentMemory.length\n\n      return currentScore > worstScore ? current : worst\n    })\n  }\n\n  private identifyWellBehavedPlayers(): Player[] {\n    return Array.from(this.lobby.players.values()).filter(\n      (player) =>\n        player.alignment === \"little_angel\" ||\n        player.alignment === \"good_boy_girl\" ||\n        (player.disciplineStatus === \"green\" && player.punishments.length === 0),\n    )\n  }\n\n  private findExemplaryPlayer(players: Player[]): Player {\n    return players.reduce((exemplary, current) => {\n      const exemplaryRewards = exemplary.rewards.length\n      const currentRewards = current.rewards.length\n      return currentRewards > exemplaryRewards ? current : exemplary\n    })\n  }\n\n  private generateContextualResponse(message: ChatMessage, player: Player): string {\n    const content = message.content.toLowerCase()\n\n    // Emergency responses\n    if (content.includes(\"help\") || content.includes(\"emergency\")) {\n      return `${player.name}, I'm coming to help you right away!`\n    }\n\n    // Bathroom requests\n    if (content.includes(\"bathroom\") || content.includes(\"toilet\") || content.includes(\"potty\")) {\n      if (player.character.ageGroup === \"1-4\" || player.character.ageGroup === \"4-7\") {\n        return `Come with me, ${player.name}. I'll help you use the potty.`\n      } else {\n        return `You know where the bathroom is, ${player.name}. You may go now.`\n      }\n    }\n\n    // Diaper requests\n    if (content.includes(\"diaper\") || content.includes(\"change\")) {\n      if (this.isDiaperEmergency(player)) {\n        return `Yes, ${player.name}, your diaper definitely needs changing. Let's go to the changing station.`\n      } else {\n        return `Let me check your diaper, ${player.name}. We'll see if you need a change.`\n      }\n    }\n\n    // General inquiries\n    if (content.includes(\"what\") || content.includes(\"how\") || content.includes(\"why\")) {\n      return `That's a good question, ${player.name}. Let me think about that.`\n    }\n\n    // Positive interactions\n    if (content.includes(\"thank\") || content.includes(\"good job\") || content.includes(\"love you\")) {\n      return `Aww, thank you ${player.name}! You're such a sweet little.`\n    }\n\n    // Default responses\n    const responses = [\n      `I hear you, ${player.name}.`,\n      `That's interesting, ${player.name}.`,\n      `Tell me more about that, ${player.name}.`,\n      `I understand, ${player.name}.`,\n    ]\n\n    return responses[Math.floor(Math.random() * responses.length)]\n  }\n\n  private generateDecisionSpeech(decision: AuthorityDecision): string {\n    const targetPlayer = this.lobby.players.get(decision.targetId)\n    if (!targetPlayer) {\n      return \"I need to attend to something.\"\n    }\n\n    const playerName = targetPlayer.name\n    const reasoning = decision.reasoning.toLowerCase()\n\n    if (reasoning.includes(\"diaper\") || reasoning.includes(\"change\")) {\n      return `${playerName}, it's time for a diaper change. Let's go to the changing station.`\n    }\n\n    if (reasoning.includes(\"accident\") || reasoning.includes(\"cleanup\")) {\n      return `I need to clean up a mess. Please stay where you are, ${playerName}.`\n    }\n\n    if (reasoning.includes(\"safety\")) {\n      return `${playerName}, I need to make sure you're safe. Come with me.`\n    }\n\n    if (reasoning.includes(\"bathroom\")) {\n      return `${playerName}, let's go to the bathroom.`\n    }\n\n    if (reasoning.includes(\"discipline\") || reasoning.includes(\"timeout\")) {\n      return `${playerName}, you need some time to think about your behavior.`\n    }\n\n    if (reasoning.includes(\"reward\") || reasoning.includes(\"good\")) {\n      return `${playerName}, you're being such a good little!`\n    }\n\n    return `${playerName}, I need to talk to you.`\n  }\n\n  // ============ Decision Creation Helpers ============\n\n  private createCleaningDecision(accident: Accident, reason: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: accident.id,\n      triggeringEventId: `accident_${accident.id}`,\n      confidence: 1.0,\n      interventions: [\n        {\n          type: \"disciplinary_action\" as any,\n          targetId: accident.id,\n          effect: \"reputation_change\",\n          magnitude: 0,\n          reason: reason,\n        },\n      ],\n      reasoning: `Cleaning up ${accident.type} accident`,\n    }\n  }\n\n  private createDiaperChangeDecision(player: Player, reason: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `diaper_${player.id}`,\n      confidence: 0.95,\n      interventions: [\n        {\n          type: \"escort\",\n          authorityId: this.caregiver.id,\n          targetId: player.id,\n          destinationId: this.findNearestChangingStation(player.position),\n          canResist: false,\n          reason: reason,\n        },\n      ],\n      reasoning: `${player.name} needs an immediate diaper change`,\n    }\n  }\n\n  private createEscortDecision(player: Player, reason: string, destinationType: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `escort_${player.id}`,\n      confidence: 0.9,\n      interventions: [\n        {\n          type: \"escort\",\n          authorityId: this.caregiver.id,\n          targetId: player.id,\n          destinationId: this.findDestinationByType(destinationType),\n          canResist: false,\n          reason: reason,\n        },\n      ],\n      reasoning: `Escorting ${player.name} to ${destinationType}`,\n    }\n  }\n\n  private createComfortDecision(player: Player, reason: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `comfort_${player.id}`,\n      confidence: 0.8,\n      interventions: [\n        {\n          type: \"disciplinary_action\" as any,\n          targetId: player.id,\n          effect: \"morale_penalty\",\n          magnitude: -2,\n          reason: reason,\n        },\n      ],\n      reasoning: `Comforting ${player.name} who seems distressed`,\n    }\n  }\n\n  private createDisciplinaryDecision(player: Player, reason: string): AuthorityDecision {\n    const severity = this.calculateDisciplineSeverity(player)\n\n    let intervention: any\n    if (severity > 3) {\n      intervention = {\n        type: \"cooldown\" as const,\n        targetId: player.id,\n        durationMs: Math.min(severity * 60000, 300000), // Max 5 minutes\n        restrictedCapabilities: severity > 4 ? [\"movement\", \"interaction\"] : [\"interaction\"],\n        reason: reason,\n      }\n    } else {\n      intervention = {\n        type: \"disciplinary_action\" as const,\n        targetId: player.id,\n        effect: \"reputation_change\" as const,\n        magnitude: severity,\n        reason: reason,\n      }\n    }\n\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `discipline_${player.id}`,\n      confidence: 0.85,\n      interventions: [intervention],\n      reasoning: `${player.name} requires disciplinary action for ${reason}`,\n    }\n  }\n\n  private createRewardDecision(player: Player, reason: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `reward_${player.id}`,\n      confidence: 0.7,\n      interventions: [\n        {\n          type: \"disciplinary_action\" as any,\n          targetId: player.id,\n          effect: \"morale_penalty\",\n          magnitude: -1,\n          reason: reason,\n        },\n      ],\n      reasoning: `Rewarding ${player.name} for good behavior`,\n    }\n  }\n\n  private createReleaseDecision(player: Player, reason: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `release_${player.id}`,\n      confidence: 1.0,\n      interventions: [\n        {\n          type: \"disciplinary_action\" as any,\n          targetId: player.id,\n          effect: \"morale_penalty\",\n          magnitude: -1,\n          reason: reason,\n        },\n      ],\n      reasoning: `${player.name} timeout has ended`,\n    }\n  }\n\n  private createInterventionDecision(player: Player, reason: string, intervention: any): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: player.id,\n      triggeringEventId: `intervention_${player.id}`,\n      confidence: 0.9,\n      interventions: [intervention],\n      reasoning: `${player.name} requires intervention for ${reason}`,\n    }\n  }\n\n  private createSupplyRestockDecision(location: string, reason: string): AuthorityDecision {\n    return {\n      authorityId: this.caregiver.id,\n      targetId: \"supply_closet\",\n      triggeringEventId: `supply_${Date.now()}`,\n      confidence: 0.6,\n      interventions: [\n        {\n          type: \"disciplinary_action\" as any,\n          targetId: \"supply_closet\",\n          effect: \"reputation_change\",\n          magnitude: 0,\n          reason: reason,\n        },\n      ],\n      reasoning: \"Restocking supplies for daycare maintenance\",\n    }\n  }\n\n  private calculateDisciplineSeverity(player: Player): number {\n    let severity = 1\n\n    // Base severity on discipline status\n    switch (player.disciplineStatus) {\n      case \"red\":\n        severity += 3\n        break\n      case \"yellow\":\n        severity += 1\n        break\n    }\n\n    // Increase severity based on alignment\n    switch (player.alignment) {\n      case \"little_shit\":\n        severity += 2\n        break\n      case \"bad_boy_girl\":\n        severity += 1\n        break\n    }\n\n    // Increase severity based on recent punishment history\n    const recentPunishments = player.punishments.filter(\n      (p) => Date.now() - p.timestamp < 300000, // Last 5 minutes\n    )\n    severity += recentPunishments.length\n\n    return Math.min(severity, 5)\n  }\n\n  private findNearestChangingStation(position: Vector3): string {\n    const changingStations = Array.from(this.lobby.objects.values()).filter((obj) => obj.type === \"changing_station\")\n\n    if (changingStations.length === 0) return \"changing_station_1\"\n\n    const nearest = changingStations.reduce((closest, current) => {\n      const currentDist = this.calculateDistance(position, current.position)\n      const closestDist = this.calculateDistance(position, closest.position)\n      return currentDist < closestDist ? current : closest\n    })\n\n    return nearest.id\n  }\n\n  private findDestinationByType(type: string): string {\n    const destinations = Array.from(this.lobby.objects.values()).filter((obj) => obj.type === type)\n\n    if (destinations.length === 0) return \"default_destination\"\n\n    return destinations[0].id\n  }\n\n  private findSafeLocation(position: Vector3): string {\n    // Find nearest safe area (play area, timeout area, etc.)\n    const safeAreas = Array.from(this.lobby.objects.values()).filter((obj) =>\n      [\"play_area\", \"timeout_chair\", \"timeout_stool\"].includes(obj.type),\n    )\n\n    if (safeAreas.length === 0) return \"safe_zone\"\n\n    const nearest = safeAreas.reduce((closest, current) => {\n      const currentDist = this.calculateDistance(position, current.position)\n      const closestDist = this.calculateDistance(position, closest.position)\n      return currentDist < closestDist ? current : closest\n    })\n\n    return nearest.id\n  }\n\n  private identifyEndangeredPlayers(): Player[] {\n    // This would be more sophisticated in a real implementation\n    // For now, return players with critical needs\n    return Array.from(this.lobby.players.values()).filter(\n      (player) => player.needs.bladder > 95 || player.needs.bowel > 95,\n    )\n  }\n\n  private isCurrentlyViolatingRules(player: Player): boolean {\n    // Check for active rule violations\n    // This would be more sophisticated with actual rule checking\n    return player.disciplineStatus === \"red\"\n  }\n\n  private findWorstViolator(players: Player[]): Player {\n    return players.reduce((worst, current) => {\n      const worstSeverity = this.calculateDisciplineSeverity(worst)\n      const currentSeverity = this.calculateDisciplineSeverity(current)\n      return currentSeverity > worstSeverity ? current : worst\n    })\n  }\n\n  private checkSupplyLevels(): { needsRestock: boolean; location: string } {\n    // Simplified supply checking\n    return { needsRestock: false, location: \"supply_closet\" }\n  }\n\n  private addToBehaviorMemory(playerId: string, behavior: BehaviorEvent): void {\n    if (!this.behaviorMemory.has(playerId)) {\n      this.behaviorMemory.set(playerId, [])\n    }\n\n    const playerMemory = this.behaviorMemory.get(playerId)!\n    playerMemory.push(behavior)\n\n    // Keep only recent behaviors (last 10 minutes)\n    const cutoffTime = Date.now() - 600000\n    this.behaviorMemory.set(\n      playerId,\n      playerMemory.filter((b) => b.timestamp > cutoffTime),\n    )\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6261, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/CaregiverCharacters.tsx"],"sourcesContent":["\"use client\"\n\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { RigidBody } from \"@react-three/rapier\"\nimport { useRef, useEffect, useState, useMemo } from \"react\"\nimport type { Caregiver, Lobby, Vector3 as GameVector3 } from \"@/lib/types/gameTypes\"\nimport { PathfindingService } from \"@/lib/services/PathfindingService\"\nimport { BrainService } from \"@/lib/services/BrainService\"\nimport { useFrame } from \"@react-three/fiber\"\nimport { nanoid } from \"nanoid\"\nimport { CustomCharacterModel } from \"./models/CustomCharacterModel\"\nimport { CharacterAnimation } from \"./animations/CharacterAnimationSystem\"\n\nexport function CaregiverCharacters() {\n  const caregiversMap = useGameStore((state) => state.caregivers)\n  const caregiverIds = useMemo(\n    () => Array.from(caregiversMap.keys()),\n    [caregiversMap]\n  )\n\n  return (\n    <>\n      {caregiverIds.map((id) => {\n        const caregiver = caregiversMap.get(id)\n        return caregiver ? <CaregiverCharacter key={id} caregiverId={id} /> : null\n      })}\n    </>\n  )\n}\n\nfunction CaregiverCharacter({ caregiverId }: { caregiverId: string }) {\n  const rigidBodyRef = useRef<any>(null)\n  const caregiver = useGameStore((state) => state.caregivers.get(caregiverId))\n  const currentLobby = useGameStore((state) => state.currentLobby)\n  const playersMap = useGameStore((state) => state.players)\n  const objectsMap = useGameStore((state) => state.objects)\n  const accidentsMap = useGameStore((state) => state.accidents)\n  const addMessage = useGameStore((state) => state.addMessage)\n  const updateCaregiver = useGameStore((state) => state.updateCaregiver)\n\n  const pathfinding = useMemo(() => new PathfindingService(40, 40, 2), [])\n\n  const brain = useMemo(() => {\n    if (!currentLobby || !caregiver) return null\n\n    const lobby: Lobby = {\n      ...currentLobby,\n      players: playersMap,\n      caregivers: new Map([[caregiverId, caregiver]]),\n      objects: objectsMap,\n      accidents: accidentsMap,\n    }\n    return new BrainService(caregiver, lobby, {\n      decisionInterval: 2000,\n      perceptionRadius: 15,\n    })\n  }, [caregiverId, currentLobby, caregiver, playersMap, objectsMap, accidentsMap])\n\n  const [currentPath, setCurrentPath] = useState<GameVector3[]>([])\n  const [pathIndex, setPathIndex] = useState(0)\n  const [currentAnimation, setCurrentAnimation] = useState<CharacterAnimation>('idle')\n  const [emotions, setEmotions] = useState({\n    happiness: 0.5,\n    sadness: 0,\n    anger: 0,\n    surprise: 0\n  })\n  const lastDecisionRef = useRef<number>(0)\n\n  useEffect(() => {\n    if (!brain || !currentLobby || !caregiver) return\n\n    const lobby: Lobby = {\n      ...currentLobby,\n      players: playersMap,\n      caregivers: new Map([[caregiverId, caregiver]]),\n      objects: objectsMap,\n      accidents: accidentsMap,\n    }\n\n    brain.updateLobby(lobby)\n    brain.updateCaregiver(caregiver)\n  }, [playersMap, objectsMap, accidentsMap, caregiver])\n\n  useEffect(() => {\n    const objectsArray = Array.from(objectsMap.values())\n    pathfinding.updateWithObjects(objectsArray)\n  }, [objectsMap, pathfinding])\n\n  useFrame((state, delta) => {\n    if (!caregiver?.isAI || !brain || !rigidBodyRef.current) return\n\n    const now = Date.now()\n\n    if (now - lastDecisionRef.current > 2000) {\n      lastDecisionRef.current = now\n\n      brain.makeDecision().then((decision) => {\n        if (decision) {\n          console.log(\"[v0] AI Caregiver decision:\", decision)\n\n          handleCaregiverDecision(decision)\n\n          brain.generateSpeechForDecision(decision).then((speech) => {\n            addMessage({\n              id: `msg_${nanoid()}`,\n              senderId: caregiverId,\n              senderName: caregiver.name,\n              content: speech.text,\n              timestamp: Date.now(),\n              isSystem: false,\n              messageType: \"chat\",\n            })\n\n            updateCaregiver(caregiverId, {\n              lastVoiceActivity: Date.now(),\n            })\n          })\n\n          brain.updateIntent(decision)\n\n          if (decision.interventions.length > 0) {\n            const intervention = decision.interventions[0]\n            if (intervention.type === \"escort\") {\n              const targetPlayer = playersMap.get(decision.targetId)\n              if (targetPlayer) {\n                const path = pathfinding.findPath(caregiver.position, targetPlayer.position)\n                if (path.length > 0) {\n                  const smoothPath = pathfinding.smoothPath(path)\n                  setCurrentPath(smoothPath)\n                  setPathIndex(0)\n                }\n              }\n            }\n          }\n        }\n      })\n    }\n\n    if (currentPath.length > 0 && pathIndex < currentPath.length) {\n      const targetPos = currentPath[pathIndex]\n      const currentPos = rigidBodyRef.current.translation()\n\n      const distance = Math.sqrt(Math.pow(targetPos.x - currentPos.x, 2) + Math.pow(targetPos.z - currentPos.z, 2))\n\n      if (distance < 0.5) {\n        setPathIndex(pathIndex + 1)\n\n        if (pathIndex + 1 >= currentPath.length) {\n          setCurrentPath([])\n          setPathIndex(0)\n          setCurrentAnimation('idle')\n        }\n      } else {\n        const direction = {\n          x: targetPos.x - currentPos.x,\n          z: targetPos.z - currentPos.z,\n        }\n        const magnitude = Math.sqrt(direction.x * direction.x + direction.z * direction.z)\n        const normalized = {\n          x: direction.x / magnitude,\n          z: direction.z / magnitude,\n        }\n\n        const speed = 2.5\n        const newPos = {\n          x: currentPos.x + normalized.x * speed * delta,\n          y: currentPos.y,\n          z: currentPos.z + normalized.z * speed * delta,\n        }\n\n        rigidBodyRef.current.setNextKinematicTranslation(newPos)\n\n        const angle = Math.atan2(direction.x, direction.z)\n        rigidBodyRef.current.setNextKinematicRotation({\n          x: 0,\n          y: Math.sin(angle / 2),\n          z: 0,\n          w: Math.cos(angle / 2),\n        })\n\n        // Update animation based on movement\n        setCurrentAnimation('walk')\n\n        updateCaregiver(caregiverId, {\n          position: newPos,\n          rotation: angle,\n        })\n      }\n    } else {\n      // Random movement when no path\n      if (Math.random() < 0.001) {\n        const randomTarget = {\n          x: (Math.random() - 0.5) * 30,\n          y: 0,\n          z: (Math.random() - 0.5) * 30,\n        }\n\n        const path = pathfinding.findPath(caregiver.position, randomTarget)\n        if (path.length > 0) {\n          const smoothPath = pathfinding.smoothPath(path)\n          setCurrentPath(smoothPath)\n          setPathIndex(0)\n          setCurrentAnimation('walk')\n        }\n      } else {\n        setCurrentAnimation('idle')\n      }\n    }\n\n    // Update emotions based on activity\n    updateEmotions()\n  })\n\n  const updateEmotions = () => {\n    const newEmotions = { ...emotions }\n    \n    // Speaking increases happiness slightly\n    if (caregiver?.lastVoiceActivity && Date.now() - caregiver.lastVoiceActivity < 2000) {\n      newEmotions.happiness = Math.min(1, newEmotions.happiness + 0.02)\n    }\n    \n    // Active interventions might increase sternness (anger)\n    if (currentPath.length > 0) {\n      newEmotions.anger = Math.min(0.3, newEmotions.anger + 0.01)\n    }\n    \n    // Natural emotion decay\n    newEmotions.happiness = Math.max(0.3, newEmotions.happiness - 0.005)\n    newEmotions.anger = Math.max(0, newEmotions.anger - 0.003)\n    \n    setEmotions(newEmotions)\n  }\n\n  const handleCaregiverDecision = (decision: any) => {\n    const intervention = decision.interventions[0]\n\n    switch (intervention?.type) {\n      case \"escort\":\n        console.log(\"[v0] Escorting player:\", decision.targetId)\n        setCurrentAnimation('being_led')\n        break\n\n      case \"cooldown\":\n        console.log(\"[v0] Putting player in timeout:\", decision.targetId)\n        setCurrentAnimation('timeout_pose')\n        break\n\n      case \"disciplinary_action\":\n        console.log(\"[v0] Disciplinary action:\", decision.reasoning)\n        setCurrentAnimation('spank_otk')\n        setEmotions(prev => ({ ...prev, anger: Math.min(0.7, prev.anger + 0.3) }))\n        break\n\n      case \"physical_control\":\n        console.log(\"[v0] Physical control:\", decision.targetId)\n        setCurrentAnimation('being_led')\n        break\n\n      default:\n        console.log(\"[v0] Unknown intervention type\")\n        setCurrentAnimation('idle')\n    }\n\n    // Reset to idle after a delay\n    setTimeout(() => {\n      setCurrentAnimation('idle')\n    }, 3000)\n  }\n\n  if (!caregiver) return null\n\n  // Create default clothing for caregiver\n  const caregiverClothing = {\n    shirt: true,\n    pants: true,\n    socks: true,\n    shoes: true,\n    underwearType: 'underwear' as const,\n    underwearState: 'clean' as const,\n    diaperFillLevel: 0,\n    pacifierIn: false\n  }\n\n  return (\n    <RigidBody\n      ref={rigidBodyRef}\n      colliders=\"ball\"\n      type=\"kinematicPosition\"\n      position={[caregiver.position.x, caregiver.position.y + 1, caregiver.position.z]}\n      enabledRotations={[false, true, false]}\n    >\n      <CustomCharacterModel\n        customization={caregiver.character}\n        clothing={caregiverClothing}\n        position={[0, 0, 0]}\n        scale={1.0}\n        currentAnimation={currentAnimation}\n        emotions={emotions}\n        isAnimated={true}\n      />\n      \n      {/* Voice activity indicator */}\n      {caregiver.lastVoiceActivity && Date.now() - caregiver.lastVoiceActivity < 2000 && (\n        <mesh position={[0, 3, 0]}>\n          <sphereGeometry args={[0.1]} />\n          <meshBasicMaterial color=\"#87CEEB\" />\n        </mesh>\n      )}\n\n      {/* Intent indicator */}\n      {caregiver.currentIntent.goals.length > 0 && (\n        <mesh position={[0, 3.2, 0]}>\n          <sphereGeometry args={[0.08]} />\n          <meshBasicMaterial color=\"#FFD700\" />\n        </mesh>\n      )}\n\n      {/* Personality aura */}\n      <mesh position={[0, 2.5, 0]}>\n        <sphereGeometry args={[0.6, 16, 16]} />\n        <meshBasicMaterial\n          color={caregiver.personality.strictness > 70 ? \"#FF6347\" : \"#90EE90\"}\n          transparent\n          opacity={0.1}\n        />\n      </mesh>\n    </RigidBody>\n  )\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6737, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/AccidentMarkers.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\n\nexport function AccidentMarkers() {\n  const accidentsMap = useGameStore((state) => state.accidents)\n  const accidents = useMemo(() => Array.from(accidentsMap.values()), [accidentsMap])\n\n  return (\n    <>{accidents.map((accident) => !accident.cleanedUp && <AccidentMarker key={accident.id} accident={accident} />)}</>\n  )\n}\n\nfunction AccidentMarker({ accident }: { accident: any }) {\n  const color = accident.type === \"pee\" ? \"#FFD700\" : \"#8B4513\"\n  const size = 0.3 + (accident.size / 100) * 0.5\n\n  return (\n    <mesh position={[accident.position.x, 0.02, accident.position.z]} rotation={[-Math.PI / 2, 0, 0]}>\n      <circleGeometry args={[size, 16]} />\n      <meshBasicMaterial color={color} transparent opacity={0.7} />\n    </mesh>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKO,SAAS;;IACd,MAAM,eAAe,IAAA,6IAAY;sDAAC,CAAC,QAAU,MAAM,SAAS;;IAC5D,MAAM,YAAY,IAAA,wKAAO;8CAAC,IAAM,MAAM,IAAI,CAAC,aAAa,MAAM;6CAAK;QAAC;KAAa;IAEjF,qBACE;kBAAG,UAAU,GAAG,CAAC,CAAC,WAAa,CAAC,SAAS,SAAS,kBAAI,6LAAC;gBAAiC,UAAU;eAAvB,SAAS,EAAE;;;;;;AAE1F;GAPgB;;QACO,6IAAY;;;KADnB;AAShB,SAAS,eAAe,EAAE,QAAQ,EAAqB;IACrD,MAAM,QAAQ,SAAS,IAAI,KAAK,QAAQ,YAAY;IACpD,MAAM,OAAO,MAAM,AAAC,SAAS,IAAI,GAAG,MAAO;IAE3C,qBACE,6LAAC;QAAK,UAAU;YAAC,SAAS,QAAQ,CAAC,CAAC;YAAE;YAAM,SAAS,QAAQ,CAAC,CAAC;SAAC;QAAE,UAAU;YAAC,CAAC,KAAK,EAAE,GAAG;YAAG;YAAG;SAAE;;0BAC9F,6LAAC;gBAAe,MAAM;oBAAC;oBAAM;iBAAG;;;;;;0BAChC,6LAAC;gBAAkB,OAAO;gBAAO,WAAW;gBAAC,SAAS;;;;;;;;;;;;AAG5D;MAVS"}},
    {"offset": {"line": 6827, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/LoadingFallback.tsx"],"sourcesContent":["\"use client\"\n\nimport { Html } from \"@react-three/drei\"\n\nexport function LoadingFallback() {\n  return (\n    <Html center>\n      <div className=\"flex flex-col items-center gap-4 p-8 bg-primary/10 rounded-xl backdrop-blur-sm\">\n        <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin\" />\n        <p className=\"text-lg font-medium text-foreground\">Loading Daycare...</p>\n      </div>\n    </Html>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIO,SAAS;IACd,qBACE,6LAAC,kKAAI;QAAC,MAAM;kBACV,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;;;;;8BACf,6LAAC;oBAAE,WAAU;8BAAsC;;;;;;;;;;;;;;;;;AAI3D;KATgB"}},
    {"offset": {"line": 6879, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/rules/gameRules.ts"],"sourcesContent":["import type {\n  AgeGroup,\n  UnderwearType,\n  CaregiverPersonality,\n  BehaviorEvent,\n  BehaviorSeverity,\n  VoiceEmotion,\n} from \"./gameTypes\"\n\nexport interface AgeRules {\n  canChooseClothes: boolean\n  canTogglePacifier: boolean\n  alwaysHasPacifier: boolean\n  allowedUnderwear: UnderwearType[]\n  canUsePotty: boolean\n  canUseToilet: (currentUnderwear: UnderwearType) => boolean\n  defaultAnimation: \"crawl\" | \"walk\"\n  defaultClothing: {\n    shirt: boolean\n    pants: boolean\n    socks: boolean\n    shoes: boolean\n    underwearType: UnderwearType\n    pacifierIn: boolean\n  }\n}\n\nexport const AGE_RULES: Record<AgeGroup, AgeRules> = {\n  \"1-4\": {\n    canChooseClothes: false,\n    canTogglePacifier: false,\n    alwaysHasPacifier: true,\n    allowedUnderwear: [\"diaper\"],\n    canUsePotty: false,\n    canUseToilet: () => false,\n    defaultAnimation: \"crawl\",\n    defaultClothing: {\n      shirt: false,\n      pants: false,\n      socks: false,\n      shoes: false,\n      underwearType: \"diaper\",\n      pacifierIn: true,\n    },\n  },\n  \"4-7\": {\n    canChooseClothes: false,\n    canTogglePacifier: true,\n    alwaysHasPacifier: false,\n    allowedUnderwear: [\"diaper\", \"training_pants\", \"underwear\"],\n    canUsePotty: true,\n    canUseToilet: (underwear) => underwear === \"training_pants\" || underwear === \"underwear\",\n    defaultAnimation: \"walk\",\n    defaultClothing: {\n      shirt: true,\n      pants: true,\n      socks: true,\n      shoes: true,\n      underwearType: \"training_pants\",\n      pacifierIn: false,\n    },\n  },\n  \"7-9\": {\n    canChooseClothes: true,\n    canTogglePacifier: false,\n    alwaysHasPacifier: false,\n    allowedUnderwear: [\"diaper\", \"training_pants\", \"underwear\"],\n    canUsePotty: true,\n    canUseToilet: (underwear) => underwear === \"training_pants\" || underwear === \"underwear\",\n    defaultAnimation: \"walk\",\n    defaultClothing: {\n      shirt: true,\n      pants: true,\n      socks: true,\n      shoes: true,\n      underwearType: \"underwear\",\n      pacifierIn: false,\n    },\n  },\n  \"12+\": {\n    canChooseClothes: true,\n    canTogglePacifier: false,\n    alwaysHasPacifier: false,\n    allowedUnderwear: [\"diaper\", \"training_pants\", \"underwear\"],\n    canUsePotty: true,\n    canUseToilet: (underwear) => underwear === \"training_pants\" || underwear === \"underwear\",\n    defaultAnimation: \"walk\",\n    defaultClothing: {\n      shirt: true,\n      pants: true,\n      socks: true,\n      shoes: true,\n      underwearType: \"underwear\",\n      pacifierIn: false,\n    },\n  },\n}\n\n// AI Caregiver Personality and Behavior Rules\nexport interface AICaregiverRules {\n  maxPatrolDistance: number\n  reactionTime: number // milliseconds\n  interventionThresholds: {\n    safety: BehaviorSeverity\n    ruleViolation: BehaviorSeverity\n    disruption: BehaviorSeverity\n  }\n  voiceSettings: {\n    defaultEmotion: VoiceEmotion\n    firmnessThreshold: number // 0-100, when to switch to firm tone\n    nurturingThreshold: number // 0-100, when to show nurturing behavior\n  }\n  personalityModifiers: {\n    strictness: number // affects intervention frequency\n    nurturing: number // affects reward and comfort behaviors\n    patience: number // affects timeout duration tolerance\n    fairness: number // affects consistency in rule enforcement\n    responsiveness: number // affects reaction speed to events\n  }\n}\n\nexport const AI_CAREGIVER_RULES: AICaregiverRules = {\n  maxPatrolDistance: 10.0, // units\n  reactionTime: 500, // milliseconds\n  interventionThresholds: {\n    safety: 2,\n    ruleViolation: 3,\n    disruption: 4,\n  },\n  voiceSettings: {\n    defaultEmotion: \"caring\",\n    firmnessThreshold: 70,\n    nurturingThreshold: 30,\n  },\n  personalityModifiers: {\n    strictness: 0.5,\n    nurturing: 0.5,\n    patience: 0.5,\n    fairness: 0.5,\n    responsiveness: 0.5,\n  },\n}\n\nexport interface CaregiverOverride {\n  canForceUnderwear: boolean\n  canForceTimeout: boolean\n  canChangeClothes: boolean\n  canUsePhysicalControl: boolean\n  canEscort: boolean\n  canSpeak: boolean // AI caregivers can speak\n}\n\nexport function getCaregiverPermissions(targetAgeGroup: AgeGroup): CaregiverOverride {\n  return {\n    canForceUnderwear: targetAgeGroup === \"1-4\" || targetAgeGroup === \"4-7\",\n    canForceTimeout: true,\n    canChangeClothes: true,\n    canUsePhysicalControl: targetAgeGroup === \"1-4\" || targetAgeGroup === \"4-7\",\n    canEscort: true,\n    canSpeak: true, // AI caregivers can always speak\n  }\n}\n\nexport function getAICaregiverRules(): AICaregiverRules {\n  return AI_CAREGIVER_RULES\n}\n\nexport function calculatePersonalityModifiers(\n  personality: CaregiverPersonality,\n): AICaregiverRules[\"personalityModifiers\"] {\n  return {\n    strictness: personality.strictness / 100,\n    nurturing: personality.nurturing / 100,\n    patience: personality.patience / 100,\n    fairness: personality.fairness / 100,\n    responsiveness: personality.responsiveness / 100,\n  }\n}\n\nexport function shouldAICaregiverIntervene(event: BehaviorEvent, personality: CaregiverPersonality): boolean {\n  const rules = getAICaregiverRules()\n  // Map the category string to the correct property name\n  const categoryKey = event.category === \"rule_violation\" ? \"ruleViolation\" : event.category\n  const threshold = rules.interventionThresholds[categoryKey]\n\n  // Adjust threshold based on personality\n  let adjustedThreshold = threshold\n\n  // Strict caregivers intervene more frequently\n  if (personality.strictness > 70) {\n    adjustedThreshold = Math.max(1, threshold - 1) as BehaviorSeverity\n  }\n  // Nurturing caregivers are more tolerant\n  else if (personality.nurturing > 70) {\n    adjustedThreshold = Math.min(5, threshold + 1) as BehaviorSeverity\n  }\n\n  return event.severity >= adjustedThreshold\n}\n\nexport function getAICaregiverVoiceEmotion(\n  personality: CaregiverPersonality,\n  context: \"normal\" | \"warning\" | \"discipline\" | \"comfort\",\n): VoiceEmotion {\n  const rules = getAICaregiverRules()\n\n  switch (context) {\n    case \"normal\":\n      return rules.voiceSettings.defaultEmotion\n    case \"warning\":\n      return personality.strictness > rules.voiceSettings.firmnessThreshold ? \"firm\" : \"caring\"\n    case \"discipline\":\n      return \"stern\"\n    case \"comfort\":\n      return \"caring\" // Use 'caring' instead of 'nurturing'\n    default:\n      return rules.voiceSettings.defaultEmotion\n  }\n}\n\nexport function calculateInterventionConfidence(event: BehaviorEvent, personality: CaregiverPersonality): number {\n  let baseConfidence = 0.5\n\n  // Higher strictness increases confidence in interventions\n  baseConfidence += (personality.strictness - 50) / 100\n\n  // Higher severity increases confidence\n  baseConfidence += (event.severity - 1) * 0.1\n\n  // Higher responsiveness increases confidence\n  baseConfidence += (personality.responsiveness - 50) / 200\n\n  return Math.max(0.1, Math.min(1.0, baseConfidence))\n}\n\n// Age-based rules\nexport function getAgeRules(ageGroup: AgeGroup): AgeRules {\n  return AGE_RULES[ageGroup]\n}\n\nexport function canChangeUnderwear(ageGroup: AgeGroup, newType: UnderwearType): boolean {\n  const rules = AGE_RULES[ageGroup]\n  return rules.allowedUnderwear.includes(newType)\n}\n\nexport function canUseToiletWithCurrentUnderwear(ageGroup: AgeGroup, underwearType: UnderwearType): boolean {\n  const rules = AGE_RULES[ageGroup]\n  return rules.canUseToilet(underwearType)\n}\n\nexport function shouldShowPacifier(ageGroup: AgeGroup, pacifierIn: boolean): boolean {\n  const rules = AGE_RULES[ageGroup]\n  if (rules.alwaysHasPacifier) return true\n  if (ageGroup === \"7-9\" || ageGroup === \"12+\") return false\n  return pacifierIn\n}\n\nexport function getDefaultClothingForAge(ageGroup: AgeGroup) {\n  return AGE_RULES[ageGroup].defaultClothing\n}\n\nexport function getAnimationForAge(ageGroup: AgeGroup): \"crawl\" | \"walk\" {\n  return AGE_RULES[ageGroup].defaultAnimation\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7107, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/NeedsSystem.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useRef } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { getAgeRules } from \"@/lib/rules/gameRules\"\n\n/**\n * Needs System - Manages player needs (bladder, bowel, hunger)\n * Runs independently and updates player state\n */\nexport function useNeedsSystem() {\n  const playersMap = useGameStore((state) => state.players)\n  const updatePlayerNeeds = useGameStore((state) => state.updatePlayerNeeds)\n  const updatePlayerClothing = useGameStore((state) => state.updatePlayerClothing)\n  const addAccident = useGameStore((state) => state.addAccident)\n\n  const playerIdsRef = useRef<Set<string>>(new Set())\n\n  useEffect(() => {\n    const players = Array.from(playersMap.values())\n\n    const interval = setInterval(() => {\n      players.forEach((player) => {\n        // Skip caregivers\n        if (player.role === \"caregiver\") return\n\n        const ageRules = getAgeRules(player.character.ageGroup)\n        const newNeeds = { ...player.needs }\n\n        // Increase needs over time\n        newNeeds.bladder = Math.min(100, player.needs.bladder + Math.random() * 2)\n        newNeeds.bowel = Math.min(100, player.needs.bowel + Math.random() * 1)\n        newNeeds.hunger = Math.min(100, player.needs.hunger + Math.random() * 0.5)\n\n        updatePlayerNeeds(player.id, newNeeds)\n\n        // Check for accidents\n        if (newNeeds.bladder >= 100 && player.clothing.underwearType === \"diaper\") {\n          // Automatic wetting in diaper\n          const newFillLevel = Math.min(5, player.clothing.diaperFillLevel + 1)\n          const newState = player.clothing.underwearState === \"messy\" ? \"both\" : \"wet\"\n\n          updatePlayerClothing(player.id, {\n            diaperFillLevel: newFillLevel,\n            underwearState: newState,\n          })\n\n          // Reset bladder\n          updatePlayerNeeds(player.id, { bladder: 0 })\n        } else if (newNeeds.bladder >= 100 && player.clothing.underwearType !== \"diaper\") {\n          // Accident on floor\n          addAccident({\n            id: `accident_${Date.now()}_${player.id}`,\n            type: \"pee\",\n            position: player.position,\n            playerId: player.id,\n            timestamp: Date.now(),\n            cleanedUp: false,\n            size: 50 + Math.random() * 50,\n            cause: \"bladder_full\",\n          })\n\n          // Wet underwear\n          updatePlayerClothing(player.id, {\n            underwearState: player.clothing.underwearState === \"messy\" ? \"both\" : \"wet\",\n          })\n\n          // Reset bladder\n          updatePlayerNeeds(player.id, { bladder: 0 })\n        }\n\n        // Bowel accidents\n        if (newNeeds.bowel >= 100) {\n          if (player.clothing.underwearType === \"diaper\") {\n            // Mess in diaper\n            const newFillLevel = Math.min(5, player.clothing.diaperFillLevel + 2)\n            const newState = player.clothing.underwearState === \"wet\" ? \"both\" : \"messy\"\n\n            updatePlayerClothing(player.id, {\n              diaperFillLevel: newFillLevel,\n              underwearState: newState,\n            })\n\n            // Reset bowel\n            updatePlayerNeeds(player.id, { bowel: 0 })\n          } else {\n            // Accident on floor\n            addAccident({\n              id: `accident_${Date.now()}_${player.id}`,\n              type: \"poop\",\n              position: player.position,\n              playerId: player.id,\n              timestamp: Date.now(),\n              cleanedUp: false,\n              size: 30 + Math.random() * 40,\n              cause: \"bowel_full\",\n            })\n\n            // Messy underwear\n            updatePlayerClothing(player.id, {\n              underwearState: player.clothing.underwearState === \"wet\" ? \"both\" : \"messy\",\n            })\n\n            // Reset bowel\n            updatePlayerNeeds(player.id, { bowel: 0 })\n          }\n        }\n      })\n    }, 5000) // Update every 5 seconds\n\n    return () => clearInterval(interval)\n  }, [playersMap.size, updatePlayerNeeds, updatePlayerClothing, addAccident])\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7253, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/three/DaycareScene.tsx"],"sourcesContent":["\"use client\"\n\nimport { Canvas } from \"@react-three/fiber\"\nimport { Physics } from \"@react-three/rapier\"\nimport { Sky, Environment } from \"@react-three/drei\"\nimport { Suspense } from \"react\"\nimport { useRef } from \"react\"\nimport { DaycareEnvironment } from \"./DaycareEnvironment\"\nimport { DaycareObjects } from \"./DaycareObjects\"\nimport { PlayerCharacters } from \"./PlayerCharacters\"\nimport { CaregiverCharacters } from \"./CaregiverCharacters\"\nimport { AccidentMarkers } from \"./AccidentMarkers\"\nimport { LoadingFallback } from \"./LoadingFallback\"\nimport { useNeedsSystem } from \"./NeedsSystem\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\n\nexport function DaycareScene() {\n  useNeedsSystem()\n  const currentPlayerId = useGameStore((state) => state.currentPlayerId)\n  const players = useGameStore((state) => state.players)\n  const currentPlayer = currentPlayerId ? players.get(currentPlayerId) : null\n  const playerRef = useRef<any>(null)\n\n  return (\n    <div className=\"w-full h-screen\">\n      <Canvas\n        shadows\n        camera={{\n          position: [0, 5, 10],\n          fov: 60,\n          near: 0.1,\n          far: 1000,\n        }}\n        gl={{\n          antialias: true,\n          alpha: false,\n          powerPreference: \"high-performance\",\n        }}\n      >\n        <Suspense fallback={<LoadingFallback />}>\n          {/* Lighting */}\n          <ambientLight intensity={0.6} color=\"#FFE5EC\" />\n          <directionalLight\n            position={[10, 20, 10]}\n            intensity={0.8}\n            castShadow\n            shadow-mapSize-width={2048}\n            shadow-mapSize-height={2048}\n            shadow-camera-far={50}\n            shadow-camera-left={-30}\n            shadow-camera-right={30}\n            shadow-camera-top={30}\n            shadow-camera-bottom={-30}\n            color=\"#FFFAF0\"\n          />\n          <pointLight position={[-10, 10, -10]} intensity={0.3} color=\"#E0BBE4\" />\n          <pointLight position={[10, 10, 10]} intensity={0.3} color=\"#FFDFD3\" />\n\n          {/* Pastel sky */}\n          <Sky\n            distance={450000}\n            sunPosition={[10, 20, 10]}\n            inclination={0.6}\n            azimuth={0.25}\n            turbidity={2}\n            rayleigh={0.5}\n          />\n\n          {/* Physics world with gravity */}\n          <Physics gravity={[0, -9.81, 0]} debug={true} timeStep={1 / 60} numSolverIterations={10}>\n            {/* Ground and walls */}\n            <DaycareEnvironment />\n\n            {/* Interactive objects */}\n            <DaycareObjects />\n\n            {/* Player characters */}\n            <PlayerCharacters />\n\n            {/* AI Caregiver NPCs */}\n            <CaregiverCharacters />\n\n            {/* Accident markers */}\n            <AccidentMarkers />\n          </Physics>\n\n          {/* Environment lighting */}\n          <Environment preset=\"apartment\" background={false} />\n        </Suspense>\n      </Canvas>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAdA;;;;;;;;;;;;;;AAgBO,SAAS;;IACd,IAAA,wJAAc;IACd,MAAM,kBAAkB,IAAA,6IAAY;sDAAC,CAAC,QAAU,MAAM,eAAe;;IACrE,MAAM,UAAU,IAAA,6IAAY;8CAAC,CAAC,QAAU,MAAM,OAAO;;IACrD,MAAM,gBAAgB,kBAAkB,QAAQ,GAAG,CAAC,mBAAmB;IACvE,MAAM,YAAY,IAAA,uKAAM,EAAM;IAE9B,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,gNAAM;YACL,OAAO;YACP,QAAQ;gBACN,UAAU;oBAAC;oBAAG;oBAAG;iBAAG;gBACpB,KAAK;gBACL,MAAM;gBACN,KAAK;YACP;YACA,IAAI;gBACF,WAAW;gBACX,OAAO;gBACP,iBAAiB;YACnB;sBAEA,cAAA,6LAAC,yKAAQ;gBAAC,wBAAU,6LAAC,6JAAe;;;;;;kCAElC,6LAAC;wBAAa,WAAW;wBAAK,OAAM;;;;;;kCACpC,6LAAC;wBACC,UAAU;4BAAC;4BAAI;4BAAI;yBAAG;wBACtB,WAAW;wBACX,UAAU;wBACV,wBAAsB;wBACtB,yBAAuB;wBACvB,qBAAmB;wBACnB,sBAAoB,CAAC;wBACrB,uBAAqB;wBACrB,qBAAmB;wBACnB,wBAAsB,CAAC;wBACvB,OAAM;;;;;;kCAER,6LAAC;wBAAW,UAAU;4BAAC,CAAC;4BAAI;4BAAI,CAAC;yBAAG;wBAAE,WAAW;wBAAK,OAAM;;;;;;kCAC5D,6LAAC;wBAAW,UAAU;4BAAC;4BAAI;4BAAI;yBAAG;wBAAE,WAAW;wBAAK,OAAM;;;;;;kCAG1D,6LAAC,iKAAG;wBACF,UAAU;wBACV,aAAa;4BAAC;4BAAI;4BAAI;yBAAG;wBACzB,aAAa;wBACb,SAAS;wBACT,WAAW;wBACX,UAAU;;;;;;kCAIZ,6LAAC,mNAAO;wBAAC,SAAS;4BAAC;4BAAG,CAAC;4BAAM;yBAAE;wBAAE,OAAO;wBAAM,UAAU,IAAI;wBAAI,qBAAqB;;0CAEnF,6LAAC,mKAAkB;;;;;0CAGnB,6LAAC,2JAAc;;;;;0CAGf,6LAAC,+JAAgB;;;;;0CAGjB,6LAAC,qKAAmB;;;;;0CAGpB,6LAAC,6JAAe;;;;;;;;;;;kCAIlB,6LAAC,iLAAW;wBAAC,QAAO;wBAAY,YAAY;;;;;;;;;;;;;;;;;;;;;;AAKtD;GA5EgB;;QACd,wJAAc;QACU,6IAAY;QACpB,6IAAY;;;KAHd"}},
    {"offset": {"line": 7478, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 7496, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 7616, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/progress.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ProgressPrimitive from '@radix-ui/react-progress'\n\nimport { cn } from '@/lib/utils'\n\nfunction Progress({\n  className,\n  value,\n  ...props\n}: React.ComponentProps<typeof ProgressPrimitive.Root>) {\n  return (\n    <ProgressPrimitive.Root\n      data-slot=\"progress\"\n      className={cn(\n        'bg-primary/20 relative h-2 w-full overflow-hidden rounded-full',\n        className,\n      )}\n      {...props}\n    >\n      <ProgressPrimitive.Indicator\n        data-slot=\"progress-indicator\"\n        className=\"bg-primary h-full w-full flex-1 transition-all\"\n        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n      />\n    </ProgressPrimitive.Root>\n  )\n}\n\nexport { Progress }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,SAAS,EAChB,SAAS,EACT,KAAK,EACL,GAAG,OACiD;IACpD,qBACE,6LAAC,+KAAsB;QACrB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,aAAU;YACV,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;AAIlE;KArBS"}},
    {"offset": {"line": 7660, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/hooks/usePlayerActions.ts"],"sourcesContent":["\"use client\"\n\nimport { useCallback } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { getAgeRules, canChangeUnderwear } from \"@/lib/rules/gameRules\"\nimport type { UnderwearType } from \"@/lib/types/gameTypes\"\n\nexport function usePlayerActions() {\n  const currentPlayerId = useGameStore((state) => state.currentPlayerId)\n  const currentPlayer = useGameStore((state) =>\n    state.currentPlayerId ? state.players.get(state.currentPlayerId) : null,\n  )\n  const updatePlayerClothing = useGameStore((state) => state.updatePlayerClothing)\n  const updatePlayerNeeds = useGameStore((state) => state.updatePlayerNeeds)\n  const addMessage = useGameStore((state) => state.addMessage)\n\n  const togglePacifier = useCallback(() => {\n    if (!currentPlayer) return\n\n    const ageRules = getAgeRules(currentPlayer.character.ageGroup)\n    if (!ageRules.canTogglePacifier) {\n      addMessage({\n        id: `msg_${Date.now()}`,\n        senderId: \"system\",\n        senderName: \"System\",\n        content: \"You cannot remove your pacifier at this age.\",\n        timestamp: Date.now(),\n        isSystem: true,\n        messageType: \"announcement\",\n      })\n      return\n    }\n\n    updatePlayerClothing(currentPlayer.id, {\n      pacifierIn: !currentPlayer.clothing.pacifierIn,\n    })\n  }, [currentPlayer, updatePlayerClothing, addMessage])\n\n  const changeUnderwear = useCallback(\n    (newType: UnderwearType) => {\n      if (!currentPlayer) return\n\n      if (!canChangeUnderwear(currentPlayer.character.ageGroup, newType)) {\n        addMessage({\n          id: `msg_${Date.now()}`,\n          senderId: \"system\",\n          senderName: \"System\",\n          content: `You cannot wear ${newType} at your age.`,\n          timestamp: Date.now(),\n          isSystem: true,\n          messageType: \"announcement\",\n        })\n        return\n      }\n\n      updatePlayerClothing(currentPlayer.id, {\n        underwearType: newType,\n        underwearState: \"clean\",\n        diaperFillLevel: 0,\n      })\n\n      addMessage({\n        id: `msg_${Date.now()}`,\n        senderId: \"system\",\n        senderName: \"System\",\n        content: `Changed to ${newType}.`,\n        timestamp: Date.now(),\n        isSystem: true,\n        messageType: \"announcement\",\n      })\n    },\n    [currentPlayer, updatePlayerClothing, addMessage],\n  )\n\n  const usePotty = useCallback(() => {\n    if (!currentPlayer) return\n\n    const ageRules = getAgeRules(currentPlayer.character.ageGroup)\n    if (!ageRules.canUsePotty) {\n      addMessage({\n        id: `msg_${Date.now()}`,\n        senderId: \"system\",\n        senderName: \"System\",\n        content: \"You need help using the potty.\",\n        timestamp: Date.now(),\n        isSystem: true,\n        messageType: \"announcement\",\n      })\n      return\n    }\n\n    // Check if near a potty (would need object proximity check)\n    updatePlayerNeeds(currentPlayer.id, {\n      bladder: Math.max(0, currentPlayer.needs.bladder - 50),\n    })\n\n    addMessage({\n      id: `msg_${Date.now()}`,\n      senderId: \"system\",\n      senderName: \"System\",\n      content: \"You used the potty!\",\n      timestamp: Date.now(),\n      isSystem: true,\n      messageType: \"announcement\",\n    })\n  }, [currentPlayer, updatePlayerNeeds, addMessage])\n\n  const useToilet = useCallback(() => {\n    if (!currentPlayer) return\n\n    const ageRules = getAgeRules(currentPlayer.character.ageGroup)\n    if (!ageRules.canUseToilet(currentPlayer.clothing.underwearType)) {\n      addMessage({\n        id: `msg_${Date.now()}`,\n        senderId: \"system\",\n        senderName: \"System\",\n        content: \"You cannot use the toilet with your current underwear.\",\n        timestamp: Date.now(),\n        isSystem: true,\n        messageType: \"announcement\",\n      })\n      return\n    }\n\n    updatePlayerNeeds(currentPlayer.id, {\n      bladder: 0,\n      bowel: 0,\n    })\n\n    addMessage({\n      id: `msg_${Date.now()}`,\n      senderId: \"system\",\n      senderName: \"System\",\n      content: \"You used the toilet!\",\n      timestamp: Date.now(),\n      isSystem: true,\n      messageType: \"announcement\",\n    })\n  }, [currentPlayer, updatePlayerNeeds, addMessage])\n\n  return {\n    togglePacifier,\n    changeUnderwear,\n    usePotty,\n    useToilet,\n    currentPlayer,\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7843, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/HUD.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { Card } from \"@/components/ui/card\"\nimport { Progress } from \"@/components/ui/progress\"\nimport { usePlayerActions } from \"@/lib/hooks/usePlayerActions\"\nimport { getAlignmentColor } from \"@/lib/types/gameTypes\"\n\nexport function HUD() {\n  const { currentPlayer } = usePlayerActions()\n  const messagesArray = useGameStore((state) => state.messages)\n  const messages = useMemo(() => messagesArray.slice(-5), [messagesArray])\n\n  if (!currentPlayer) return null\n\n  return (\n    <div className=\"fixed inset-0 pointer-events-none\">\n      {/* Top left - Player stats */}\n      <Card className=\"absolute top-4 left-4 p-4 pointer-events-auto bg-card/90 backdrop-blur-sm\">\n        <div className=\"flex flex-col gap-2 min-w-[200px]\">\n          <h3 className=\"font-semibold text-foreground\">{currentPlayer.name}</h3>\n\n          {/* Alignment indicator */}\n          <div\n            className=\"px-2 py-1 rounded-md text-xs font-medium text-center\"\n            style={{ backgroundColor: getAlignmentColor(currentPlayer.alignment) }}\n          >\n            {currentPlayer.alignment.replace(/_/g, \" \").toUpperCase()}\n          </div>\n\n          {/* Needs */}\n          <div className=\"flex flex-col gap-1\">\n            <div className=\"flex justify-between text-xs\">\n              <span>Bladder</span>\n              <span>{Math.round(currentPlayer.needs.bladder)}%</span>\n            </div>\n            <Progress value={currentPlayer.needs.bladder} className=\"h-2\" />\n\n            <div className=\"flex justify-between text-xs\">\n              <span>Bowel</span>\n              <span>{Math.round(currentPlayer.needs.bowel)}%</span>\n            </div>\n            <Progress value={currentPlayer.needs.bowel} className=\"h-2\" />\n\n            <div className=\"flex justify-between text-xs\">\n              <span>Hunger</span>\n              <span>{Math.round(currentPlayer.needs.hunger)}%</span>\n            </div>\n            <Progress value={currentPlayer.needs.hunger} className=\"h-2\" />\n          </div>\n\n          {/* Clothing status */}\n          <div className=\"text-xs text-muted-foreground\">\n            <div>Underwear: {currentPlayer.clothing.underwearType}</div>\n            <div>State: {currentPlayer.clothing.underwearState}</div>\n            {currentPlayer.clothing.underwearType === \"diaper\" && (\n              <div>Fill: {currentPlayer.clothing.diaperFillLevel}/5</div>\n            )}\n          </div>\n        </div>\n      </Card>\n\n      {/* Bottom center - Chat messages */}\n      <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 w-[500px] pointer-events-auto\">\n        <div className=\"flex flex-col gap-1\">\n          {messages.map((msg) => (\n            <div key={msg.id} className=\"bg-card/90 backdrop-blur-sm rounded-lg px-3 py-2 text-sm\">\n              <span className=\"font-semibold text-primary\">{msg.senderName}: </span>\n              <span className=\"text-foreground\">{msg.content}</span>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Bottom right - Controls hint */}\n      <Card className=\"absolute bottom-4 right-4 p-3 pointer-events-auto bg-card/90 backdrop-blur-sm\">\n        <div className=\"text-xs text-muted-foreground\">\n          <div className=\"font-semibold mb-1\">Controls</div>\n          <div>WASD / Arrows - Move</div>\n          <div>Shift - Run</div>\n          <div>Space - Jump</div>\n        </div>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AASO,SAAS;;IACd,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,uJAAgB;IAC1C,MAAM,gBAAgB,IAAA,6IAAY;2CAAC,CAAC,QAAU,MAAM,QAAQ;;IAC5D,MAAM,WAAW,IAAA,wKAAO;iCAAC,IAAM,cAAc,KAAK,CAAC,CAAC;gCAAI;QAAC;KAAc;IAEvE,IAAI,CAAC,eAAe,OAAO;IAE3B,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC,oIAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAiC,cAAc,IAAI;;;;;;sCAGjE,6LAAC;4BACC,WAAU;4BACV,OAAO;gCAAE,iBAAiB,IAAA,iJAAiB,EAAC,cAAc,SAAS;4BAAE;sCAEpE,cAAc,SAAS,CAAC,OAAO,CAAC,MAAM,KAAK,WAAW;;;;;;sCAIzD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;sDAAK;;;;;;sDACN,6LAAC;;gDAAM,KAAK,KAAK,CAAC,cAAc,KAAK,CAAC,OAAO;gDAAE;;;;;;;;;;;;;8CAEjD,6LAAC,4IAAQ;oCAAC,OAAO,cAAc,KAAK,CAAC,OAAO;oCAAE,WAAU;;;;;;8CAExD,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;sDAAK;;;;;;sDACN,6LAAC;;gDAAM,KAAK,KAAK,CAAC,cAAc,KAAK,CAAC,KAAK;gDAAE;;;;;;;;;;;;;8CAE/C,6LAAC,4IAAQ;oCAAC,OAAO,cAAc,KAAK,CAAC,KAAK;oCAAE,WAAU;;;;;;8CAEtD,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;sDAAK;;;;;;sDACN,6LAAC;;gDAAM,KAAK,KAAK,CAAC,cAAc,KAAK,CAAC,MAAM;gDAAE;;;;;;;;;;;;;8CAEhD,6LAAC,4IAAQ;oCAAC,OAAO,cAAc,KAAK,CAAC,MAAM;oCAAE,WAAU;;;;;;;;;;;;sCAIzD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;wCAAI;wCAAY,cAAc,QAAQ,CAAC,aAAa;;;;;;;8CACrD,6LAAC;;wCAAI;wCAAQ,cAAc,QAAQ,CAAC,cAAc;;;;;;;gCACjD,cAAc,QAAQ,CAAC,aAAa,KAAK,0BACxC,6LAAC;;wCAAI;wCAAO,cAAc,QAAQ,CAAC,eAAe;wCAAC;;;;;;;;;;;;;;;;;;;;;;;;0BAO3D,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BACZ,SAAS,GAAG,CAAC,CAAC,oBACb,6LAAC;4BAAiB,WAAU;;8CAC1B,6LAAC;oCAAK,WAAU;;wCAA8B,IAAI,UAAU;wCAAC;;;;;;;8CAC7D,6LAAC;oCAAK,WAAU;8CAAmB,IAAI,OAAO;;;;;;;2BAFtC,IAAI,EAAE;;;;;;;;;;;;;;;0BAStB,6LAAC,oIAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;sCAAqB;;;;;;sCACpC,6LAAC;sCAAI;;;;;;sCACL,6LAAC;sCAAI;;;;;;sCACL,6LAAC;sCAAI;;;;;;;;;;;;;;;;;;;;;;;AAKf;GA7EgB;;QACY,uJAAgB;QACpB,6IAAY;;;KAFpB"}},
    {"offset": {"line": 8174, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 8239, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/stores/voiceStore.ts"],"sourcesContent":["import { create } from \"zustand\"\nimport type { VoiceProfile } from \"@/lib/types/gameTypes\"\n\ninterface VoiceState {\n  // Voice connection\n  isConnected: boolean\n  isRecording: boolean\n  audioLevel: number\n\n  // Voice profile\n  currentVoiceProfile: VoiceProfile | null\n  availableVoices: VoiceProfile[]\n\n  // Caregiver voices\n  caregiverVoices: Map<string, string> // caregiverId -> voiceId\n\n  // Transcription\n  lastTranscript: string | null\n  transcriptConfidence: number\n\n  // Actions\n  setConnected: (connected: boolean) => void\n  setRecording: (recording: boolean) => void\n  setAudioLevel: (level: number) => void\n  setVoiceProfile: (profile: VoiceProfile | null) => void\n  setAvailableVoices: (voices: VoiceProfile[]) => void\n  setCaregiverVoice: (caregiverId: string, voiceId: string) => void\n  setLastTranscript: (transcript: string, confidence: number) => void\n}\n\nexport const useVoiceStore = create<VoiceState>((set) => ({\n  isConnected: false,\n  isRecording: false,\n  audioLevel: 0,\n  currentVoiceProfile: null,\n  availableVoices: [],\n  caregiverVoices: new Map(),\n  lastTranscript: null,\n  transcriptConfidence: 0,\n\n  setConnected: (connected) => set({ isConnected: connected }),\n  setRecording: (recording) => set({ isRecording: recording }),\n  setAudioLevel: (level) => set({ audioLevel: level }),\n  setVoiceProfile: (profile) => set({ currentVoiceProfile: profile }),\n  setAvailableVoices: (voices) => set({ availableVoices: voices }),\n\n  setCaregiverVoice: (caregiverId, voiceId) =>\n    set((state) => {\n      const caregiverVoices = new Map(state.caregiverVoices)\n      caregiverVoices.set(caregiverId, voiceId)\n      return { caregiverVoices }\n    }),\n\n  setLastTranscript: (transcript, confidence) =>\n    set({\n      lastTranscript: transcript,\n      transcriptConfidence: confidence,\n    }),\n}))\n"],"names":[],"mappings":";;;;AAAA;;AA8BO,MAAM,gBAAgB,IAAA,qJAAM,EAAa,CAAC,MAAQ,CAAC;QACxD,aAAa;QACb,aAAa;QACb,YAAY;QACZ,qBAAqB;QACrB,iBAAiB,EAAE;QACnB,iBAAiB,IAAI;QACrB,gBAAgB;QAChB,sBAAsB;QAEtB,cAAc,CAAC,YAAc,IAAI;gBAAE,aAAa;YAAU;QAC1D,cAAc,CAAC,YAAc,IAAI;gBAAE,aAAa;YAAU;QAC1D,eAAe,CAAC,QAAU,IAAI;gBAAE,YAAY;YAAM;QAClD,iBAAiB,CAAC,UAAY,IAAI;gBAAE,qBAAqB;YAAQ;QACjE,oBAAoB,CAAC,SAAW,IAAI;gBAAE,iBAAiB;YAAO;QAE9D,mBAAmB,CAAC,aAAa,UAC/B,IAAI,CAAC;gBACH,MAAM,kBAAkB,IAAI,IAAI,MAAM,eAAe;gBACrD,gBAAgB,GAAG,CAAC,aAAa;gBACjC,OAAO;oBAAE;gBAAgB;YAC3B;QAEF,mBAAmB,CAAC,YAAY,aAC9B,IAAI;gBACF,gBAAgB;gBAChB,sBAAsB;YACxB;IACJ,CAAC"}},
    {"offset": {"line": 8288, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/services/ElevenLabsService.ts"],"sourcesContent":["import type {\n  VoiceProfile,\n  VoiceRecognitionResult,\n  VoiceSynthesisOptions,\n  VoiceService,\n  VoiceEmotion,\n} from \"@/lib/types/gameTypes\"\n\n/**\n * ElevenLabs Service - Client-side wrapper using secure API routes\n */\nexport class ElevenLabsService implements VoiceService {\n  private voiceProfile: VoiceProfile | null = null\n  private recognitionLanguage = \"en\"\n  private synthesisLanguage = \"en\"\n  private audioLevelCallback?: (level: number) => void\n\n  constructor() {}\n\n  get isInitialized(): boolean {\n    return true // Always initialized since we use server routes\n  }\n\n  async recognizeSpeech(audioData: ArrayBuffer): Promise<VoiceRecognitionResult> {\n    try {\n      const formData = new FormData()\n      formData.append(\"audio\", new Blob([audioData], { type: \"audio/wav\" }))\n\n      const response = await fetch(\"/api/voice/transcribe\", {\n        method: \"POST\",\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error(`Transcription error: ${response.status}`)\n      }\n\n      const result = await response.json()\n\n      return {\n        text: result.text || \"\",\n        confidence: result.confidence || 0.9,\n        language: result.language || this.recognitionLanguage,\n        duration: result.duration || 0,\n      }\n    } catch (error) {\n      console.error(\"Speech recognition failed:\", error)\n      throw new Error(`Speech recognition failed: ${error}`)\n    }\n  }\n\n  async startContinuousRecognition(): Promise<void> {\n    console.log(\"Starting continuous recognition\")\n  }\n\n  async stopContinuousRecognition(): Promise<string> {\n    console.log(\"Stopping continuous recognition\")\n    return \"\"\n  }\n\n  async synthesizeSpeech(text: string, options: VoiceSynthesisOptions): Promise<ArrayBuffer> {\n    try {\n      const { voiceId, stability = 0.7, similarityBoost = 0.8, style = 0.3 } = options\n\n      const response = await fetch(\"/api/voice/synthesize\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          text,\n          voiceId,\n          stability,\n          similarityBoost,\n          style,\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error(`Speech synthesis error: ${response.status}`)\n      }\n\n      return await response.arrayBuffer()\n    } catch (error) {\n      console.error(\"Speech synthesis failed:\", error)\n      throw new Error(`Speech synthesis failed: ${error}`)\n    }\n  }\n\n  async getAvailableVoices(): Promise<VoiceProfile[]> {\n    try {\n      const response = await fetch(\"/api/voice/voices\")\n\n      if (!response.ok) {\n        throw new Error(`Failed to fetch voices: ${response.status}`)\n      }\n\n      return await response.json()\n    } catch (error) {\n      console.error(\"Failed to fetch available voices:\", error)\n      return []\n    }\n  }\n\n  async createVoiceProfile(voiceId: string): Promise<VoiceProfile> {\n    const voices = await this.getAvailableVoices()\n    const voice = voices.find((v) => v.voiceId === voiceId)\n\n    if (!voice) {\n      throw new Error(`Voice not found: ${voiceId}`)\n    }\n\n    return voice\n  }\n\n  async processAudioInput(stream: MediaStream): Promise<void> {\n    console.log(\"Processing audio input\")\n  }\n\n  setAudioLevelCallback(callback: (level: number) => void): void {\n    this.audioLevelCallback = callback\n  }\n\n  setRecognitionLanguage(language: string): void {\n    this.recognitionLanguage = language\n  }\n\n  setSynthesisLanguage(language: string): void {\n    this.synthesisLanguage = language\n  }\n\n  setVoiceProfile(profile: VoiceProfile): void {\n    this.voiceProfile = profile\n  }\n\n  getVoiceSettingsForEmotion(emotion: VoiceEmotion): Partial<VoiceSynthesisOptions> {\n    switch (emotion) {\n      case \"caring\":\n        return {\n          stability: 0.75,\n          similarityBoost: 0.85,\n          style: 0.25,\n          useSpeakerBoost: true,\n        }\n\n      case \"firm\":\n        return {\n          stability: 0.8,\n          similarityBoost: 0.7,\n          style: 0.6,\n          useSpeakerBoost: true,\n        }\n\n      case \"stern\":\n        return {\n          stability: 0.9,\n          similarityBoost: 0.6,\n          style: 0.8,\n          useSpeakerBoost: true,\n        }\n\n      case \"playful\":\n        return {\n          stability: 0.6,\n          similarityBoost: 0.8,\n          style: 0.2,\n          useSpeakerBoost: false,\n        }\n\n      case \"neutral\":\n      default:\n        return {\n          stability: 0.7,\n          similarityBoost: 0.8,\n          style: 0.4,\n          useSpeakerBoost: true,\n        }\n    }\n  }\n\n  async synthesizeCaregiverSpeech(\n    voiceId: string,\n    text: string,\n    emotion: VoiceEmotion = \"caring\",\n  ): Promise<ArrayBuffer> {\n    const voiceSettings = this.getVoiceSettingsForEmotion(emotion)\n\n    return this.synthesizeSpeech(text, {\n      voiceId,\n      ...voiceSettings,\n    })\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8451, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/VoiceControls.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useCallback, useRef } from \"react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card } from \"@/components/ui/card\"\nimport { Mic, MicOff, Volume2, VolumeX } from \"lucide-react\"\nimport { useVoiceStore } from \"@/lib/stores/voiceStore\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { ElevenLabsService } from \"@/lib/services/ElevenLabsService\"\nimport { nanoid } from \"nanoid\"\n\nexport function VoiceControls() {\n  const [isRecording, setIsRecording] = useState(false)\n  const [isMuted, setIsMuted] = useState(false)\n  const [voiceService] = useState(() => new ElevenLabsService())\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null)\n  const audioChunksRef = useRef<Blob[]>([])\n\n  const { setRecording, setAudioLevel, setLastTranscript } = useVoiceStore()\n  const addMessage = useGameStore((state) => state.addMessage)\n  const currentPlayerId = useGameStore((state) => state.currentPlayerId)\n\n  const startRecording = useCallback(async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true })\n\n      const mediaRecorder = new MediaRecorder(stream)\n      mediaRecorderRef.current = mediaRecorder\n      audioChunksRef.current = []\n\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data)\n        }\n      }\n\n      mediaRecorder.onstop = async () => {\n        const audioBlob = new Blob(audioChunksRef.current, { type: \"audio/wav\" })\n        const arrayBuffer = await audioBlob.arrayBuffer()\n\n        // Transcribe audio\n        try {\n          const result = await voiceService.recognizeSpeech(arrayBuffer)\n          console.log(\"[v0] Transcription:\", result.text)\n\n          setLastTranscript(result.text, result.confidence)\n\n          // Add message to chat\n          if (currentPlayerId) {\n            addMessage({\n              id: `msg_${nanoid()}`,\n              senderId: currentPlayerId,\n              senderName: \"You\",\n              content: result.text,\n              timestamp: Date.now(),\n              isSystem: false,\n              messageType: \"chat\",\n            })\n          }\n        } catch (error) {\n          console.error(\"[v0] Transcription failed:\", error)\n        }\n\n        // Clean up\n        stream.getTracks().forEach((track) => track.stop())\n        audioChunksRef.current = []\n      }\n\n      mediaRecorder.start()\n      setIsRecording(true)\n      setRecording(true)\n\n      // Audio level monitoring\n      if (typeof window !== \"undefined\" && \"AudioContext\" in window) {\n        const audioContext = new AudioContext()\n        const source = audioContext.createMediaStreamSource(stream)\n        const analyser = audioContext.createAnalyser()\n        analyser.fftSize = 256\n        source.connect(analyser)\n\n        const dataArray = new Uint8Array(analyser.frequencyBinCount)\n        const updateLevel = () => {\n          if (mediaRecorderRef.current?.state === \"recording\") {\n            analyser.getByteFrequencyData(dataArray)\n            const average = dataArray.reduce((a, b) => a + b) / dataArray.length\n            setAudioLevel(average / 255)\n            requestAnimationFrame(updateLevel)\n          }\n        }\n        updateLevel()\n      }\n    } catch (error) {\n      console.error(\"[v0] Failed to start recording:\", error)\n    }\n  }, [voiceService, setRecording, setAudioLevel, setLastTranscript, addMessage, currentPlayerId])\n\n  const stopRecording = useCallback(() => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === \"recording\") {\n      mediaRecorderRef.current.stop()\n      setIsRecording(false)\n      setRecording(false)\n      setAudioLevel(0)\n    }\n  }, [setRecording, setAudioLevel])\n\n  const toggleMute = useCallback(() => {\n    setIsMuted(!isMuted)\n  }, [isMuted])\n\n  return (\n    <Card className=\"absolute top-4 right-4 p-3 pointer-events-auto bg-card/90 backdrop-blur-sm\">\n      <div className=\"flex items-center gap-2\">\n        <Button\n          variant={isRecording ? \"destructive\" : \"default\"}\n          size=\"icon\"\n          onMouseDown={startRecording}\n          onMouseUp={stopRecording}\n          onTouchStart={startRecording}\n          onTouchEnd={stopRecording}\n        >\n          {isRecording ? <Mic className=\"h-4 w-4 animate-pulse\" /> : <MicOff className=\"h-4 w-4\" />}\n        </Button>\n\n        <Button variant=\"outline\" size=\"icon\" onClick={toggleMute}>\n          {isMuted ? <VolumeX className=\"h-4 w-4\" /> : <Volume2 className=\"h-4 w-4\" />}\n        </Button>\n\n        <div className=\"flex flex-col gap-1 min-w-[100px]\">\n          <div className=\"text-xs font-medium\">{isRecording ? \"Recording...\" : \"Hold to talk\"}</div>\n          {isRecording && (\n            <div className=\"h-1 bg-secondary rounded-full overflow-hidden\">\n              <div className=\"h-full bg-primary animate-pulse\" style={{ width: \"100%\" }} />\n            </div>\n          )}\n        </div>\n      </div>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;AATA;;;;;;;;;AAWO,SAAS;;IACd,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,aAAa,GAAG,IAAA,yKAAQ;kCAAC,IAAM,IAAI,4JAAiB;;IAC3D,MAAM,mBAAmB,IAAA,uKAAM,EAAuB;IACtD,MAAM,iBAAiB,IAAA,uKAAM,EAAS,EAAE;IAExC,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,iBAAiB,EAAE,GAAG,IAAA,+IAAa;IACxE,MAAM,aAAa,IAAA,6IAAY;kDAAC,CAAC,QAAU,MAAM,UAAU;;IAC3D,MAAM,kBAAkB,IAAA,6IAAY;uDAAC,CAAC,QAAU,MAAM,eAAe;;IAErE,MAAM,iBAAiB,IAAA,4KAAW;qDAAC;YACjC,IAAI;gBACF,MAAM,SAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC;oBAAE,OAAO;gBAAK;gBAEvE,MAAM,gBAAgB,IAAI,cAAc;gBACxC,iBAAiB,OAAO,GAAG;gBAC3B,eAAe,OAAO,GAAG,EAAE;gBAE3B,cAAc,eAAe;iEAAG,CAAC;wBAC/B,IAAI,MAAM,IAAI,CAAC,IAAI,GAAG,GAAG;4BACvB,eAAe,OAAO,CAAC,IAAI,CAAC,MAAM,IAAI;wBACxC;oBACF;;gBAEA,cAAc,MAAM;iEAAG;wBACrB,MAAM,YAAY,IAAI,KAAK,eAAe,OAAO,EAAE;4BAAE,MAAM;wBAAY;wBACvE,MAAM,cAAc,MAAM,UAAU,WAAW;wBAE/C,mBAAmB;wBACnB,IAAI;4BACF,MAAM,SAAS,MAAM,aAAa,eAAe,CAAC;4BAClD,QAAQ,GAAG,CAAC,uBAAuB,OAAO,IAAI;4BAE9C,kBAAkB,OAAO,IAAI,EAAE,OAAO,UAAU;4BAEhD,sBAAsB;4BACtB,IAAI,iBAAiB;gCACnB,WAAW;oCACT,IAAI,CAAC,IAAI,EAAE,IAAA,uKAAM,KAAI;oCACrB,UAAU;oCACV,YAAY;oCACZ,SAAS,OAAO,IAAI;oCACpB,WAAW,KAAK,GAAG;oCACnB,UAAU;oCACV,aAAa;gCACf;4BACF;wBACF,EAAE,OAAO,OAAO;4BACd,QAAQ,KAAK,CAAC,8BAA8B;wBAC9C;wBAEA,WAAW;wBACX,OAAO,SAAS,GAAG,OAAO;yEAAC,CAAC,QAAU,MAAM,IAAI;;wBAChD,eAAe,OAAO,GAAG,EAAE;oBAC7B;;gBAEA,cAAc,KAAK;gBACnB,eAAe;gBACf,aAAa;gBAEb,yBAAyB;gBACzB,IAAI,+CAAkB,eAAe,kBAAkB,QAAQ;oBAC7D,MAAM,eAAe,IAAI;oBACzB,MAAM,SAAS,aAAa,uBAAuB,CAAC;oBACpD,MAAM,WAAW,aAAa,cAAc;oBAC5C,SAAS,OAAO,GAAG;oBACnB,OAAO,OAAO,CAAC;oBAEf,MAAM,YAAY,IAAI,WAAW,SAAS,iBAAiB;oBAC3D,MAAM;iFAAc;4BAClB,IAAI,iBAAiB,OAAO,EAAE,UAAU,aAAa;gCACnD,SAAS,oBAAoB,CAAC;gCAC9B,MAAM,UAAU,UAAU,MAAM;6FAAC,CAAC,GAAG,IAAM,IAAI;8FAAK,UAAU,MAAM;gCACpE,cAAc,UAAU;gCACxB,sBAAsB;4BACxB;wBACF;;oBACA;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,mCAAmC;YACnD;QACF;oDAAG;QAAC;QAAc;QAAc;QAAe;QAAmB;QAAY;KAAgB;IAE9F,MAAM,gBAAgB,IAAA,4KAAW;oDAAC;YAChC,IAAI,iBAAiB,OAAO,IAAI,iBAAiB,OAAO,CAAC,KAAK,KAAK,aAAa;gBAC9E,iBAAiB,OAAO,CAAC,IAAI;gBAC7B,eAAe;gBACf,aAAa;gBACb,cAAc;YAChB;QACF;mDAAG;QAAC;QAAc;KAAc;IAEhC,MAAM,aAAa,IAAA,4KAAW;iDAAC;YAC7B,WAAW,CAAC;QACd;gDAAG;QAAC;KAAQ;IAEZ,qBACE,6LAAC,oIAAI;QAAC,WAAU;kBACd,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC,wIAAM;oBACL,SAAS,cAAc,gBAAgB;oBACvC,MAAK;oBACL,aAAa;oBACb,WAAW;oBACX,cAAc;oBACd,YAAY;8BAEX,4BAAc,6LAAC,0MAAG;wBAAC,WAAU;;;;;6CAA6B,6LAAC,uNAAM;wBAAC,WAAU;;;;;;;;;;;8BAG/E,6LAAC,wIAAM;oBAAC,SAAQ;oBAAU,MAAK;oBAAO,SAAS;8BAC5C,wBAAU,6LAAC,0NAAO;wBAAC,WAAU;;;;;6CAAe,6LAAC,0NAAO;wBAAC,WAAU;;;;;;;;;;;8BAGlE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;sCAAuB,cAAc,iBAAiB;;;;;;wBACpE,6BACC,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAI,WAAU;gCAAkC,OAAO;oCAAE,OAAO;gCAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOtF;GA/HgB;;QAO6C,+IAAa;QACrD,6IAAY;QACP,6IAAY;;;KATtB"}},
    {"offset": {"line": 8715, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/VoiceVisualizer.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { useVoiceStore } from \"@/lib/stores/voiceStore\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\n\nexport function VoiceVisualizer() {\n  const audioLevel = useVoiceStore((state) => state.audioLevel)\n  const playersMap = useGameStore((state) => state.players)\n  const caregiversMap = useGameStore((state) => state.caregivers)\n\n  const players = useMemo(() => Array.from(playersMap.values()), [playersMap])\n  const caregivers = useMemo(() => Array.from(caregiversMap.values()), [caregiversMap])\n\n  const activeSpeakers = useMemo(\n    () =>\n      [...players, ...caregivers].filter(\n        (entity) => entity.lastVoiceActivity && Date.now() - entity.lastVoiceActivity < 2000,\n      ),\n    [players, caregivers],\n  )\n\n  if (activeSpeakers.length === 0 && audioLevel === 0) return null\n\n  return (\n    <div className=\"fixed top-20 right-4 pointer-events-none\">\n      <div className=\"flex flex-col gap-2\">\n        {activeSpeakers.map((speaker) => (\n          <div\n            key={speaker.id}\n            className=\"bg-primary/20 backdrop-blur-sm rounded-lg px-3 py-2 flex items-center gap-2 animate-pulse\"\n          >\n            <div className=\"w-2 h-2 bg-primary rounded-full\" />\n            <span className=\"text-sm font-medium text-foreground\">{speaker.name} is speaking</span>\n          </div>\n        ))}\n\n        {audioLevel > 0 && (\n          <div className=\"bg-secondary/20 backdrop-blur-sm rounded-lg px-3 py-2\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex gap-1\">\n                {Array.from({ length: 5 }).map((_, i) => (\n                  <div\n                    key={i}\n                    className=\"w-1 bg-primary rounded-full transition-all\"\n                    style={{\n                      height: audioLevel * 100 > i * 20 ? `${(i + 1) * 4}px` : \"4px\",\n                    }}\n                  />\n                ))}\n              </div>\n              <span className=\"text-xs text-muted-foreground\">Your mic</span>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMO,SAAS;;IACd,MAAM,aAAa,IAAA,+IAAa;qDAAC,CAAC,QAAU,MAAM,UAAU;;IAC5D,MAAM,aAAa,IAAA,6IAAY;oDAAC,CAAC,QAAU,MAAM,OAAO;;IACxD,MAAM,gBAAgB,IAAA,6IAAY;uDAAC,CAAC,QAAU,MAAM,UAAU;;IAE9D,MAAM,UAAU,IAAA,wKAAO;4CAAC,IAAM,MAAM,IAAI,CAAC,WAAW,MAAM;2CAAK;QAAC;KAAW;IAC3E,MAAM,aAAa,IAAA,wKAAO;+CAAC,IAAM,MAAM,IAAI,CAAC,cAAc,MAAM;8CAAK;QAAC;KAAc;IAEpF,MAAM,iBAAiB,IAAA,wKAAO;mDAC5B,IACE;mBAAI;mBAAY;aAAW,CAAC,MAAM;2DAChC,CAAC,SAAW,OAAO,iBAAiB,IAAI,KAAK,GAAG,KAAK,OAAO,iBAAiB,GAAG;;kDAEpF;QAAC;QAAS;KAAW;IAGvB,IAAI,eAAe,MAAM,KAAK,KAAK,eAAe,GAAG,OAAO;IAE5D,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;gBACZ,eAAe,GAAG,CAAC,CAAC,wBACnB,6LAAC;wBAEC,WAAU;;0CAEV,6LAAC;gCAAI,WAAU;;;;;;0CACf,6LAAC;gCAAK,WAAU;;oCAAuC,QAAQ,IAAI;oCAAC;;;;;;;;uBAJ/D,QAAQ,EAAE;;;;;gBAQlB,aAAa,mBACZ,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACZ,MAAM,IAAI,CAAC;oCAAE,QAAQ;gCAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,6LAAC;wCAEC,WAAU;wCACV,OAAO;4CACL,QAAQ,aAAa,MAAM,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,GAAG;wCAC3D;uCAJK;;;;;;;;;;0CAQX,6LAAC;gCAAK,WAAU;0CAAgC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO9D;GApDgB;;QACK,+IAAa;QACb,6IAAY;QACT,6IAAY;;;KAHpB"}},
    {"offset": {"line": 8866, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/TranscriptDisplay.tsx"],"sourcesContent":["\"use client\"\n\nimport { useVoiceStore } from \"@/lib/stores/voiceStore\"\nimport { Card } from \"@/components/ui/card\"\n\nexport function TranscriptDisplay() {\n  const lastTranscript = useVoiceStore((state) => state.lastTranscript)\n  const transcriptConfidence = useVoiceStore((state) => state.transcriptConfidence)\n\n  if (!lastTranscript) return null\n\n  return (\n    <Card className=\"fixed bottom-32 left-1/2 -translate-x-1/2 p-3 max-w-[500px] pointer-events-auto bg-card/90 backdrop-blur-sm\">\n      <div className=\"flex flex-col gap-1\">\n        <div className=\"text-xs text-muted-foreground flex justify-between\">\n          <span>You said:</span>\n          <span>Confidence: {Math.round(transcriptConfidence * 100)}%</span>\n        </div>\n        <div className=\"text-sm text-foreground\">{lastTranscript}</div>\n      </div>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKO,SAAS;;IACd,MAAM,iBAAiB,IAAA,+IAAa;2DAAC,CAAC,QAAU,MAAM,cAAc;;IACpE,MAAM,uBAAuB,IAAA,+IAAa;iEAAC,CAAC,QAAU,MAAM,oBAAoB;;IAEhF,IAAI,CAAC,gBAAgB,OAAO;IAE5B,qBACE,6LAAC,oIAAI;QAAC,WAAU;kBACd,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;sCAAK;;;;;;sCACN,6LAAC;;gCAAK;gCAAa,KAAK,KAAK,CAAC,uBAAuB;gCAAK;;;;;;;;;;;;;8BAE5D,6LAAC;oBAAI,WAAU;8BAA2B;;;;;;;;;;;;;;;;;AAIlD;GAjBgB;;QACS,+IAAa;QACP,+IAAa;;;KAF5B"}},
    {"offset": {"line": 8955, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/dialog.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\nimport { XIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\n          className,\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn('text-lg leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6LAAC,gLAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,6LAAC,+KAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,6LAAC;QAAa,aAAU;;0BACtB,6LAAC;;;;;0BACD,6LAAC,gLAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,qHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,6LAAC,8KAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,6LAAC,4MAAK;;;;;0CACN,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;MAhCS;AAkCT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6LAAC,oLAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 9161, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/utils/paywall.ts"],"sourcesContent":["/**\n * Paywall utilities for daycare creation\n */\n\nexport interface PaywallOptions {\n  price: number\n  adDuration: number // in seconds\n  trialDays: number\n}\n\nexport const DAYCARE_PAYWALL: PaywallOptions = {\n  price: 9.99,\n  adDuration: 30, // 30 second ad\n  trialDays: 7,\n}\n\nexport async function processPayment(userId: string): Promise<boolean> {\n  // Integration with payment processor (Stripe, etc.)\n  try {\n    // Placeholder for actual payment processing\n    console.log(\"[v0] Processing payment for user:\", userId)\n    return true\n  } catch (error) {\n    console.error(\"[v0] Payment processing failed:\", error)\n    return false\n  }\n}\n\nexport async function watchAdvertisement(): Promise<boolean> {\n  // Integration with ad network\n  try {\n    console.log(\"[v0] Loading advertisement...\")\n    // Placeholder - would integrate with Google AdMob, Unity Ads, etc.\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        console.log(\"[v0] Advertisement completed\")\n        resolve(true)\n      }, DAYCARE_PAYWALL.adDuration * 1000)\n    })\n  } catch (error) {\n    console.error(\"[v0] Advertisement failed:\", error)\n    return false\n  }\n}\n\nexport function hasValidDaycareAccess(createdAt: number, trialEndDate?: number, isPaid = false): boolean {\n  if (isPaid) return true\n\n  if (trialEndDate) {\n    return Date.now() < trialEndDate\n  }\n\n  const trialEnd = createdAt + DAYCARE_PAYWALL.trialDays * 24 * 60 * 60 * 1000\n  return Date.now() < trialEnd\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;AAQM,MAAM,kBAAkC;IAC7C,OAAO;IACP,YAAY;IACZ,WAAW;AACb;AAEO,eAAe,eAAe,MAAc;IACjD,oDAAoD;IACpD,IAAI;QACF,4CAA4C;QAC5C,QAAQ,GAAG,CAAC,qCAAqC;QACjD,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;AAEO,eAAe;IACpB,8BAA8B;IAC9B,IAAI;QACF,QAAQ,GAAG,CAAC;QACZ,mEAAmE;QACnE,OAAO,IAAI,QAAQ,CAAC;YAClB,WAAW;gBACT,QAAQ,GAAG,CAAC;gBACZ,QAAQ;YACV,GAAG,gBAAgB,UAAU,GAAG;QAClC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;AACF;AAEO,SAAS,sBAAsB,SAAiB,EAAE,YAAqB,EAAE,SAAS,KAAK;IAC5F,IAAI,QAAQ,OAAO;IAEnB,IAAI,cAAc;QAChB,OAAO,KAAK,GAAG,KAAK;IACtB;IAEA,MAAM,WAAW,YAAY,gBAAgB,SAAS,GAAG,KAAK,KAAK,KAAK;IACxE,OAAO,KAAK,GAAG,KAAK;AACtB"}},
    {"offset": {"line": 9220, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/PaywallDialog.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card } from \"@/components/ui/card\"\nimport { Loader2, Play, DollarSign } from \"lucide-react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { DAYCARE_PAYWALL, processPayment, watchAdvertisement } from \"@/lib/utils/paywall\"\n\nexport function PaywallDialog() {\n  const showPaywall = useGameStore((state) => state.showPaywall)\n  const setShowPaywall = useGameStore((state) => state.setShowPaywall)\n  const [isProcessing, setIsProcessing] = useState(false)\n  const [paymentMethod, setPaymentMethod] = useState<\"payment\" | \"ad\" | null>(null)\n\n  const handlePayment = async () => {\n    setIsProcessing(true)\n    setPaymentMethod(\"payment\")\n\n    try {\n      const success = await processPayment(\"user_demo\")\n\n      if (success) {\n        setShowPaywall(false)\n        // Would grant access to daycare creation\n        console.log(\"[v0] Payment successful - daycare access granted\")\n      } else {\n        console.error(\"[v0] Payment failed\")\n      }\n    } catch (error) {\n      console.error(\"[v0] Payment error:\", error)\n    } finally {\n      setIsProcessing(false)\n      setPaymentMethod(null)\n    }\n  }\n\n  const handleWatchAd = async () => {\n    setIsProcessing(true)\n    setPaymentMethod(\"ad\")\n\n    try {\n      const success = await watchAdvertisement()\n\n      if (success) {\n        setShowPaywall(false)\n        // Would grant access to daycare creation\n        console.log(\"[v0] Ad completed - daycare access granted\")\n      } else {\n        console.error(\"[v0] Ad failed or was skipped\")\n      }\n    } catch (error) {\n      console.error(\"[v0] Ad error:\", error)\n    } finally {\n      setIsProcessing(false)\n      setPaymentMethod(null)\n    }\n  }\n\n  return (\n    <Dialog open={showPaywall} onOpenChange={setShowPaywall}>\n      <DialogContent className=\"sm:max-w-[500px] bg-background\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl font-bold text-foreground\">Create Your Daycare</DialogTitle>\n          <DialogDescription className=\"text-muted-foreground\">\n            Choose how you'd like to unlock daycare creation and start welcoming little ones\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"flex flex-col gap-4 mt-4\">\n          {/* Payment Option */}\n          <Card className=\"p-6 border-2 border-primary/20 hover:border-primary/40 transition-colors\">\n            <div className=\"flex flex-col gap-4\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex flex-col gap-1\">\n                  <h3 className=\"text-lg font-semibold text-foreground flex items-center gap-2\">\n                    <DollarSign className=\"h-5 w-5 text-primary\" />\n                    One-Time Payment\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground\">Instant access, no ads</p>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"text-2xl font-bold text-primary\">${DAYCARE_PAYWALL.price}</div>\n                  <div className=\"text-xs text-muted-foreground\">One-time fee</div>\n                </div>\n              </div>\n\n              <ul className=\"flex flex-col gap-2 text-sm text-muted-foreground\">\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-primary\" />\n                  <span>Lifetime access to daycare creation</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-primary\" />\n                  <span>No advertisements</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-primary\" />\n                  <span>Support development</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-primary\" />\n                  <span>Priority customer support</span>\n                </li>\n              </ul>\n\n              <Button onClick={handlePayment} disabled={isProcessing} className=\"w-full bg-primary hover:bg-primary/90\">\n                {isProcessing && paymentMethod === \"payment\" ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Processing...\n                  </>\n                ) : (\n                  \"Purchase Now\"\n                )}\n              </Button>\n            </div>\n          </Card>\n\n          {/* Ad Option */}\n          <Card className=\"p-6 border-2 border-secondary/20 hover:border-secondary/40 transition-colors\">\n            <div className=\"flex flex-col gap-4\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex flex-col gap-1\">\n                  <h3 className=\"text-lg font-semibold text-foreground flex items-center gap-2\">\n                    <Play className=\"h-5 w-5 text-secondary\" />\n                    Watch Advertisement\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground\">Free access after watching</p>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"text-2xl font-bold text-secondary\">FREE</div>\n                  <div className=\"text-xs text-muted-foreground\">{DAYCARE_PAYWALL.adDuration}s ad</div>\n                </div>\n              </div>\n\n              <ul className=\"flex flex-col gap-2 text-sm text-muted-foreground\">\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-secondary\" />\n                  <span>Watch a {DAYCARE_PAYWALL.adDuration}-second advertisement</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-secondary\" />\n                  <span>Get {DAYCARE_PAYWALL.trialDays}-day trial access</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-secondary\" />\n                  <span>No payment required</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-secondary\" />\n                  <span>Can upgrade to premium anytime</span>\n                </li>\n              </ul>\n\n              <Button onClick={handleWatchAd} disabled={isProcessing} variant=\"secondary\" className=\"w-full\">\n                {isProcessing && paymentMethod === \"ad\" ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Loading Ad...\n                  </>\n                ) : (\n                  \"Watch Ad & Start Trial\"\n                )}\n              </Button>\n            </div>\n          </Card>\n\n          <div className=\"text-center text-xs text-muted-foreground\">\n            <p>\n              By proceeding, you agree to our Terms of Service and Privacy Policy.\n              <br />\n              Payment processed securely through Stripe.\n            </p>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9808, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/TrialBanner.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { Card } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Clock, Sparkles } from \"lucide-react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { hasValidDaycareAccess } from \"@/lib/utils/paywall\"\n\nexport function TrialBanner() {\n  const currentLobby = useGameStore((state) => state.currentLobby)\n  const setShowPaywall = useGameStore((state) => state.setShowPaywall)\n  const [daysRemaining, setDaysRemaining] = useState(0)\n  const [isVisible, setIsVisible] = useState(false)\n\n  useEffect(() => {\n    if (!currentLobby || !currentLobby.trialEndDate) {\n      setIsVisible(false)\n      return\n    }\n\n    const hasAccess = hasValidDaycareAccess(currentLobby.createdAt, currentLobby.trialEndDate, false)\n    const remaining = Math.ceil((currentLobby.trialEndDate - Date.now()) / (1000 * 60 * 60 * 24))\n\n    setDaysRemaining(remaining)\n    setIsVisible(hasAccess && remaining <= 3) // Show when 3 or fewer days remain\n  }, [currentLobby])\n\n  if (!isVisible || daysRemaining <= 0) return null\n\n  return (\n    <Card className=\"fixed top-20 left-1/2 -translate-x-1/2 p-4 pointer-events-auto bg-accent/90 backdrop-blur-sm border-2 border-primary/30 max-w-[400px]\">\n      <div className=\"flex items-center gap-3\">\n        <div className=\"p-2 bg-primary/20 rounded-full\">\n          <Clock className=\"h-5 w-5 text-primary\" />\n        </div>\n\n        <div className=\"flex-1\">\n          <h4 className=\"font-semibold text-foreground flex items-center gap-1\">\n            Trial Ending Soon\n            {daysRemaining <= 1 && <Sparkles className=\"h-3 w-3 text-primary animate-pulse\" />}\n          </h4>\n          <p className=\"text-sm text-muted-foreground\">\n            {daysRemaining === 1 ? \"1 day\" : `${daysRemaining} days`} left in your free trial\n          </p>\n        </div>\n\n        <Button size=\"sm\" onClick={() => setShowPaywall(true)} className=\"bg-primary hover:bg-primary/90\">\n          Upgrade\n        </Button>\n      </div>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;;;AAPA;;;;;;;AASO,SAAS;;IACd,MAAM,eAAe,IAAA,6IAAY;kDAAC,CAAC,QAAU,MAAM,YAAY;;IAC/D,MAAM,iBAAiB,IAAA,6IAAY;oDAAC,CAAC,QAAU,MAAM,cAAc;;IACnE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;iCAAC;YACR,IAAI,CAAC,gBAAgB,CAAC,aAAa,YAAY,EAAE;gBAC/C,aAAa;gBACb;YACF;YAEA,MAAM,YAAY,IAAA,mJAAqB,EAAC,aAAa,SAAS,EAAE,aAAa,YAAY,EAAE;YAC3F,MAAM,YAAY,KAAK,IAAI,CAAC,CAAC,aAAa,YAAY,GAAG,KAAK,GAAG,EAAE,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;YAE3F,iBAAiB;YACjB,aAAa,aAAa,aAAa,IAAG,mCAAmC;QAC/E;gCAAG;QAAC;KAAa;IAEjB,IAAI,CAAC,aAAa,iBAAiB,GAAG,OAAO;IAE7C,qBACE,6LAAC,oIAAI;QAAC,WAAU;kBACd,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,gNAAK;wBAAC,WAAU;;;;;;;;;;;8BAGnB,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;;gCAAwD;gCAEnE,iBAAiB,mBAAK,6LAAC,yNAAQ;oCAAC,WAAU;;;;;;;;;;;;sCAE7C,6LAAC;4BAAE,WAAU;;gCACV,kBAAkB,IAAI,UAAU,GAAG,cAAc,KAAK,CAAC;gCAAC;;;;;;;;;;;;;8BAI7D,6LAAC,wIAAM;oBAAC,MAAK;oBAAK,SAAS,IAAM,eAAe;oBAAO,WAAU;8BAAiC;;;;;;;;;;;;;;;;;AAM1G;GA5CgB;;QACO,6IAAY;QACV,6IAAY;;;KAFrB"}},
    {"offset": {"line": 9948, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/DaycareCreationButton.tsx"],"sourcesContent":["\"use client\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { PlusCircle } from \"lucide-react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { hasValidDaycareAccess } from \"@/lib/utils/paywall\"\n\nexport function DaycareCreationButton() {\n  const currentLobby = useGameStore((state) => state.currentLobby)\n  const setShowPaywall = useGameStore((state) => state.setShowPaywall)\n\n  const handleCreateDaycare = () => {\n    // Check if user has valid access\n    const hasAccess = currentLobby\n      ? hasValidDaycareAccess(currentLobby.createdAt, currentLobby.trialEndDate, false)\n      : false\n\n    if (hasAccess) {\n      // Create daycare\n      console.log(\"[v0] Creating daycare...\")\n      // Would show daycare creation modal\n    } else {\n      // Show paywall\n      setShowPaywall(true)\n    }\n  }\n\n  return (\n    <Button onClick={handleCreateDaycare} className=\"gap-2 bg-primary hover:bg-primary/90\">\n      <PlusCircle className=\"h-4 w-4\" />\n      Create Daycare\n    </Button>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAOO,SAAS;;IACd,MAAM,eAAe,IAAA,6IAAY;4DAAC,CAAC,QAAU,MAAM,YAAY;;IAC/D,MAAM,iBAAiB,IAAA,6IAAY;8DAAC,CAAC,QAAU,MAAM,cAAc;;IAEnE,MAAM,sBAAsB;QAC1B,iCAAiC;QACjC,MAAM,YAAY,eACd,IAAA,mJAAqB,EAAC,aAAa,SAAS,EAAE,aAAa,YAAY,EAAE,SACzE;QAEJ,IAAI,WAAW;YACb,iBAAiB;YACjB,QAAQ,GAAG,CAAC;QACZ,oCAAoC;QACtC,OAAO;YACL,eAAe;YACf,eAAe;QACjB;IACF;IAEA,qBACE,6LAAC,wIAAM;QAAC,SAAS;QAAqB,WAAU;;0BAC9C,6LAAC,mOAAU;gBAAC,WAAU;;;;;;YAAY;;;;;;;AAIxC;GA1BgB;;QACO,6IAAY;QACV,6IAAY;;;KAFrB"}},
    {"offset": {"line": 10019, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/components/ui/SubscriptionStatus.tsx"],"sourcesContent":["\"use client\"\n\nimport { Card } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Crown, Calendar, AlertCircle } from \"lucide-react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { hasValidDaycareAccess } from \"@/lib/utils/paywall\"\n\nexport function SubscriptionStatus() {\n  const currentLobby = useGameStore((state) => state.currentLobby)\n  const setShowPaywall = useGameStore((state) => state.setShowPaywall)\n\n  if (!currentLobby) return null\n\n  const isPaid = false // Would check actual payment status\n  const hasAccess = hasValidDaycareAccess(currentLobby.createdAt, currentLobby.trialEndDate, isPaid)\n  const isExpired = currentLobby.trialEndDate && Date.now() > currentLobby.trialEndDate\n\n  if (isPaid) {\n    return (\n      <Card className=\"p-4 bg-primary/10 border-primary/30\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"p-2 bg-primary/20 rounded-full\">\n            <Crown className=\"h-5 w-5 text-primary\" />\n          </div>\n          <div className=\"flex-1\">\n            <h4 className=\"font-semibold text-foreground\">Premium Member</h4>\n            <p className=\"text-sm text-muted-foreground\">Thank you for your support!</p>\n          </div>\n        </div>\n      </Card>\n    )\n  }\n\n  if (isExpired) {\n    return (\n      <Card className=\"p-4 bg-destructive/10 border-destructive/30\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"p-2 bg-destructive/20 rounded-full\">\n            <AlertCircle className=\"h-5 w-5 text-destructive\" />\n          </div>\n          <div className=\"flex-1\">\n            <h4 className=\"font-semibold text-foreground\">Trial Expired</h4>\n            <p className=\"text-sm text-muted-foreground\">Upgrade to continue using daycare features</p>\n          </div>\n          <Button size=\"sm\" onClick={() => setShowPaywall(true)} className=\"bg-primary hover:bg-primary/90\">\n            Upgrade Now\n          </Button>\n        </div>\n      </Card>\n    )\n  }\n\n  if (currentLobby.trialEndDate) {\n    const daysRemaining = Math.ceil((currentLobby.trialEndDate - Date.now()) / (1000 * 60 * 60 * 24))\n\n    return (\n      <Card className=\"p-4 bg-secondary/10 border-secondary/30\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"p-2 bg-secondary/20 rounded-full\">\n            <Calendar className=\"h-5 w-5 text-secondary\" />\n          </div>\n          <div className=\"flex-1\">\n            <h4 className=\"font-semibold text-foreground\">Free Trial Active</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              {daysRemaining} {daysRemaining === 1 ? \"day\" : \"days\"} remaining\n            </p>\n          </div>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={() => setShowPaywall(true)}\n            className=\"border-primary text-primary hover:bg-primary/10\"\n          >\n            Upgrade\n          </Button>\n        </div>\n      </Card>\n    )\n  }\n\n  return null\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AACA;AACA;;;AANA;;;;;;AAQO,SAAS;;IACd,MAAM,eAAe,IAAA,6IAAY;yDAAC,CAAC,QAAU,MAAM,YAAY;;IAC/D,MAAM,iBAAiB,IAAA,6IAAY;2DAAC,CAAC,QAAU,MAAM,cAAc;;IAEnE,IAAI,CAAC,cAAc,OAAO;IAE1B,MAAM,SAAS,MAAM,oCAAoC;;IACzD,MAAM,YAAY,IAAA,mJAAqB,EAAC,aAAa,SAAS,EAAE,aAAa,YAAY,EAAE;IAC3F,MAAM,YAAY,aAAa,YAAY,IAAI,KAAK,GAAG,KAAK,aAAa,YAAY;IAErF;;IAgBA,IAAI,WAAW;QACb,qBACE,6LAAC,oIAAI;YAAC,WAAU;sBACd,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,sOAAW;4BAAC,WAAU;;;;;;;;;;;kCAEzB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAgC;;;;;;0CAC9C,6LAAC;gCAAE,WAAU;0CAAgC;;;;;;;;;;;;kCAE/C,6LAAC,wIAAM;wBAAC,MAAK;wBAAK,SAAS,IAAM,eAAe;wBAAO,WAAU;kCAAiC;;;;;;;;;;;;;;;;;IAM1G;IAEA,IAAI,aAAa,YAAY,EAAE;QAC7B,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAC,aAAa,YAAY,GAAG,KAAK,GAAG,EAAE,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;QAE/F,qBACE,6LAAC,oIAAI;YAAC,WAAU;sBACd,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,yNAAQ;4BAAC,WAAU;;;;;;;;;;;kCAEtB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAgC;;;;;;0CAC9C,6LAAC;gCAAE,WAAU;;oCACV;oCAAc;oCAAE,kBAAkB,IAAI,QAAQ;oCAAO;;;;;;;;;;;;;kCAG1D,6LAAC,wIAAM;wBACL,MAAK;wBACL,SAAQ;wBACR,SAAS,IAAM,eAAe;wBAC9B,WAAU;kCACX;;;;;;;;;;;;;;;;;IAMT;IAEA,OAAO;AACT;GA1EgB;;QACO,6IAAY;QACV,6IAAY;;;KAFrB"}},
    {"offset": {"line": 10212, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/hooks/useAICaregivers.ts"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useRef } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { nanoid } from \"nanoid\"\nimport type { Caregiver } from \"@/lib/types/gameTypes\"\n\nexport function useAICaregivers() {\n  const hasInitialized = useRef(false)\n\n  useEffect(() => {\n    if (hasInitialized.current) return\n    hasInitialized.current = true\n\n    // Use setTimeout to defer spawning to next tick, avoiding render cycle\n    const timeoutId = setTimeout(() => {\n      const state = useGameStore.getState()\n      const playerCount = state.players.size\n      const caregiverCount = state.caregivers.size\n      const neededCaregivers = Math.max(1, Math.ceil(Math.max(1, playerCount) / 4))\n\n      if (caregiverCount < neededCaregivers) {\n        const toSpawn = neededCaregivers - caregiverCount\n        for (let i = 0; i < toSpawn; i++) {\n          const caregiver = createAICaregiver(caregiverCount + i)\n          useGameStore.getState().addCaregiver(caregiver)\n        }\n      }\n    }, 0)\n\n    return () => clearTimeout(timeoutId)\n  }, [])\n}\n\nfunction createAICaregiver(index: number): Caregiver {\n  const personalities = [\n    { name: \"Miss Sophie\", strictness: 60, nurturing: 70 },\n    { name: \"Mr. James\", strictness: 75, nurturing: 55 },\n    { name: \"Miss Emily\", strictness: 45, nurturing: 85 },\n    { name: \"Mr. David\", strictness: 80, nurturing: 50 },\n    { name: \"Miss Rachel\", strictness: 55, nurturing: 75 },\n  ]\n\n  const personality = personalities[index % personalities.length]\n\n  return {\n    id: `ai_caregiver_${nanoid()}`,\n    name: personality.name,\n    role: \"caregiver\",\n    gender: personality.name.startsWith(\"Miss\") ? \"female\" : \"male\",\n    adminRole: \"mod\",\n    character: {\n      skinColor: \"#F5D0C5\",\n      ageGroup: \"12+\",\n      hairColor: \"#8B4513\",\n      eyeColor: \"#4A90E2\",\n    },\n    clothing: {\n      shirt: true,\n      pants: true,\n      socks: true,\n      shoes: true,\n      underwearType: \"underwear\",\n      underwearState: \"clean\",\n      diaperFillLevel: 0,\n      pacifierIn: false,\n    },\n    needs: {\n      bladder: 0,\n      bowel: 0,\n      hunger: 0,\n    },\n    position: {\n      x: (Math.random() - 0.5) * 20,\n      y: 0,\n      z: (Math.random() - 0.5) * 20,\n    },\n    rotation: Math.random() * Math.PI * 2,\n    disciplineStatus: \"green\",\n    alignment: \"little_angel\",\n    isInTimeout: false,\n    isBeingLed: false,\n    currentAnimation: \"walk\",\n    privileges: [\"all\"],\n    rewards: [],\n    punishments: [],\n    personality: {\n      strictness: personality.strictness,\n      nurturing: personality.nurturing,\n      patience: 60 + Math.random() * 20,\n      fairness: 75 + Math.random() * 15,\n      responsiveness: 70 + Math.random() * 20,\n    },\n    perception: {\n      visibleEntities: [],\n      distances: new Map(),\n      occluded: false,\n      audioEvents: [],\n    },\n    worldState: {\n      navmesh: null,\n      hazards: [],\n      interactables: new Map(),\n    },\n    currentIntent: {\n      goals: [],\n      constraints: [],\n      cooldowns: new Map(),\n    },\n    voiceProfile: {\n      provider: \"elevenlabs\",\n      voiceId: `caregiver_voice_${index}`,\n      pitch: 1.0,\n      speed: 1.0,\n      emotion: \"caring\",\n      recognitionProvider: \"openai\",\n      synthesisProvider: \"elevenlabs\",\n    },\n    isAI: true,\n    lastDecisionTime: Date.now(),\n  }\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAOO,SAAS;;IACd,MAAM,iBAAiB,IAAA,uKAAM,EAAC;IAE9B,IAAA,0KAAS;qCAAC;YACR,IAAI,eAAe,OAAO,EAAE;YAC5B,eAAe,OAAO,GAAG;YAEzB,uEAAuE;YACvE,MAAM,YAAY;uDAAW;oBAC3B,MAAM,QAAQ,6IAAY,CAAC,QAAQ;oBACnC,MAAM,cAAc,MAAM,OAAO,CAAC,IAAI;oBACtC,MAAM,iBAAiB,MAAM,UAAU,CAAC,IAAI;oBAC5C,MAAM,mBAAmB,KAAK,GAAG,CAAC,GAAG,KAAK,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,eAAe;oBAE1E,IAAI,iBAAiB,kBAAkB;wBACrC,MAAM,UAAU,mBAAmB;wBACnC,IAAK,IAAI,IAAI,GAAG,IAAI,SAAS,IAAK;4BAChC,MAAM,YAAY,kBAAkB,iBAAiB;4BACrD,6IAAY,CAAC,QAAQ,GAAG,YAAY,CAAC;wBACvC;oBACF;gBACF;sDAAG;YAEH;6CAAO,IAAM,aAAa;;QAC5B;oCAAG,EAAE;AACP;GAzBgB;AA2BhB,SAAS,kBAAkB,KAAa;IACtC,MAAM,gBAAgB;QACpB;YAAE,MAAM;YAAe,YAAY;YAAI,WAAW;QAAG;QACrD;YAAE,MAAM;YAAa,YAAY;YAAI,WAAW;QAAG;QACnD;YAAE,MAAM;YAAc,YAAY;YAAI,WAAW;QAAG;QACpD;YAAE,MAAM;YAAa,YAAY;YAAI,WAAW;QAAG;QACnD;YAAE,MAAM;YAAe,YAAY;YAAI,WAAW;QAAG;KACtD;IAED,MAAM,cAAc,aAAa,CAAC,QAAQ,cAAc,MAAM,CAAC;IAE/D,OAAO;QACL,IAAI,CAAC,aAAa,EAAE,IAAA,uKAAM,KAAI;QAC9B,MAAM,YAAY,IAAI;QACtB,MAAM;QACN,QAAQ,YAAY,IAAI,CAAC,UAAU,CAAC,UAAU,WAAW;QACzD,WAAW;QACX,WAAW;YACT,WAAW;YACX,UAAU;YACV,WAAW;YACX,UAAU;QACZ;QACA,UAAU;YACR,OAAO;YACP,OAAO;YACP,OAAO;YACP,OAAO;YACP,eAAe;YACf,gBAAgB;YAChB,iBAAiB;YACjB,YAAY;QACd;QACA,OAAO;YACL,SAAS;YACT,OAAO;YACP,QAAQ;QACV;QACA,UAAU;YACR,GAAG,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI;YAC3B,GAAG;YACH,GAAG,CAAC,KAAK,MAAM,KAAK,GAAG,IAAI;QAC7B;QACA,UAAU,KAAK,MAAM,KAAK,KAAK,EAAE,GAAG;QACpC,kBAAkB;QAClB,WAAW;QACX,aAAa;QACb,YAAY;QACZ,kBAAkB;QAClB,YAAY;YAAC;SAAM;QACnB,SAAS,EAAE;QACX,aAAa,EAAE;QACf,aAAa;YACX,YAAY,YAAY,UAAU;YAClC,WAAW,YAAY,SAAS;YAChC,UAAU,KAAK,KAAK,MAAM,KAAK;YAC/B,UAAU,KAAK,KAAK,MAAM,KAAK;YAC/B,gBAAgB,KAAK,KAAK,MAAM,KAAK;QACvC;QACA,YAAY;YACV,iBAAiB,EAAE;YACnB,WAAW,IAAI;YACf,UAAU;YACV,aAAa,EAAE;QACjB;QACA,YAAY;YACV,SAAS;YACT,SAAS,EAAE;YACX,eAAe,IAAI;QACrB;QACA,eAAe;YACb,OAAO,EAAE;YACT,aAAa,EAAE;YACf,WAAW,IAAI;QACjB;QACA,cAAc;YACZ,UAAU;YACV,SAAS,CAAC,gBAAgB,EAAE,OAAO;YACnC,OAAO;YACP,OAAO;YACP,SAAS;YACT,qBAAqB;YACrB,mBAAmB;QACrB;QACA,MAAM;QACN,kBAAkB,KAAK,GAAG;IAC5B;AACF"}},
    {"offset": {"line": 10369, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/lib/hooks/useVoiceCommunication.ts"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useRef, useState, useCallback } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { ElevenLabsService } from \"@/lib/services/ElevenLabsService\"\n\nexport function useVoiceCommunication() {\n  const messageCount = useGameStore((state) => state.messages.length)\n  const lastMessageId = useGameStore((state) => state.messages[state.messages.length - 1]?.id)\n  const caregiversMap = useGameStore((state) => state.caregivers)\n\n  const [voiceService] = useState(() => new ElevenLabsService())\n  const lastProcessedMessage = useRef<string | null>(null)\n  const audioContextRef = useRef<AudioContext | null>(null)\n\n  // Stable function to get caregiver\n  const getCaregiver = useCallback((id: string) => caregiversMap.get(id), [caregiversMap])\n\n  // Initialize audio context\n  useEffect(() => {\n    if (typeof window !== \"undefined\" && \"AudioContext\" in window) {\n      audioContextRef.current = new AudioContext()\n    }\n\n    return () => {\n      audioContextRef.current?.close()\n    }\n  }, [])\n\n  useEffect(() => {\n    if (!audioContextRef.current || !lastMessageId || messageCount === 0) return\n\n    if (lastMessageId === lastProcessedMessage.current) return\n\n    // Get latest message from store\n    const messages = useGameStore.getState().messages\n    const latestMessage = messages[messages.length - 1]\n    if (!latestMessage) return\n\n    const caregiver = getCaregiver(latestMessage.senderId)\n    if (!caregiver) return\n\n    lastProcessedMessage.current = lastMessageId\n\n    // Synthesize speech\n    const voiceSettings = voiceService.getVoiceSettingsForEmotion(caregiver.voiceProfile.emotion)\n\n    voiceService\n      .synthesizeSpeech(latestMessage.content, {\n        voiceId: caregiver.voiceProfile.voiceId,\n        ...voiceSettings,\n      })\n      .then(async (audioData) => {\n        if (!audioContextRef.current || audioData.byteLength === 0) return\n\n        try {\n          const audioBuffer = await audioContextRef.current.decodeAudioData(audioData)\n          const source = audioContextRef.current.createBufferSource()\n          source.buffer = audioBuffer\n          source.connect(audioContextRef.current.destination)\n          source.start()\n        } catch (error) {\n          console.error(\"[v0] Failed to play audio:\", error)\n        }\n      })\n      .catch((error) => {\n        console.error(\"[v0] Failed to synthesize speech:\", error)\n      })\n  }, [lastMessageId, messageCount, voiceService, getCaregiver])\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAMO,SAAS;;IACd,MAAM,eAAe,IAAA,6IAAY;4DAAC,CAAC,QAAU,MAAM,QAAQ,CAAC,MAAM;;IAClE,MAAM,gBAAgB,IAAA,6IAAY;6DAAC,CAAC,QAAU,MAAM,QAAQ,CAAC,MAAM,QAAQ,CAAC,MAAM,GAAG,EAAE,EAAE;;IACzF,MAAM,gBAAgB,IAAA,6IAAY;6DAAC,CAAC,QAAU,MAAM,UAAU;;IAE9D,MAAM,CAAC,aAAa,GAAG,IAAA,yKAAQ;0CAAC,IAAM,IAAI,4JAAiB;;IAC3D,MAAM,uBAAuB,IAAA,uKAAM,EAAgB;IACnD,MAAM,kBAAkB,IAAA,uKAAM,EAAsB;IAEpD,mCAAmC;IACnC,MAAM,eAAe,IAAA,4KAAW;2DAAC,CAAC,KAAe,cAAc,GAAG,CAAC;0DAAK;QAAC;KAAc;IAEvF,2BAA2B;IAC3B,IAAA,0KAAS;2CAAC;YACR,IAAI,+CAAkB,eAAe,kBAAkB,QAAQ;gBAC7D,gBAAgB,OAAO,GAAG,IAAI;YAChC;YAEA;mDAAO;oBACL,gBAAgB,OAAO,EAAE;gBAC3B;;QACF;0CAAG,EAAE;IAEL,IAAA,0KAAS;2CAAC;YACR,IAAI,CAAC,gBAAgB,OAAO,IAAI,CAAC,iBAAiB,iBAAiB,GAAG;YAEtE,IAAI,kBAAkB,qBAAqB,OAAO,EAAE;YAEpD,gCAAgC;YAChC,MAAM,WAAW,6IAAY,CAAC,QAAQ,GAAG,QAAQ;YACjD,MAAM,gBAAgB,QAAQ,CAAC,SAAS,MAAM,GAAG,EAAE;YACnD,IAAI,CAAC,eAAe;YAEpB,MAAM,YAAY,aAAa,cAAc,QAAQ;YACrD,IAAI,CAAC,WAAW;YAEhB,qBAAqB,OAAO,GAAG;YAE/B,oBAAoB;YACpB,MAAM,gBAAgB,aAAa,0BAA0B,CAAC,UAAU,YAAY,CAAC,OAAO;YAE5F,aACG,gBAAgB,CAAC,cAAc,OAAO,EAAE;gBACvC,SAAS,UAAU,YAAY,CAAC,OAAO;gBACvC,GAAG,aAAa;YAClB,GACC,IAAI;mDAAC,OAAO;oBACX,IAAI,CAAC,gBAAgB,OAAO,IAAI,UAAU,UAAU,KAAK,GAAG;oBAE5D,IAAI;wBACF,MAAM,cAAc,MAAM,gBAAgB,OAAO,CAAC,eAAe,CAAC;wBAClE,MAAM,SAAS,gBAAgB,OAAO,CAAC,kBAAkB;wBACzD,OAAO,MAAM,GAAG;wBAChB,OAAO,OAAO,CAAC,gBAAgB,OAAO,CAAC,WAAW;wBAClD,OAAO,KAAK;oBACd,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,8BAA8B;oBAC9C;gBACF;kDACC,KAAK;mDAAC,CAAC;oBACN,QAAQ,KAAK,CAAC,qCAAqC;gBACrD;;QACJ;0CAAG;QAAC;QAAe;QAAc;QAAc;KAAa;AAC9D;GA/DgB;;QACO,6IAAY;QACX,6IAAY;QACZ,6IAAY"}},
    {"offset": {"line": 10472, "column": 0}, "map": {"version":3,"sources":["file:///Users/jdbohrman/Downloads/little-trails/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { DaycareScene } from \"@/components/three/DaycareScene\"\nimport { HUD } from \"@/components/ui/HUD\"\nimport { VoiceControls } from \"@/components/ui/VoiceControls\"\nimport { VoiceVisualizer } from \"@/components/ui/VoiceVisualizer\"\nimport { TranscriptDisplay } from \"@/components/ui/TranscriptDisplay\"\nimport { PaywallDialog } from \"@/components/ui/PaywallDialog\"\nimport { TrialBanner } from \"@/components/ui/TrialBanner\"\nimport { DaycareCreationButton } from \"@/components/ui/DaycareCreationButton\"\nimport { SubscriptionStatus } from \"@/components/ui/SubscriptionStatus\"\nimport { Suspense, useEffect } from \"react\"\nimport { useGameStore } from \"@/lib/stores/gameStore\"\nimport { useAICaregivers } from \"@/lib/hooks/useAICaregivers\"\nimport { useVoiceCommunication } from \"@/lib/hooks/useVoiceCommunication\"\nimport { nanoid } from \"nanoid\"\nimport type { Player, Lobby } from \"@/lib/types/gameTypes\"\n\nexport default function Home() {\n  const setCurrentLobby = useGameStore((state) => state.setCurrentLobby)\n  const setCurrentPlayer = useGameStore((state) => state.setCurrentPlayer)\n  useAICaregivers()\n  useVoiceCommunication()\n\n  useEffect(() => {\n    // Initialize a test lobby with player\n    const playerId = nanoid()\n\n    const testPlayer: Player = {\n      id: playerId,\n      name: \"Little One\",\n      role: \"little\",\n      gender: \"male\",\n      adminRole: \"none\",\n      character: {\n        skinColor: \"#F5D0C5\",\n        ageGroup: \"4-7\",\n        hairColor: \"#FFD700\",\n        eyeColor: \"#87CEEB\",\n      },\n      clothing: {\n        shirt: true,\n        pants: true,\n        socks: true,\n        shoes: true,\n        underwearType: \"training_pants\",\n        underwearState: \"clean\",\n        diaperFillLevel: 0,\n        pacifierIn: false,\n      },\n      needs: {\n        bladder: 20,\n        bowel: 10,\n        hunger: 15,\n      },\n      position: { x: 0, y: 1.5, z: 0 }, // Start above ground level\n      rotation: 0,\n      disciplineStatus: \"green\",\n      alignment: \"boy_girl\",\n      isInTimeout: false,\n      isBeingLed: false,\n      currentAnimation: \"walk\",\n      privileges: [],\n      rewards: [],\n      punishments: [],\n    }\n\n    const testLobby: Lobby = {\n      id: nanoid(),\n      inviteCode: \"TEST123\",\n      settings: {\n        name: \"Test Daycare\",\n        maxPlayers: 20,\n        staffOnlyRoleChanges: false,\n        staffOnlyGenderChanges: false,\n        isPrivate: false,\n        monetizationEnabled: true,\n        trialDays: 7,\n      },\n      ownerId: playerId,\n      players: new Map([[playerId, testPlayer]]),\n      caregivers: new Map(),\n      objects: new Map(),\n      accidents: new Map(),\n      createdAt: Date.now(),\n      trialEndDate: Date.now() + 2 * 24 * 60 * 60 * 1000, // 2 days trial\n      isSuspended: false,\n    }\n\n    setCurrentLobby(testLobby)\n    setCurrentPlayer(playerId)\n  }, [setCurrentLobby, setCurrentPlayer])\n\n  return (\n    <main className=\"w-full h-screen overflow-hidden relative\">\n      <Suspense\n        fallback={\n          <div className=\"w-full h-screen flex items-center justify-center bg-background\">\n            <div className=\"flex flex-col items-center gap-4\">\n              <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin\" />\n              <p className=\"text-lg font-medium text-foreground\">Initializing Daycare...</p>\n            </div>\n          </div>\n        }\n      >\n        <DaycareScene />\n        <HUD />\n        <VoiceControls />\n        <VoiceVisualizer />\n        <TranscriptDisplay />\n        <PaywallDialog />\n        <TrialBanner />\n\n        {/* Top bar with daycare management */}\n        <div className=\"fixed top-4 left-1/2 -translate-x-1/2 flex items-center gap-4 pointer-events-auto\">\n          <DaycareCreationButton />\n        </div>\n\n        {/* Subscription status at bottom left */}\n        <div className=\"fixed bottom-4 left-4 pointer-events-auto max-w-[350px]\">\n          <SubscriptionStatus />\n        </div>\n      </Suspense>\n    </main>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAfA;;;;;;;;;;;;;;;AAkBe,SAAS;;IACtB,MAAM,kBAAkB,IAAA,6IAAY;8CAAC,CAAC,QAAU,MAAM,eAAe;;IACrE,MAAM,mBAAmB,IAAA,6IAAY;+CAAC,CAAC,QAAU,MAAM,gBAAgB;;IACvE,IAAA,qJAAe;IACf,IAAA,iKAAqB;IAErB,IAAA,0KAAS;0BAAC;YACR,sCAAsC;YACtC,MAAM,WAAW,IAAA,uKAAM;YAEvB,MAAM,aAAqB;gBACzB,IAAI;gBACJ,MAAM;gBACN,MAAM;gBACN,QAAQ;gBACR,WAAW;gBACX,WAAW;oBACT,WAAW;oBACX,UAAU;oBACV,WAAW;oBACX,UAAU;gBACZ;gBACA,UAAU;oBACR,OAAO;oBACP,OAAO;oBACP,OAAO;oBACP,OAAO;oBACP,eAAe;oBACf,gBAAgB;oBAChB,iBAAiB;oBACjB,YAAY;gBACd;gBACA,OAAO;oBACL,SAAS;oBACT,OAAO;oBACP,QAAQ;gBACV;gBACA,UAAU;oBAAE,GAAG;oBAAG,GAAG;oBAAK,GAAG;gBAAE;gBAC/B,UAAU;gBACV,kBAAkB;gBAClB,WAAW;gBACX,aAAa;gBACb,YAAY;gBACZ,kBAAkB;gBAClB,YAAY,EAAE;gBACd,SAAS,EAAE;gBACX,aAAa,EAAE;YACjB;YAEA,MAAM,YAAmB;gBACvB,IAAI,IAAA,uKAAM;gBACV,YAAY;gBACZ,UAAU;oBACR,MAAM;oBACN,YAAY;oBACZ,sBAAsB;oBACtB,wBAAwB;oBACxB,WAAW;oBACX,qBAAqB;oBACrB,WAAW;gBACb;gBACA,SAAS;gBACT,SAAS,IAAI,IAAI;oBAAC;wBAAC;wBAAU;qBAAW;iBAAC;gBACzC,YAAY,IAAI;gBAChB,SAAS,IAAI;gBACb,WAAW,IAAI;gBACf,WAAW,KAAK,GAAG;gBACnB,cAAc,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;gBAC9C,aAAa;YACf;YAEA,gBAAgB;YAChB,iBAAiB;QACnB;yBAAG;QAAC;QAAiB;KAAiB;IAEtC,qBACE,6LAAC;QAAK,WAAU;kBACd,cAAA,6LAAC,yKAAQ;YACP,wBACE,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;;;;;sCACf,6LAAC;4BAAE,WAAU;sCAAsC;;;;;;;;;;;;;;;;;;8BAKzD,6LAAC,uJAAY;;;;;8BACb,6LAAC,kIAAG;;;;;8BACJ,6LAAC,sJAAa;;;;;8BACd,6LAAC,0JAAe;;;;;8BAChB,6LAAC,8JAAiB;;;;;8BAClB,6LAAC,sJAAa;;;;;8BACd,6LAAC,kJAAW;;;;;8BAGZ,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,sKAAqB;;;;;;;;;;8BAIxB,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,gKAAkB;;;;;;;;;;;;;;;;;;;;;AAK7B;GA3GwB;;QACE,6IAAY;QACX,6IAAY;QACrC,qJAAe;QACf,iKAAqB;;;KAJC"}}]
}